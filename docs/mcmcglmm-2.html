<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3.4 MCMCglmm | How to fit an animal model</title>
  <meta name="description" content="Updated and extended tutorials from An ecologist guide to animal model (Wilson et al. 2010)" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="3.4 MCMCglmm | How to fit an animal model" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="images/missing.png" />
  <meta property="og:description" content="Updated and extended tutorials from An ecologist guide to animal model (Wilson et al. 2010)" />
  <meta name="github-repo" content="JulienGAMartin/wam_tuto" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3.4 MCMCglmm | How to fit an animal model" />
  
  <meta name="twitter:description" content="Updated and extended tutorials from An ecologist guide to animal model (Wilson et al. 2010)" />
  <meta name="twitter:image" content="images/missing.png" />

<meta name="author" content="Julien Martin" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="gremlin-2.html"/>
<link rel="next" href="brms-2.html"/>
<script src="libs/header-attrs-2.7.3/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">How to fit an animal model</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#contributors"><i class="fa fa-check"></i>Contributors</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>1.1</b> Data</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="data.html"><a href="data.html#data-files"><i class="fa fa-check"></i><b>1.1.1</b> Data files</a></li>
<li class="chapter" data-level="1.1.2" data-path="data.html"><a href="data.html#notes-on-data-and-pedigree"><i class="fa fa-check"></i><b>1.1.2</b> Notes on data and pedigree</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="r.html"><a href="r.html"><i class="fa fa-check"></i><b>1.2</b> R</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="r.html"><a href="r.html#r-packages"><i class="fa fa-check"></i><b>1.2.1</b> R packages</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="univariate-animal-model.html"><a href="univariate-animal-model.html"><i class="fa fa-check"></i><b>2</b> Univariate animal model</a>
<ul>
<li class="chapter" data-level="2.1" data-path="scenario-and-data.html"><a href="scenario-and-data.html"><i class="fa fa-check"></i><b>2.1</b> Scenario and data</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="scenario-and-data.html"><a href="scenario-and-data.html#scenario"><i class="fa fa-check"></i><b>2.1.1</b> Scenario</a></li>
<li class="chapter" data-level="2.1.2" data-path="scenario-and-data.html"><a href="scenario-and-data.html#data-files-1"><i class="fa fa-check"></i><b>2.1.2</b> Data files</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="asreml-r-1.html"><a href="asreml-r-1.html"><i class="fa fa-check"></i><b>2.2</b> Asreml-R</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="asreml-r-1.html"><a href="asreml-r-1.html#running-the-model"><i class="fa fa-check"></i><b>2.2.1</b> Running the model</a></li>
<li class="chapter" data-level="2.2.2" data-path="asreml-r-1.html"><a href="asreml-r-1.html#estimating-heritability"><i class="fa fa-check"></i><b>2.2.2</b> Estimating heritability</a></li>
<li class="chapter" data-level="2.2.3" data-path="asreml-r-1.html"><a href="asreml-r-1.html#adding-fixed-effects"><i class="fa fa-check"></i><b>2.2.3</b> Adding fixed effects</a></li>
<li class="chapter" data-level="2.2.4" data-path="asreml-r-1.html"><a href="asreml-r-1.html#adding-random-effects"><i class="fa fa-check"></i><b>2.2.4</b> Adding random effects</a></li>
<li class="chapter" data-level="2.2.5" data-path="asreml-r-1.html"><a href="asreml-r-1.html#testing-significance-of-random-effects"><i class="fa fa-check"></i><b>2.2.5</b> Testing significance of random effects</a></li>
<li class="chapter" data-level="2.2.6" data-path="asreml-r-1.html"><a href="asreml-r-1.html#futher-partitionning-the-variance"><i class="fa fa-check"></i><b>2.2.6</b> Futher partitionning the variance</a></li>
<li class="chapter" data-level="2.2.7" data-path="asreml-r-1.html"><a href="asreml-r-1.html#covariance-between-different-random-effect-and-possible-negative-variance"><i class="fa fa-check"></i><b>2.2.7</b> Covariance between different random effect and possible negative variance</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="gremlin-1.html"><a href="gremlin-1.html"><i class="fa fa-check"></i><b>2.3</b> gremlin</a></li>
<li class="chapter" data-level="2.4" data-path="mcmcglmm-1.html"><a href="mcmcglmm-1.html"><i class="fa fa-check"></i><b>2.4</b> MCMCglmm</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="mcmcglmm-1.html"><a href="mcmcglmm-1.html#running-the-model-1"><i class="fa fa-check"></i><b>2.4.1</b> Running the model</a></li>
<li class="chapter" data-level="2.4.2" data-path="mcmcglmm-1.html"><a href="mcmcglmm-1.html#estimating-heritability-1"><i class="fa fa-check"></i><b>2.4.2</b> Estimating heritability</a></li>
<li class="chapter" data-level="2.4.3" data-path="mcmcglmm-1.html"><a href="mcmcglmm-1.html#adding-fixed-effects-1"><i class="fa fa-check"></i><b>2.4.3</b> Adding fixed effects</a></li>
<li class="chapter" data-level="2.4.4" data-path="mcmcglmm-1.html"><a href="mcmcglmm-1.html#adding-random-effects-1"><i class="fa fa-check"></i><b>2.4.4</b> Adding random effects</a></li>
<li class="chapter" data-level="2.4.5" data-path="mcmcglmm-1.html"><a href="mcmcglmm-1.html#testing-significance-of-variance-components"><i class="fa fa-check"></i><b>2.4.5</b> Testing significance of variance components</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="brms-1.html"><a href="brms-1.html"><i class="fa fa-check"></i><b>2.5</b> brms</a></li>
<li class="chapter" data-level="2.6" data-path="stan.html"><a href="stan.html"><i class="fa fa-check"></i><b>2.6</b> stan</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="multivariate-animal-model.html"><a href="multivariate-animal-model.html"><i class="fa fa-check"></i><b>3</b> Multivariate animal model</a>
<ul>
<li class="chapter" data-level="3.1" data-path="scenario-and-data-1.html"><a href="scenario-and-data-1.html"><i class="fa fa-check"></i><b>3.1</b> Scenario and data</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="scenario-and-data-1.html"><a href="scenario-and-data-1.html#scenario-1"><i class="fa fa-check"></i><b>3.1.1</b> Scenario</a></li>
<li class="chapter" data-level="3.1.2" data-path="scenario-and-data-1.html"><a href="scenario-and-data-1.html#gryphon-files"><i class="fa fa-check"></i><b>3.1.2</b> gryphon files</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="asreml-biv.html"><a href="asreml-biv.html"><i class="fa fa-check"></i><b>3.2</b> Asreml-R</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="asreml-biv.html"><a href="asreml-biv.html#running-the-model-2"><i class="fa fa-check"></i><b>3.2.1</b> Running the model</a></li>
<li class="chapter" data-level="3.2.2" data-path="asreml-biv.html"><a href="asreml-biv.html#adding-fixed-and-random-effects"><i class="fa fa-check"></i><b>3.2.2</b> Adding fixed and random effects</a></li>
<li class="chapter" data-level="3.2.3" data-path="asreml-biv.html"><a href="asreml-biv.html#significance-testing"><i class="fa fa-check"></i><b>3.2.3</b> Significance testing</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="gremlin-2.html"><a href="gremlin-2.html"><i class="fa fa-check"></i><b>3.3</b> gremlin</a></li>
<li class="chapter" data-level="3.4" data-path="mcmcglmm-2.html"><a href="mcmcglmm-2.html"><i class="fa fa-check"></i><b>3.4</b> MCMCglmm</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="mcmcglmm-2.html"><a href="mcmcglmm-2.html#fitting-the-model"><i class="fa fa-check"></i><b>3.4.1</b> Fitting the model</a></li>
<li class="chapter" data-level="3.4.2" data-path="mcmcglmm-2.html"><a href="mcmcglmm-2.html#adding-fixed-and-random-effects-1"><i class="fa fa-check"></i><b>3.4.2</b> Adding fixed and random effects</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="brms-2.html"><a href="brms-2.html"><i class="fa fa-check"></i><b>3.5</b> brms</a></li>
<li class="chapter" data-level="3.6" data-path="stan-1.html"><a href="stan-1.html"><i class="fa fa-check"></i><b>3.6</b> stan</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="rep-measures.html"><a href="rep-measures.html"><i class="fa fa-check"></i><b>4</b> A repeated measures animal model</a>
<ul>
<li class="chapter" data-level="4.1" data-path="scenario-and-data-2.html"><a href="scenario-and-data-2.html"><i class="fa fa-check"></i><b>4.1</b> Scenario and data</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="scenario-and-data-2.html"><a href="scenario-and-data-2.html#scenario-2"><i class="fa fa-check"></i><b>4.1.1</b> scenario</a></li>
<li class="chapter" data-level="4.1.2" data-path="scenario-and-data-2.html"><a href="scenario-and-data-2.html#data-files-2"><i class="fa fa-check"></i><b>4.1.2</b> Data files</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="asreml-r-2.html"><a href="asreml-r-2.html"><i class="fa fa-check"></i><b>4.2</b> Asreml-R</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="asreml-r-2.html"><a href="asreml-r-2.html#estimating-repeatability"><i class="fa fa-check"></i><b>4.2.1</b> Estimating repeatability</a></li>
<li class="chapter" data-level="4.2.2" data-path="asreml-r-2.html"><a href="asreml-r-2.html#partitioning-additive-and-permanent-environment-effects"><i class="fa fa-check"></i><b>4.2.2</b> Partitioning additive and permanent environment effects</a></li>
<li class="chapter" data-level="4.2.3" data-path="asreml-r-2.html"><a href="asreml-r-2.html#adding-additional-effects-and-testing-significance"><i class="fa fa-check"></i><b>4.2.3</b> Adding additional effects and testing significance</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="gremlin-3.html"><a href="gremlin-3.html"><i class="fa fa-check"></i><b>4.3</b> gremlin</a></li>
<li class="chapter" data-level="4.4" data-path="mcmcglmm-3.html"><a href="mcmcglmm-3.html"><i class="fa fa-check"></i><b>4.4</b> MCMCglmm</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="mcmcglmm-3.html"><a href="mcmcglmm-3.html#estimating-repeatability-1"><i class="fa fa-check"></i><b>4.4.1</b> Estimating repeatability</a></li>
<li class="chapter" data-level="4.4.2" data-path="mcmcglmm-3.html"><a href="mcmcglmm-3.html#partitioning-additive-and-permanent-environment-effects-1"><i class="fa fa-check"></i><b>4.4.2</b> Partitioning additive and permanent environment effects</a></li>
<li class="chapter" data-level="4.4.3" data-path="mcmcglmm-3.html"><a href="mcmcglmm-3.html#adding-additional-effects-and-testing-significance-1"><i class="fa fa-check"></i><b>4.4.3</b> Adding additional effects and testing significance</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="brms-3.html"><a href="brms-3.html"><i class="fa fa-check"></i><b>4.5</b> brms</a></li>
<li class="chapter" data-level="4.6" data-path="stan-2.html"><a href="stan-2.html"><i class="fa fa-check"></i><b>4.6</b> stan</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="quick-comparison-of-codes.html"><a href="quick-comparison-of-codes.html"><i class="fa fa-check"></i><b>5</b> Quick comparison of codes</a>
<ul>
<li class="chapter" data-level="5.1" data-path="univariate-model-with-repeated-measures.html"><a href="univariate-model-with-repeated-measures.html"><i class="fa fa-check"></i><b>5.1</b> Univariate model with repeated measures</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="univariate-model-with-repeated-measures.html"><a href="univariate-model-with-repeated-measures.html#asreml-r-3"><i class="fa fa-check"></i><b>5.1.1</b> Asreml-R</a></li>
<li class="chapter" data-level="5.1.2" data-path="univariate-model-with-repeated-measures.html"><a href="univariate-model-with-repeated-measures.html#gremlin-4"><i class="fa fa-check"></i><b>5.1.2</b> gremlin</a></li>
<li class="chapter" data-level="5.1.3" data-path="univariate-model-with-repeated-measures.html"><a href="univariate-model-with-repeated-measures.html#mcmcglmm-4"><i class="fa fa-check"></i><b>5.1.3</b> MCMCglmm</a></li>
<li class="chapter" data-level="5.1.4" data-path="univariate-model-with-repeated-measures.html"><a href="univariate-model-with-repeated-measures.html#brms-4"><i class="fa fa-check"></i><b>5.1.4</b> brms</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="bivariate-model.html"><a href="bivariate-model.html"><i class="fa fa-check"></i><b>5.2</b> bivariate model</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="bivariate-model.html"><a href="bivariate-model.html#asreml-r-4"><i class="fa fa-check"></i><b>5.2.1</b> Asreml-R</a></li>
<li class="chapter" data-level="5.2.2" data-path="bivariate-model.html"><a href="bivariate-model.html#gremlin-5"><i class="fa fa-check"></i><b>5.2.2</b> gremlin</a></li>
<li class="chapter" data-level="5.2.3" data-path="bivariate-model.html"><a href="bivariate-model.html#mcmcglmm-5"><i class="fa fa-check"></i><b>5.2.3</b> MCMCglmm</a></li>
<li class="chapter" data-level="5.2.4" data-path="bivariate-model.html"><a href="bivariate-model.html#brms-5"><i class="fa fa-check"></i><b>5.2.4</b> brms</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="_blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">How to fit an animal model</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="mcmcglmm-2" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> MCMCglmm</h2>
<p>All others software will remove automatically lines with missing data from the dataset use to fit the model.
<code>MCMCglmm</code>, however, will not do it and will try to fit the model use latent variables for missing data.
For comparison, we will remove the missing values from the data before fitting the model.</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="mcmcglmm-2.html#cb140-1" aria-hidden="true" tabindex="-1"></a>gryphon <span class="ot">&lt;-</span> <span class="fu">subset</span>(gryphon, <span class="sc">!</span><span class="fu">is.na</span>(bwt) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(tarsus))</span></code></pre></div>
<div id="fitting-the-model" class="section level3" number="3.4.1">
<h3><span class="header-section-number">3.4.1</span> Fitting the model</h3>
<p>Fitting a multivariate model in MCMCglmm involves several new consideration above those for fitting univariate models. First, we have to fit multivariate priors; second, we have to specify the ways in which effects on different traits may covary, including the nature of residual (co)variation; and third, we will have to be a little more specific when specifying to MCMCglmm what type of distributions from which we assume our data are drawn. Our most basic model can be specified as:</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="mcmcglmm-2.html#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MCMCglmm)</span>
<span id="cb141-2"><a href="mcmcglmm-2.html#cb141-2" aria-hidden="true" tabindex="-1"></a>Ainv <span class="ot">&lt;-</span> <span class="fu">inverseA</span>(gryphonped)<span class="sc">$</span>Ainv</span>
<span id="cb141-3"><a href="mcmcglmm-2.html#cb141-3" aria-hidden="true" tabindex="-1"></a>prior2<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb141-4"><a href="mcmcglmm-2.html#cb141-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">G =</span> <span class="fu">list</span>(<span class="at">G1 =</span> <span class="fu">list</span>(<span class="at">V =</span> <span class="fu">diag</span>(<span class="dv">2</span>), <span class="at">nu =</span> <span class="fl">1.002</span>)),</span>
<span id="cb141-5"><a href="mcmcglmm-2.html#cb141-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">R =</span> <span class="fu">list</span>(<span class="at">V =</span> <span class="fu">diag</span>(<span class="dv">2</span>), <span class="at">nu =</span> <span class="fl">1.002</span>)</span>
<span id="cb141-6"><a href="mcmcglmm-2.html#cb141-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb141-7"><a href="mcmcglmm-2.html#cb141-7" aria-hidden="true" tabindex="-1"></a>model2<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">MCMCglmm</span>(<span class="fu">cbind</span>(bwt, tarsus) <span class="sc">~</span> trait <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb141-8"><a href="mcmcglmm-2.html#cb141-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">random =</span> <span class="sc">~</span> <span class="fu">us</span>(trait)<span class="sc">:</span>animal, <span class="at">rcov =</span> <span class="sc">~</span> <span class="fu">us</span>(trait)<span class="sc">:</span>units, <span class="at">family =</span> <span class="fu">c</span>(<span class="st">&quot;gaussian&quot;</span>, <span class="st">&quot;gaussian&quot;</span>),</span>
<span id="cb141-9"><a href="mcmcglmm-2.html#cb141-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">ginv =</span> <span class="fu">list</span>(<span class="at">animal =</span> Ainv), <span class="at">data =</span> gryphon, <span class="at">prior =</span> prior2<span class="fl">.1</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span></span>
<span id="cb141-10"><a href="mcmcglmm-2.html#cb141-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb141-11"><a href="mcmcglmm-2.html#cb141-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model2<span class="fl">.1</span><span class="sc">$</span>VCV[, <span class="st">&quot;traittarsus:traittarsus.animal&quot;</span>])</span></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-64"></span>
<img src="wam_tuto_files/figure-html/unnamed-chunk-64-1.svg" alt="The posterior distribution of the additive genetic effect for tarsus length in a MCMCglmm run with default values" width="672" />
<p class="caption">
Figure 3.1: The posterior distribution of the additive genetic effect for tarsus length in a MCMCglmm run with default values
</p>
</div>
<p>We have constructed the prior similarly to the those in the univariate models in tutorial 1, only we are specifying a 2x2 covariance matrix rather than a single variance. In order to provide proper priors, we have set the degree of belief parameter to greater than 1 (1.002). Those priors are not necessarily weak or uninformative in all circumstances. We will consider them adequate nonetheless for this tutorial. Please the vignette of the MCMCglmm packages <span class="citation">(<a href="references.html#ref-R-MCMCglmm" role="doc-biblioref">J. Hadfield 2021</a>)</span> for more infomration on priors. In tutorial 1, we used full autocorrelation tables to evaluate the validity of the posterior distribution. Note that we have not done this here. For a bivariate model this table can become very complex. Nonetheless, it is worth evaluating, rather it is simply to large to include here. It can be viewed in the console as before. Here we have displayed only the autocorrelation for estimates of additive genetic effects for tarsus length with a lag of one samples (10 iterations given this MCMCglmm run with default values). This lag of 0.8366038 is clearly unacceptable. The posterior distribution of the additive genetic effect on tarsus length is shown in Figure 4 (p.Â 15), note the autocorrelation evident in the left-hand plot. We will opt to run the analysis for longer. This longer run could be run using the following code (including a line to save the output):</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="mcmcglmm-2.html#cb142-1" aria-hidden="true" tabindex="-1"></a>model2<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">MCMCglmm</span>(<span class="fu">cbind</span>(bwt, tarsus) <span class="sc">~</span> trait <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb142-2"><a href="mcmcglmm-2.html#cb142-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">random =</span> <span class="sc">~</span> <span class="fu">us</span>(trait)<span class="sc">:</span>animal,</span>
<span id="cb142-3"><a href="mcmcglmm-2.html#cb142-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">rcov =</span> <span class="sc">~</span> <span class="fu">us</span>(trait)<span class="sc">:</span>units,</span>
<span id="cb142-4"><a href="mcmcglmm-2.html#cb142-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">c</span>(<span class="st">&quot;gaussian&quot;</span>, <span class="st">&quot;gaussian&quot;</span>),</span>
<span id="cb142-5"><a href="mcmcglmm-2.html#cb142-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">ginv =</span> <span class="fu">list</span>(<span class="at">animal =</span> Ainv), <span class="at">data =</span> gryphon,</span>
<span id="cb142-6"><a href="mcmcglmm-2.html#cb142-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">nitt =</span> <span class="dv">130000</span>, <span class="at">thin =</span> <span class="dv">100</span>, <span class="at">burnin =</span> <span class="dv">30000</span>,</span>
<span id="cb142-7"><a href="mcmcglmm-2.html#cb142-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> prior2<span class="fl">.1</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span></span>
<span id="cb142-8"><a href="mcmcglmm-2.html#cb142-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb142-9"><a href="mcmcglmm-2.html#cb142-9" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(model2<span class="fl">.1</span>, <span class="at">file =</span> <span class="st">&quot;data/MCMCglmm_model2_1_LongRun.rda&quot;</span>)</span></code></pre></div>
<p>However, this run might take as long as an hour. For the purpose of this tutorial we have provided an output for such a run. It can be obtained and manipulated as follows, assuming that the file <code>MCMCglmm_model2_1_LongRun.rda</code> is available at the specified location:</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="mcmcglmm-2.html#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="st">&quot;data/MCMCglmm_model2_1_LongRun.rda&quot;</span>)</span>
<span id="cb143-2"><a href="mcmcglmm-2.html#cb143-2" aria-hidden="true" tabindex="-1"></a><span class="fu">autocorr.diag</span>(model2<span class="fl">.1</span><span class="sc">$</span>VCV)[, <span class="st">&quot;traittarsus:traittarsus.animal&quot;</span>][<span class="dv">2</span>]</span></code></pre></div>
<pre><code>##   Lag 100 
## 0.2608752</code></pre>
<p>This level of autocorrelation is more acceptable, at least for the purpose of demonstration in this tutorial.
We can recover variance components, heritabilities, and genetic correlations from the posterior distribution of this model:</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="mcmcglmm-2.html#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior.mode</span>(model2<span class="fl">.1</span><span class="sc">$</span>VCV)</span></code></pre></div>
<pre><code>##       traitbwt:traitbwt.animal    traittarsus:traitbwt.animal 
##                       3.370616                       2.581839 
##    traitbwt:traittarsus.animal traittarsus:traittarsus.animal 
##                       2.581839                      12.463915 
##        traitbwt:traitbwt.units     traittarsus:traitbwt.units 
##                       3.761401                       2.982413 
##     traitbwt:traittarsus.units  traittarsus:traittarsus.units 
##                       2.982413                      19.556443</code></pre>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="mcmcglmm-2.html#cb147-1" aria-hidden="true" tabindex="-1"></a>heritability.bwt2<span class="fl">.1</span> <span class="ot">&lt;-</span> model2<span class="fl">.1</span><span class="sc">$</span>VCV[, <span class="st">&quot;traitbwt:traitbwt.animal&quot;</span>] <span class="sc">/</span> (model2<span class="fl">.1</span><span class="sc">$</span>VCV[, <span class="st">&quot;traitbwt:traitbwt.animal&quot;</span>] <span class="sc">+</span> model2<span class="fl">.1</span><span class="sc">$</span>VCV[, <span class="st">&quot;traitbwt:traitbwt.animal&quot;</span>])</span>
<span id="cb147-2"><a href="mcmcglmm-2.html#cb147-2" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior.mode</span>(heritability.bwt2<span class="fl">.1</span>)</span></code></pre></div>
<pre><code>##      var1 
## 0.4999336</code></pre>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="mcmcglmm-2.html#cb149-1" aria-hidden="true" tabindex="-1"></a>heritability.tarsus2<span class="fl">.1</span> <span class="ot">&lt;-</span> model2<span class="fl">.1</span><span class="sc">$</span>VCV[, <span class="st">&quot;traittarsus:traittarsus.animal&quot;</span>] <span class="sc">/</span> (model2<span class="fl">.1</span><span class="sc">$</span>VCV[, <span class="st">&quot;traittarsus:traittarsus.animal&quot;</span>] <span class="sc">+</span> model2<span class="fl">.1</span><span class="sc">$</span>VCV[, <span class="st">&quot;traittarsus:traittarsus.units&quot;</span>])</span>
<span id="cb149-2"><a href="mcmcglmm-2.html#cb149-2" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior.mode</span>(heritability.tarsus2<span class="fl">.1</span>)</span></code></pre></div>
<pre><code>##      var1 
## 0.4038754</code></pre>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="mcmcglmm-2.html#cb151-1" aria-hidden="true" tabindex="-1"></a>genetic.correlation2<span class="fl">.1</span> <span class="ot">&lt;-</span> model2<span class="fl">.1</span><span class="sc">$</span>VCV[, <span class="st">&quot;traitbwt:traittarsus.animal&quot;</span>] <span class="sc">/</span> <span class="fu">sqrt</span>(model2<span class="fl">.1</span><span class="sc">$</span>VCV[, <span class="st">&quot;traitbwt:traitbwt.animal&quot;</span>] <span class="sc">*</span> model2<span class="fl">.1</span><span class="sc">$</span>VCV[, <span class="st">&quot;traittarsus:traittarsus.animal&quot;</span>])</span>
<span id="cb151-2"><a href="mcmcglmm-2.html#cb151-2" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior.mode</span>(genetic.correlation2<span class="fl">.1</span>)</span></code></pre></div>
<pre><code>##      var1 
## 0.3691503</code></pre>
</div>
<div id="adding-fixed-and-random-effects-1" class="section level3" number="3.4.2">
<h3><span class="header-section-number">3.4.2</span> Adding fixed and random effects</h3>
<p>Fixed and random effects can be added just as for the univariate case.
Given that our full model of bwt from tutorial 1 had sex as a fixed effect as well as random effects of byear and mother we could specify a bivariate formulation of this using the following code (including a line to save the output):</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="mcmcglmm-2.html#cb153-1" aria-hidden="true" tabindex="-1"></a>prior2<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb153-2"><a href="mcmcglmm-2.html#cb153-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">G =</span> <span class="fu">list</span>(</span>
<span id="cb153-3"><a href="mcmcglmm-2.html#cb153-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">G1 =</span> <span class="fu">list</span>(<span class="at">V =</span> <span class="fu">diag</span>(<span class="dv">2</span>), <span class="at">nu =</span> <span class="fl">1.002</span>),</span>
<span id="cb153-4"><a href="mcmcglmm-2.html#cb153-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">G2 =</span> <span class="fu">list</span>(<span class="at">V =</span> <span class="fu">diag</span>(<span class="dv">2</span>), <span class="at">nu =</span> <span class="fl">1.002</span>),</span>
<span id="cb153-5"><a href="mcmcglmm-2.html#cb153-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">G3 =</span> <span class="fu">list</span>(<span class="at">V =</span> <span class="fu">diag</span>(<span class="dv">2</span>), <span class="at">nu =</span> <span class="fl">1.002</span>)</span>
<span id="cb153-6"><a href="mcmcglmm-2.html#cb153-6" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb153-7"><a href="mcmcglmm-2.html#cb153-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">R =</span> <span class="fu">list</span>(<span class="at">V =</span> <span class="fu">diag</span>(<span class="dv">2</span>), <span class="at">nu =</span> <span class="fl">1.002</span>)</span>
<span id="cb153-8"><a href="mcmcglmm-2.html#cb153-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb153-9"><a href="mcmcglmm-2.html#cb153-9" aria-hidden="true" tabindex="-1"></a>model2<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">MCMCglmm</span>(<span class="fu">cbind</span>(bwt, tarsus) <span class="sc">~</span> trait <span class="sc">-</span> <span class="dv">1</span> <span class="sc">+</span> trait<span class="sc">:</span>sex,</span>
<span id="cb153-10"><a href="mcmcglmm-2.html#cb153-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">random =</span> <span class="sc">~</span> <span class="fu">us</span>(trait)<span class="sc">:</span>animal <span class="sc">+</span> <span class="fu">us</span>(trait)<span class="sc">:</span>byear <span class="sc">+</span> <span class="fu">us</span>(trait)<span class="sc">:</span>mother,</span>
<span id="cb153-11"><a href="mcmcglmm-2.html#cb153-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">rcov =</span> <span class="sc">~</span> <span class="fu">us</span>(trait)<span class="sc">:</span>units,</span>
<span id="cb153-12"><a href="mcmcglmm-2.html#cb153-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">c</span>(<span class="st">&quot;gaussian&quot;</span>, <span class="st">&quot;gaussian&quot;</span>),</span>
<span id="cb153-13"><a href="mcmcglmm-2.html#cb153-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">ginv =</span> <span class="fu">list</span>(<span class="at">animal =</span> Ainv), <span class="at">data =</span> gryphon,</span>
<span id="cb153-14"><a href="mcmcglmm-2.html#cb153-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">nitt =</span> <span class="dv">130000</span>, <span class="at">thin =</span> <span class="dv">100</span>, <span class="at">burnin =</span> <span class="dv">30000</span>,</span>
<span id="cb153-15"><a href="mcmcglmm-2.html#cb153-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> prior2<span class="fl">.2</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span></span>
<span id="cb153-16"><a href="mcmcglmm-2.html#cb153-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb153-17"><a href="mcmcglmm-2.html#cb153-17" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(model2<span class="fl">.2</span>, <span class="at">file =</span> <span class="st">&quot;data/MCMCglmm_model2_2_LongRun.rda&quot;</span>)</span></code></pre></div>
<p>Again we have provided the data from one such run. It can be accessed using the code:</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="mcmcglmm-2.html#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="st">&quot;data/MCMCglmm_model2_2_LongRun.rda&quot;</span>)</span>
<span id="cb154-2"><a href="mcmcglmm-2.html#cb154-2" aria-hidden="true" tabindex="-1"></a><span class="fu">autocorr</span>(model2<span class="fl">.2</span><span class="sc">$</span>VCV)[, , <span class="st">&quot;traittarsus:traittarsus.animal&quot;</span>][<span class="dv">3</span>, <span class="dv">4</span>]</span></code></pre></div>
<pre><code>## [1] 0.5231926</code></pre>
<p>As before we can obtain the raw variance component estimates and genetic correlations for the random effects:</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="mcmcglmm-2.html#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior.mode</span>(model2<span class="fl">.2</span><span class="sc">$</span>VCV)</span></code></pre></div>
<pre><code>##       traitbwt:traitbwt.animal    traittarsus:traitbwt.animal 
##                     1.32761860                     1.98076467 
##    traitbwt:traittarsus.animal traittarsus:traittarsus.animal 
##                     1.98076467                     0.07827994 
##        traitbwt:traitbwt.byear     traittarsus:traitbwt.byear 
##                     0.83300490                    -0.14691430 
##     traitbwt:traittarsus.byear  traittarsus:traittarsus.byear 
##                    -0.14691430                     2.79242863 
##       traitbwt:traitbwt.mother    traittarsus:traitbwt.mother 
##                     1.29299116                    -1.97967150 
##    traitbwt:traittarsus.mother traittarsus:traittarsus.mother 
##                    -1.97967150                     3.71594577 
##        traitbwt:traitbwt.units     traittarsus:traitbwt.units 
##                     2.53632072                     5.22764927 
##     traitbwt:traittarsus.units  traittarsus:traittarsus.units 
##                     5.22764927                    16.57931045</code></pre>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="mcmcglmm-2.html#cb158-1" aria-hidden="true" tabindex="-1"></a>genetic.correlation2<span class="fl">.2</span> <span class="ot">&lt;-</span> model2<span class="fl">.2</span><span class="sc">$</span>VCV[, <span class="st">&quot;traitbwt:traittarsus.animal&quot;</span>] <span class="sc">/</span> <span class="fu">sqrt</span>(model2<span class="fl">.2</span><span class="sc">$</span>VCV[, <span class="st">&quot;traitbwt:traitbwt.animal&quot;</span>] <span class="sc">*</span> model2<span class="fl">.2</span><span class="sc">$</span>VCV[, <span class="st">&quot;traittarsus:traittarsus.animal&quot;</span>])</span>
<span id="cb158-2"><a href="mcmcglmm-2.html#cb158-2" aria-hidden="true" tabindex="-1"></a>maternal.correlation2<span class="fl">.2</span> <span class="ot">&lt;-</span> model2<span class="fl">.2</span><span class="sc">$</span>VCV[, <span class="st">&quot;traitbwt:traittarsus.mother&quot;</span>] <span class="sc">/</span> <span class="fu">sqrt</span>(model2<span class="fl">.2</span><span class="sc">$</span>VCV[, <span class="st">&quot;traitbwt:traitbwt.mother&quot;</span>] <span class="sc">*</span> model2<span class="fl">.2</span><span class="sc">$</span>VCV[, <span class="st">&quot;traittarsus:traittarsus.mother&quot;</span>])</span>
<span id="cb158-3"><a href="mcmcglmm-2.html#cb158-3" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior.mode</span>(genetic.correlation2<span class="fl">.2</span>)</span></code></pre></div>
<pre><code>##      var1 
## 0.9942065</code></pre>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="mcmcglmm-2.html#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior.mode</span>(maternal.correlation2<span class="fl">.2</span>)</span></code></pre></div>
<pre><code>##       var1 
## -0.9920879</code></pre>
<p>Evaluation of the statistical support for these genetic and maternal correlations is straightforward. Because we imposed no constraint on their estimation, we can evaluate the extent to which the posterior distributions overlap zero:</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="mcmcglmm-2.html#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="fu">HPDinterval</span>(genetic.correlation2<span class="fl">.2</span>, <span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>##          lower     upper
## var1 0.3935369 0.9990187
## attr(,&quot;Probability&quot;)
## [1] 0.95</code></pre>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="mcmcglmm-2.html#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="fu">HPDinterval</span>(maternal.correlation2<span class="fl">.2</span>, <span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>##           lower      upper
## var1 -0.9980476 -0.9443838
## attr(,&quot;Probability&quot;)
## [1] 0.95</code></pre>
<p>Neither or these posterior distributions overlapps zero, so we can consider them both statistically supported.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="gremlin-2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="brms-2.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/JulienGAMartin/wam_tuto/03_03-biv_mcmcglmm.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["wam_tuto.pdf", "wam_tuto.epub", "wam_tuto.mobi"],
"toc": {
"collapse": "subsection",
"scroll_highlight": true
},
"toc_depth": 4
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
