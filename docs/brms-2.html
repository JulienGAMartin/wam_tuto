<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3.5 brms | How to fit an animal model</title>
  <meta name="description" content="Updated and extended tutorials from An ecologist guide to animal model (Wilson et al. 2010)" />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="3.5 brms | How to fit an animal model" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/images/missing.png" />
  <meta property="og:description" content="Updated and extended tutorials from An ecologist guide to animal model (Wilson et al. 2010)" />
  <meta name="github-repo" content="JulienGAMartin/wam_tuto" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3.5 brms | How to fit an animal model" />
  
  <meta name="twitter:description" content="Updated and extended tutorials from An ecologist guide to animal model (Wilson et al. 2010)" />
  <meta name="twitter:image" content="/images/missing.png" />

<meta name="author" content="Julien Martin" />
<meta name="author" content="Matthieu Videlier" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="mcmcglmm-2.html"/>
<link rel="next" href="stan-1.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">How to fit an animal model</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#contributors"><i class="fa fa-check"></i>Contributors</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>1.1</b> Data</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="data.html"><a href="data.html#data-files"><i class="fa fa-check"></i><b>1.1.1</b> Data files</a></li>
<li class="chapter" data-level="1.1.2" data-path="data.html"><a href="data.html#notes-on-data-and-pedigree"><i class="fa fa-check"></i><b>1.1.2</b> Notes on data and pedigree</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="r.html"><a href="r.html"><i class="fa fa-check"></i><b>1.2</b> R</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="r.html"><a href="r.html#r-packages"><i class="fa fa-check"></i><b>1.2.1</b> R packages</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="univariate-animal-model.html"><a href="univariate-animal-model.html"><i class="fa fa-check"></i><b>2</b> Univariate animal model</a>
<ul>
<li class="chapter" data-level="2.1" data-path="scenario-and-data.html"><a href="scenario-and-data.html"><i class="fa fa-check"></i><b>2.1</b> Scenario and data</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="scenario-and-data.html"><a href="scenario-and-data.html#scenario"><i class="fa fa-check"></i><b>2.1.1</b> Scenario</a></li>
<li class="chapter" data-level="2.1.2" data-path="scenario-and-data.html"><a href="scenario-and-data.html#data-files-1"><i class="fa fa-check"></i><b>2.1.2</b> Data files</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="asreml-r-1.html"><a href="asreml-r-1.html"><i class="fa fa-check"></i><b>2.2</b> Asreml-R</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="asreml-r-1.html"><a href="asreml-r-1.html#running-the-model"><i class="fa fa-check"></i><b>2.2.1</b> Running the model</a></li>
<li class="chapter" data-level="2.2.2" data-path="asreml-r-1.html"><a href="asreml-r-1.html#estimating-heritability"><i class="fa fa-check"></i><b>2.2.2</b> Estimating heritability</a></li>
<li class="chapter" data-level="2.2.3" data-path="asreml-r-1.html"><a href="asreml-r-1.html#adding-fixed-effects"><i class="fa fa-check"></i><b>2.2.3</b> Adding fixed effects</a></li>
<li class="chapter" data-level="2.2.4" data-path="asreml-r-1.html"><a href="asreml-r-1.html#adding-random-effects"><i class="fa fa-check"></i><b>2.2.4</b> Adding random effects</a></li>
<li class="chapter" data-level="2.2.5" data-path="asreml-r-1.html"><a href="asreml-r-1.html#testing-significance-of-random-effects"><i class="fa fa-check"></i><b>2.2.5</b> Testing significance of random effects</a></li>
<li class="chapter" data-level="2.2.6" data-path="asreml-r-1.html"><a href="asreml-r-1.html#further-partitioning-the-variance"><i class="fa fa-check"></i><b>2.2.6</b> Further partitioning the variance</a></li>
<li class="chapter" data-level="2.2.7" data-path="asreml-r-1.html"><a href="asreml-r-1.html#modification-of-the-varaince-matrix-parameters"><i class="fa fa-check"></i><b>2.2.7</b> Modification of the varaince matrix parameters</a></li>
<li class="chapter" data-level="2.2.8" data-path="asreml-r-1.html"><a href="asreml-r-1.html#covariance-between-two-random-effects"><i class="fa fa-check"></i><b>2.2.8</b> Covariance between two random effects</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="gremlin-1.html"><a href="gremlin-1.html"><i class="fa fa-check"></i><b>2.3</b> gremlin</a></li>
<li class="chapter" data-level="2.4" data-path="mcmcglmm-1.html"><a href="mcmcglmm-1.html"><i class="fa fa-check"></i><b>2.4</b> MCMCglmm</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="mcmcglmm-1.html"><a href="mcmcglmm-1.html#running-the-model-1"><i class="fa fa-check"></i><b>2.4.1</b> Running the model</a></li>
<li class="chapter" data-level="2.4.2" data-path="mcmcglmm-1.html"><a href="mcmcglmm-1.html#change-in-iteration-and-sampling"><i class="fa fa-check"></i><b>2.4.2</b> Change in iteration and sampling</a></li>
<li class="chapter" data-level="2.4.3" data-path="mcmcglmm-1.html"><a href="mcmcglmm-1.html#change-priors-parameters"><i class="fa fa-check"></i><b>2.4.3</b> Change priors parameters</a></li>
<li class="chapter" data-level="2.4.4" data-path="mcmcglmm-1.html"><a href="mcmcglmm-1.html#estimating-heritability-1"><i class="fa fa-check"></i><b>2.4.4</b> Estimating heritability</a></li>
<li class="chapter" data-level="2.4.5" data-path="mcmcglmm-1.html"><a href="mcmcglmm-1.html#adding-fixed-effects-1"><i class="fa fa-check"></i><b>2.4.5</b> Adding fixed effects</a></li>
<li class="chapter" data-level="2.4.6" data-path="mcmcglmm-1.html"><a href="mcmcglmm-1.html#adding-random-effects-1"><i class="fa fa-check"></i><b>2.4.6</b> Adding random effects</a></li>
<li class="chapter" data-level="2.4.7" data-path="mcmcglmm-1.html"><a href="mcmcglmm-1.html#testing-significance-of-variance-components"><i class="fa fa-check"></i><b>2.4.7</b> Testing significance of variance components</a></li>
<li class="chapter" data-level="2.4.8" data-path="mcmcglmm-1.html"><a href="mcmcglmm-1.html#further-partitioning-variance"><i class="fa fa-check"></i><b>2.4.8</b> Further partitioning variance</a></li>
<li class="chapter" data-level="2.4.9" data-path="mcmcglmm-1.html"><a href="mcmcglmm-1.html#modification-of-model-parameter"><i class="fa fa-check"></i><b>2.4.9</b> Modification of model parameter</a></li>
<li class="chapter" data-level="2.4.10" data-path="mcmcglmm-1.html"><a href="mcmcglmm-1.html#covariance-between-two-random-effects-1"><i class="fa fa-check"></i><b>2.4.10</b> Covariance between two random effects</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="brms-1.html"><a href="brms-1.html"><i class="fa fa-check"></i><b>2.5</b> brms</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="brms-1.html"><a href="brms-1.html#running-the-model-2"><i class="fa fa-check"></i><b>2.5.1</b> Running the model</a></li>
<li class="chapter" data-level="2.5.2" data-path="brms-1.html"><a href="brms-1.html#adding-fixed-effects-2"><i class="fa fa-check"></i><b>2.5.2</b> Adding fixed effects</a></li>
<li class="chapter" data-level="2.5.3" data-path="brms-1.html"><a href="brms-1.html#adding-random-effects-2"><i class="fa fa-check"></i><b>2.5.3</b> Adding random effects</a></li>
<li class="chapter" data-level="2.5.4" data-path="brms-1.html"><a href="brms-1.html#testing-significance-of-variance-components-1"><i class="fa fa-check"></i><b>2.5.4</b> Testing significance of variance components</a></li>
<li class="chapter" data-level="2.5.5" data-path="brms-1.html"><a href="brms-1.html#further-partitioning-of-the-variance"><i class="fa fa-check"></i><b>2.5.5</b> Further partitioning of the variance</a></li>
<li class="chapter" data-level="2.5.6" data-path="brms-1.html"><a href="brms-1.html#modification-of-model-parameter-1"><i class="fa fa-check"></i><b>2.5.6</b> Modification of model parameter</a></li>
<li class="chapter" data-level="2.5.7" data-path="brms-1.html"><a href="brms-1.html#covariance-between-two-random-effects-2"><i class="fa fa-check"></i><b>2.5.7</b> Covariance between two random effects</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="stan.html"><a href="stan.html"><i class="fa fa-check"></i><b>2.6</b> stan</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="multivariate-animal-model.html"><a href="multivariate-animal-model.html"><i class="fa fa-check"></i><b>3</b> Multivariate animal model</a>
<ul>
<li class="chapter" data-level="3.1" data-path="scenario-and-data-1.html"><a href="scenario-and-data-1.html"><i class="fa fa-check"></i><b>3.1</b> Scenario and data</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="scenario-and-data-1.html"><a href="scenario-and-data-1.html#scenario-1"><i class="fa fa-check"></i><b>3.1.1</b> Scenario</a></li>
<li class="chapter" data-level="3.1.2" data-path="scenario-and-data-1.html"><a href="scenario-and-data-1.html#gryphon-files"><i class="fa fa-check"></i><b>3.1.2</b> gryphon files</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="asreml-biv.html"><a href="asreml-biv.html"><i class="fa fa-check"></i><b>3.2</b> Asreml-R</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="asreml-biv.html"><a href="asreml-biv.html#running-the-model-3"><i class="fa fa-check"></i><b>3.2.1</b> Running the model</a></li>
<li class="chapter" data-level="3.2.2" data-path="asreml-biv.html"><a href="asreml-biv.html#adding-fixed-and-random-effects"><i class="fa fa-check"></i><b>3.2.2</b> Adding fixed and random effects</a></li>
<li class="chapter" data-level="3.2.3" data-path="asreml-biv.html"><a href="asreml-biv.html#significance-testing"><i class="fa fa-check"></i><b>3.2.3</b> Significance testing</a></li>
<li class="chapter" data-level="3.2.4" data-path="asreml-biv.html"><a href="asreml-biv.html#estimate-directly-the-genetic-correlation-within-the-model"><i class="fa fa-check"></i><b>3.2.4</b> Estimate directly the genetic correlation within the model</a></li>
<li class="chapter" data-level="3.2.5" data-path="asreml-biv.html"><a href="asreml-biv.html#visualisation-of-the-correlation-aka-blup-extraction"><i class="fa fa-check"></i><b>3.2.5</b> Visualisation of the correlation (aka BLUP extraction)</a></li>
<li class="chapter" data-level="3.2.6" data-path="asreml-biv.html"><a href="asreml-biv.html#partitionning-covariance-between-groups"><i class="fa fa-check"></i><b>3.2.6</b> Partitionning (co)variance between groups</a></li>
<li class="chapter" data-level="3.2.7" data-path="asreml-biv.html"><a href="asreml-biv.html#between-groups-covariances-and-the-b-matrix"><i class="fa fa-check"></i><b>3.2.7</b> Between groups (co)variances and the B-matrix</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="gremlin-2.html"><a href="gremlin-2.html"><i class="fa fa-check"></i><b>3.3</b> gremlin</a></li>
<li class="chapter" data-level="3.4" data-path="mcmcglmm-2.html"><a href="mcmcglmm-2.html"><i class="fa fa-check"></i><b>3.4</b> MCMCglmm</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="mcmcglmm-2.html"><a href="mcmcglmm-2.html#fitting-the-model"><i class="fa fa-check"></i><b>3.4.1</b> Fitting the model</a></li>
<li class="chapter" data-level="3.4.2" data-path="mcmcglmm-2.html"><a href="mcmcglmm-2.html#adding-fixed-and-random-effects-1"><i class="fa fa-check"></i><b>3.4.2</b> Adding fixed and random effects</a></li>
<li class="chapter" data-level="3.4.3" data-path="mcmcglmm-2.html"><a href="mcmcglmm-2.html#direct-estimate-of-the-correlation-instead-of-the-covariance."><i class="fa fa-check"></i><b>3.4.3</b> Direct estimate of the correlation instead of the covariance.</a></li>
<li class="chapter" data-level="3.4.4" data-path="mcmcglmm-2.html"><a href="mcmcglmm-2.html#partitioning-covariances"><i class="fa fa-check"></i><b>3.4.4</b> Partitioning (co)variances</a></li>
<li class="chapter" data-level="3.4.5" data-path="mcmcglmm-2.html"><a href="mcmcglmm-2.html#between-groups-covariances-and-the-b-matrix-1"><i class="fa fa-check"></i><b>3.4.5</b> Between groups (co)variances and the B-matrix</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="brms-2.html"><a href="brms-2.html"><i class="fa fa-check"></i><b>3.5</b> brms</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="brms-2.html"><a href="brms-2.html#fitting-the-model-1"><i class="fa fa-check"></i><b>3.5.1</b> Fitting the model</a></li>
<li class="chapter" data-level="3.5.2" data-path="brms-2.html"><a href="brms-2.html#adding-fixed-and-random-effects-2"><i class="fa fa-check"></i><b>3.5.2</b> Adding fixed and random effects</a></li>
<li class="chapter" data-level="3.5.3" data-path="brms-2.html"><a href="brms-2.html#partitioning-covariances-1"><i class="fa fa-check"></i><b>3.5.3</b> Partitioning (co)variances</a></li>
<li class="chapter" data-level="3.5.4" data-path="brms-2.html"><a href="brms-2.html#between-groups-covariances-and-the-b-matrix-2"><i class="fa fa-check"></i><b>3.5.4</b> Between groups (co)variances and the B-matrix</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="stan-1.html"><a href="stan-1.html"><i class="fa fa-check"></i><b>3.6</b> stan</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="rep_measures.html"><a href="rep_measures.html"><i class="fa fa-check"></i><b>4</b> A repeated measures animal model</a>
<ul>
<li class="chapter" data-level="4.1" data-path="scenario-and-data-2.html"><a href="scenario-and-data-2.html"><i class="fa fa-check"></i><b>4.1</b> Scenario and data</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="scenario-and-data-2.html"><a href="scenario-and-data-2.html#scenario-2"><i class="fa fa-check"></i><b>4.1.1</b> scenario</a></li>
<li class="chapter" data-level="4.1.2" data-path="scenario-and-data-2.html"><a href="scenario-and-data-2.html#data-files-2"><i class="fa fa-check"></i><b>4.1.2</b> Data files</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="asreml-r-2.html"><a href="asreml-r-2.html"><i class="fa fa-check"></i><b>4.2</b> Asreml-R</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="asreml-r-2.html"><a href="asreml-r-2.html#estimating-repeatability"><i class="fa fa-check"></i><b>4.2.1</b> Estimating repeatability</a></li>
<li class="chapter" data-level="4.2.2" data-path="asreml-r-2.html"><a href="asreml-r-2.html#partitioning-additive-and-permanent-environment-effects"><i class="fa fa-check"></i><b>4.2.2</b> Partitioning additive and permanent environment effects</a></li>
<li class="chapter" data-level="4.2.3" data-path="asreml-r-2.html"><a href="asreml-r-2.html#adding-additional-effects-and-testing-significance"><i class="fa fa-check"></i><b>4.2.3</b> Adding additional effects and testing significance</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="gremlin-3.html"><a href="gremlin-3.html"><i class="fa fa-check"></i><b>4.3</b> gremlin</a></li>
<li class="chapter" data-level="4.4" data-path="mcmcglmm-3.html"><a href="mcmcglmm-3.html"><i class="fa fa-check"></i><b>4.4</b> MCMCglmm</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="mcmcglmm-3.html"><a href="mcmcglmm-3.html#estimating-repeatability-1"><i class="fa fa-check"></i><b>4.4.1</b> Estimating repeatability</a></li>
<li class="chapter" data-level="4.4.2" data-path="mcmcglmm-3.html"><a href="mcmcglmm-3.html#partitioning-additive-and-permanent-environment-effects-1"><i class="fa fa-check"></i><b>4.4.2</b> Partitioning additive and permanent environment effects</a></li>
<li class="chapter" data-level="4.4.3" data-path="mcmcglmm-3.html"><a href="mcmcglmm-3.html#adding-additional-effects-and-testing-significance-1"><i class="fa fa-check"></i><b>4.4.3</b> Adding additional effects and testing significance</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="brms-3.html"><a href="brms-3.html"><i class="fa fa-check"></i><b>4.5</b> brms</a></li>
<li class="chapter" data-level="4.6" data-path="stan-2.html"><a href="stan-2.html"><i class="fa fa-check"></i><b>4.6</b> stan</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="quick-comparison-of-codes.html"><a href="quick-comparison-of-codes.html"><i class="fa fa-check"></i><b>5</b> Quick comparison of codes</a>
<ul>
<li class="chapter" data-level="5.1" data-path="univariate-model-with-repeated-measures.html"><a href="univariate-model-with-repeated-measures.html"><i class="fa fa-check"></i><b>5.1</b> Univariate model with repeated measures</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="univariate-model-with-repeated-measures.html"><a href="univariate-model-with-repeated-measures.html#asreml-r-3"><i class="fa fa-check"></i><b>5.1.1</b> Asreml-R</a></li>
<li class="chapter" data-level="5.1.2" data-path="univariate-model-with-repeated-measures.html"><a href="univariate-model-with-repeated-measures.html#gremlin-4"><i class="fa fa-check"></i><b>5.1.2</b> gremlin</a></li>
<li class="chapter" data-level="5.1.3" data-path="univariate-model-with-repeated-measures.html"><a href="univariate-model-with-repeated-measures.html#mcmcglmm-4"><i class="fa fa-check"></i><b>5.1.3</b> MCMCglmm</a></li>
<li class="chapter" data-level="5.1.4" data-path="univariate-model-with-repeated-measures.html"><a href="univariate-model-with-repeated-measures.html#brms-4"><i class="fa fa-check"></i><b>5.1.4</b> brms</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="bivariate-model.html"><a href="bivariate-model.html"><i class="fa fa-check"></i><b>5.2</b> bivariate model</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="bivariate-model.html"><a href="bivariate-model.html#asreml-r-4"><i class="fa fa-check"></i><b>5.2.1</b> Asreml-R</a></li>
<li class="chapter" data-level="5.2.2" data-path="bivariate-model.html"><a href="bivariate-model.html#gremlin-5"><i class="fa fa-check"></i><b>5.2.2</b> gremlin</a></li>
<li class="chapter" data-level="5.2.3" data-path="bivariate-model.html"><a href="bivariate-model.html#mcmcglmm-5"><i class="fa fa-check"></i><b>5.2.3</b> MCMCglmm</a></li>
<li class="chapter" data-level="5.2.4" data-path="bivariate-model.html"><a href="bivariate-model.html#brms-5"><i class="fa fa-check"></i><b>5.2.4</b> brms</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="_blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">How to fit an animal model</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="brms-2" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> brms<a href="brms-2.html#brms-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>First load brms:</p>
<div class="sourceCode" id="cb481"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb481-1"><a href="brms-2.html#cb481-1" aria-hidden="true"></a><span class="kw">library</span>(brms)</span>
<span id="cb481-2"><a href="brms-2.html#cb481-2" aria-hidden="true"></a>Amat &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(nadiv<span class="op">::</span><span class="kw">makeA</span>(gryphonped))</span></code></pre></div>
<div id="fitting-the-model-1" class="section level3 hasAnchor" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Fitting the model<a href="brms-2.html#fitting-the-model-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Fitting a multivariate model in brms involves several new consideration above those for fitting univariate models.
First, we need to create two models/objects with the function <code>bf</code> fitting the desired univariate model structure for each response variable (here <code>bwt</code> and <code>tarsus</code>). It is the equivalent of writing <code>mvbf(bwt, tarsus)</code>, but the advantage to create two distinct model is to specific different model structure (fixed or random effect) for each response variable.</p>
<p>Then, the two objects/models are added into a third model to quantify all the estimates in addition to their covariance. Contrary to MCMCglmm or asreml-R, brms directly estimate the covariance and the correlation in its outputs.
Our most basic model can be specified as:</p>
<div class="sourceCode" id="cb482"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb482-1"><a href="brms-2.html#cb482-1" aria-hidden="true"></a>bf_bwt &lt;-<span class="st"> </span><span class="kw">bf</span>(bwt <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>a <span class="op">|</span><span class="st"> </span><span class="kw">gr</span>(animal, <span class="dt">cov =</span> Amat)))</span>
<span id="cb482-2"><a href="brms-2.html#cb482-2" aria-hidden="true"></a>bf_tarsus &lt;-<span class="st"> </span><span class="kw">bf</span>(tarsus <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>a <span class="op">|</span><span class="st"> </span><span class="kw">gr</span>(animal, <span class="dt">cov =</span> Amat)))</span>
<span id="cb482-3"><a href="brms-2.html#cb482-3" aria-hidden="true"></a>brms_m2<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="kw">brm</span>(</span>
<span id="cb482-4"><a href="brms-2.html#cb482-4" aria-hidden="true"></a>  bf_bwt <span class="op">+</span><span class="st"> </span>bf_tarsus <span class="op">+</span><span class="st"> </span><span class="kw">set_rescor</span>(<span class="ot">TRUE</span>),</span>
<span id="cb482-5"><a href="brms-2.html#cb482-5" aria-hidden="true"></a>  <span class="dt">data =</span> gryphon,</span>
<span id="cb482-6"><a href="brms-2.html#cb482-6" aria-hidden="true"></a>  <span class="dt">data2 =</span> <span class="kw">list</span>(<span class="dt">Amat =</span> Amat),</span>
<span id="cb482-7"><a href="brms-2.html#cb482-7" aria-hidden="true"></a>  <span class="dt">chains =</span> <span class="dv">2</span>, <span class="dt">cores =</span> <span class="dv">2</span>, <span class="dt">iter =</span> <span class="dv">1000</span></span>
<span id="cb482-8"><a href="brms-2.html#cb482-8" aria-hidden="true"></a>)</span>
<span id="cb482-9"><a href="brms-2.html#cb482-9" aria-hidden="true"></a><span class="kw">save</span>(brms_m2<span class="fl">.1</span>, <span class="dt">file =</span> <span class="st">&quot;data/brms_m2_1.rda&quot;</span>)</span></code></pre></div>
<p>Again we have provided the data from one such run. It can be accessed using the code:</p>
<div class="sourceCode" id="cb483"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb483-1"><a href="brms-2.html#cb483-1" aria-hidden="true"></a><span class="kw">load</span>(<span class="st">&quot;data/brms_m2_1.rda&quot;</span>)</span>
<span id="cb483-2"><a href="brms-2.html#cb483-2" aria-hidden="true"></a><span class="kw">summary</span>(brms_m2<span class="fl">.1</span>)</span></code></pre></div>
<pre><code>## Warning: Parts of the model have not converged (some Rhats are &gt; 1.05). Be
## careful when analysing the results! We recommend running more iterations and/or
## setting stronger priors.</code></pre>
<pre><code>##  Family: MV(gaussian, gaussian) 
##   Links: mu = identity; sigma = identity
##          mu = identity; sigma = identity 
## Formula: bwt ~ 1 + (1 | p | gr(animal, cov = Amat)) 
##          tarsus ~ 1 + (1 | p | gr(animal, cov = Amat)) 
##    Data: gryphon (Number of observations: 683) 
##   Draws: 2 chains, each with iter = 1000; warmup = 500; thin = 1;
##          total post-warmup draws = 1000
## 
## Group-Level Effects: 
## ~animal (Number of levels: 683) 
##                                     Estimate Est.Error l-95% CI u-95% CI Rhat
## sd(bwt_Intercept)                       1.81      0.21     1.41     2.20 1.06
## sd(tarsus_Intercept)                    3.44      0.43     2.49     4.25 1.05
## cor(bwt_Intercept,tarsus_Intercept)     0.38      0.14     0.08     0.62 1.02
##                                     Bulk_ESS Tail_ESS
## sd(bwt_Intercept)                         31      192
## sd(tarsus_Intercept)                      61      173
## cor(bwt_Intercept,tarsus_Intercept)      101      232
## 
## Population-Level Effects: 
##                  Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## bwt_Intercept        7.49      0.16     7.20     7.79 1.00      608      839
## tarsus_Intercept    20.47      0.30    19.92    21.03 1.00      868      803
## 
## Family Specific Parameters: 
##              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma_bwt        1.97      0.16     1.66     2.28 1.06       27      172
## sigma_tarsus     4.24      0.30     3.63     4.82 1.04       72      162
## 
## Residual Correlations: 
##                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## rescor(bwt,tarsus)     0.39      0.09     0.21     0.55 1.02       95      179
## 
## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<div class="sourceCode" id="cb486"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb486-1"><a href="brms-2.html#cb486-1" aria-hidden="true"></a><span class="kw">plot</span>(brms_m2<span class="fl">.1</span>, <span class="dt">ask =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p><img src="wam_tuto_files/figure-html/unnamed-chunk-145-1.svg" width="672" /><img src="wam_tuto_files/figure-html/unnamed-chunk-145-2.svg" width="672" /></p>
<div class="sourceCode" id="cb487"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb487-1"><a href="brms-2.html#cb487-1" aria-hidden="true"></a><span class="kw">VarCorr</span>(brms_m2<span class="fl">.1</span>)</span></code></pre></div>
<pre><code>## $animal
## $animal$sd
##                  Estimate Est.Error     Q2.5    Q97.5
## bwt_Intercept    1.808171 0.2050233 1.412824 2.204805
## tarsus_Intercept 3.438368 0.4283612 2.491218 4.245264
## 
## $animal$cor
## , , bwt_Intercept
## 
##                   Estimate Est.Error       Q2.5     Q97.5
## bwt_Intercept    1.0000000 0.0000000 1.00000000 1.0000000
## tarsus_Intercept 0.3814062 0.1380014 0.07581464 0.6209038
## 
## , , tarsus_Intercept
## 
##                   Estimate Est.Error       Q2.5     Q97.5
## bwt_Intercept    0.3814062 0.1380014 0.07581464 0.6209038
## tarsus_Intercept 1.0000000 0.0000000 1.00000000 1.0000000
## 
## 
## $animal$cov
## , , bwt_Intercept
## 
##                  Estimate Est.Error      Q2.5    Q97.5
## bwt_Intercept    3.311473 0.7430185 1.9960721 4.861167
## tarsus_Intercept 2.440166 1.0901689 0.3870783 4.668720
## 
## , , tarsus_Intercept
## 
##                   Estimate Est.Error      Q2.5    Q97.5
## bwt_Intercept     2.440166  1.090169 0.3870783  4.66872
## tarsus_Intercept 12.005688  2.918741 6.2061701 18.02226
## 
## 
## 
## $residual__
## $residual__$sd
##        Estimate Est.Error     Q2.5    Q97.5
## bwt    1.970532 0.1597581 1.658782 2.276074
## tarsus 4.244704 0.2984518 3.632824 4.820109
## 
## $residual__$cor
## , , bwt
## 
##         Estimate  Est.Error      Q2.5     Q97.5
## bwt    1.0000000 0.00000000 1.0000000 1.0000000
## tarsus 0.3888754 0.08510488 0.2127907 0.5526631
## 
## , , tarsus
## 
##         Estimate  Est.Error      Q2.5     Q97.5
## bwt    0.3888754 0.08510488 0.2127907 0.5526631
## tarsus 1.0000000 0.00000000 1.0000000 1.0000000
## 
## 
## $residual__$cov
## , , bwt
## 
##        Estimate Est.Error     Q2.5    Q97.5
## bwt    3.908493 0.6282892 2.751557 5.180511
## tarsus 3.289995 0.9305960 1.572647 5.147133
## 
## , , tarsus
## 
##         Estimate Est.Error      Q2.5     Q97.5
## bwt     3.289995  0.930596  1.572647  5.147133
## tarsus 18.106495  2.530138 13.197409 23.233452</code></pre>
<p>It is also possible to calculate the heritability for each trait using the function ‘as.mcmc’</p>
<div class="sourceCode" id="cb489"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb489-1"><a href="brms-2.html#cb489-1" aria-hidden="true"></a>v_animal &lt;-<span class="st"> </span>(<span class="kw">VarCorr</span>(brms_m2<span class="fl">.1</span>, <span class="dt">summary =</span> <span class="ot">FALSE</span>)<span class="op">$</span>animal<span class="op">$</span>sd)<span class="op">^</span><span class="dv">2</span></span>
<span id="cb489-2"><a href="brms-2.html#cb489-2" aria-hidden="true"></a>v_r &lt;-<span class="st"> </span>(<span class="kw">VarCorr</span>(brms_m2<span class="fl">.1</span>, <span class="dt">summary =</span> <span class="ot">FALSE</span>)<span class="op">$</span>residual<span class="op">$</span>sd)<span class="op">^</span><span class="dv">2</span></span>
<span id="cb489-3"><a href="brms-2.html#cb489-3" aria-hidden="true"></a></span>
<span id="cb489-4"><a href="brms-2.html#cb489-4" aria-hidden="true"></a>h.bwt<span class="fl">.2</span> &lt;-<span class="st"> </span><span class="kw">as.mcmc</span>(v_animal[, <span class="dv">1</span>] <span class="op">/</span><span class="st"> </span>(v_animal[, <span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>v_r[, <span class="dv">1</span>]))</span>
<span id="cb489-5"><a href="brms-2.html#cb489-5" aria-hidden="true"></a>h.tarsus<span class="fl">.2</span> &lt;-<span class="st"> </span><span class="kw">as.mcmc</span>(v_animal[, <span class="dv">1</span>] <span class="op">/</span><span class="st"> </span>(v_animal[, <span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>v_r[, <span class="dv">1</span>]))</span>
<span id="cb489-6"><a href="brms-2.html#cb489-6" aria-hidden="true"></a></span>
<span id="cb489-7"><a href="brms-2.html#cb489-7" aria-hidden="true"></a><span class="kw">summary</span>(h.bwt<span class="fl">.2</span>)</span></code></pre></div>
<pre><code>## 
## Iterations = 1:1000
## Thinning interval = 1 
## Number of chains = 1 
## Sample size per chain = 1000 
## 
## 1. Empirical mean and standard deviation for each variable,
##    plus standard error of the mean:
## 
##           Mean             SD       Naive SE Time-series SE 
##       0.457051       0.090878       0.002874       0.011675 
## 
## 2. Quantiles for each variable:
## 
##   2.5%    25%    50%    75%  97.5% 
## 0.2878 0.3926 0.4596 0.5254 0.6297</code></pre>
<div class="sourceCode" id="cb491"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb491-1"><a href="brms-2.html#cb491-1" aria-hidden="true"></a><span class="kw">summary</span>(h.tarsus<span class="fl">.2</span>)</span></code></pre></div>
<pre><code>## 
## Iterations = 1:1000
## Thinning interval = 1 
## Number of chains = 1 
## Sample size per chain = 1000 
## 
## 1. Empirical mean and standard deviation for each variable,
##    plus standard error of the mean:
## 
##           Mean             SD       Naive SE Time-series SE 
##       0.457051       0.090878       0.002874       0.011675 
## 
## 2. Quantiles for each variable:
## 
##   2.5%    25%    50%    75%  97.5% 
## 0.2878 0.3926 0.4596 0.5254 0.6297</code></pre>
<div class="sourceCode" id="cb493"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb493-1"><a href="brms-2.html#cb493-1" aria-hidden="true"></a><span class="kw">plot</span>(h.bwt<span class="fl">.2</span>)</span>
<span id="cb493-2"><a href="brms-2.html#cb493-2" aria-hidden="true"></a><span class="kw">plot</span>(h.tarsus<span class="fl">.2</span>)</span></code></pre></div>
<p><img src="wam_tuto_files/figure-html/unnamed-chunk-146-1.svg" width="672" /></p>
<p>It is also possible to extract the correlation. Just to remember it is an example, the correlation distribution is skewed to 1 due to a weak prior and model parameters.
Note, since</p>
<div class="sourceCode" id="cb494"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb494-1"><a href="brms-2.html#cb494-1" aria-hidden="true"></a>cor_g &lt;-<span class="st"> </span><span class="kw">as.mcmc</span>((<span class="kw">VarCorr</span>(brms_m2<span class="fl">.1</span>, <span class="dt">summary =</span> <span class="ot">FALSE</span>)<span class="op">$</span>animal<span class="op">$</span>cor[, <span class="dv">1</span>, <span class="dv">2</span>]))</span>
<span id="cb494-2"><a href="brms-2.html#cb494-2" aria-hidden="true"></a>cor_res &lt;-<span class="st"> </span><span class="kw">as.mcmc</span>((<span class="kw">VarCorr</span>(brms_m2<span class="fl">.1</span>, <span class="dt">summary =</span> <span class="ot">FALSE</span>)<span class="op">$</span>residual<span class="op">$</span>cor[, <span class="dv">1</span>, <span class="dv">2</span>]))</span>
<span id="cb494-3"><a href="brms-2.html#cb494-3" aria-hidden="true"></a></span>
<span id="cb494-4"><a href="brms-2.html#cb494-4" aria-hidden="true"></a><span class="kw">summary</span>(cor_g)</span></code></pre></div>
<pre><code>## 
## Iterations = 1:1000
## Thinning interval = 1 
## Number of chains = 1 
## Sample size per chain = 1000 
## 
## 1. Empirical mean and standard deviation for each variable,
##    plus standard error of the mean:
## 
##           Mean             SD       Naive SE Time-series SE 
##       0.381406       0.138001       0.004364       0.014946 
## 
## 2. Quantiles for each variable:
## 
##    2.5%     25%     50%     75%   97.5% 
## 0.07581 0.30354 0.39041 0.47497 0.62090</code></pre>
<div class="sourceCode" id="cb496"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb496-1"><a href="brms-2.html#cb496-1" aria-hidden="true"></a><span class="kw">summary</span>(cor_res)</span></code></pre></div>
<pre><code>## 
## Iterations = 1:1000
## Thinning interval = 1 
## Number of chains = 1 
## Sample size per chain = 1000 
## 
## 1. Empirical mean and standard deviation for each variable,
##    plus standard error of the mean:
## 
##           Mean             SD       Naive SE Time-series SE 
##       0.388875       0.085105       0.002691       0.009215 
## 
## 2. Quantiles for each variable:
## 
##   2.5%    25%    50%    75%  97.5% 
## 0.2128 0.3319 0.3913 0.4484 0.5527</code></pre>
<div class="sourceCode" id="cb498"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb498-1"><a href="brms-2.html#cb498-1" aria-hidden="true"></a><span class="kw">plot</span>(cor_g)</span></code></pre></div>
<p><img src="wam_tuto_files/figure-html/unnamed-chunk-147-1.svg" width="672" /></p>
<div class="sourceCode" id="cb499"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb499-1"><a href="brms-2.html#cb499-1" aria-hidden="true"></a><span class="kw">plot</span>(cor_res)</span></code></pre></div>
<p><img src="wam_tuto_files/figure-html/unnamed-chunk-147-2.svg" width="672" /></p>
<p>Here we can plot the genetic correlation by extraction the breeding values or BLUP.</p>
<div class="sourceCode" id="cb500"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb500-1"><a href="brms-2.html#cb500-1" aria-hidden="true"></a>bls_m2<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="kw">ranef</span>(brms_m2<span class="fl">.1</span>)<span class="op">$</span>animal</span>
<span id="cb500-2"><a href="brms-2.html#cb500-2" aria-hidden="true"></a>bl_m2<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(abind<span class="op">::</span><span class="kw">abind</span>(<span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">dim</span>(bls_m2<span class="fl">.1</span>)[[<span class="dv">3</span>]], <span class="cf">function</span>(x) bls_m2<span class="fl">.1</span>[, <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">4</span>), x])))</span>
<span id="cb500-3"><a href="brms-2.html#cb500-3" aria-hidden="true"></a><span class="kw">colnames</span>(bl_m2<span class="fl">.1</span>) &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">rep</span>(<span class="kw">dimnames</span>(bls_m2<span class="fl">.1</span>)[[<span class="dv">3</span>]], <span class="dt">each =</span> <span class="dv">3</span>), <span class="kw">c</span>(<span class="st">&quot;&quot;</span>, <span class="st">&quot;_lo&quot;</span>, <span class="st">&quot;_up&quot;</span>))</span>
<span id="cb500-4"><a href="brms-2.html#cb500-4" aria-hidden="true"></a>bl_m2<span class="fl">.1</span><span class="op">$</span>id &lt;-<span class="st"> </span><span class="kw">rownames</span>(bl_m2<span class="fl">.1</span>)</span></code></pre></div>
<p>Here, some simple code to plot the genetic correlation.</p>
<div class="sourceCode" id="cb501"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb501-1"><a href="brms-2.html#cb501-1" aria-hidden="true"></a><span class="kw">plot</span>(tarsus_Intercept <span class="op">~</span><span class="st"> </span>bwt_Intercept, bl_m2<span class="fl">.1</span>,</span>
<span id="cb501-2"><a href="brms-2.html#cb501-2" aria-hidden="true"></a>  <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb501-3"><a href="brms-2.html#cb501-3" aria-hidden="true"></a>  <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="kw">min</span>(bl_m2<span class="fl">.1</span><span class="op">$</span>bwt_Intercept_lo), <span class="kw">max</span>(bl_m2<span class="fl">.1</span><span class="op">$</span>bwt_Intercept_up)),</span>
<span id="cb501-4"><a href="brms-2.html#cb501-4" aria-hidden="true"></a>  <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="kw">min</span>(bl_m2<span class="fl">.1</span><span class="op">$</span>tarsus_Intercept_lo), <span class="kw">max</span>(bl_m2<span class="fl">.1</span><span class="op">$</span>tarsus_Intercept_up)),</span>
<span id="cb501-5"><a href="brms-2.html#cb501-5" aria-hidden="true"></a>  <span class="dt">las =</span> <span class="fl">1.2</span>, <span class="dt">type =</span> <span class="st">&quot;n&quot;</span></span>
<span id="cb501-6"><a href="brms-2.html#cb501-6" aria-hidden="true"></a>)</span>
<span id="cb501-7"><a href="brms-2.html#cb501-7" aria-hidden="true"></a><span class="kw">with</span>(</span>
<span id="cb501-8"><a href="brms-2.html#cb501-8" aria-hidden="true"></a>  bl_m2<span class="fl">.1</span>,</span>
<span id="cb501-9"><a href="brms-2.html#cb501-9" aria-hidden="true"></a>  <span class="kw">segments</span>(</span>
<span id="cb501-10"><a href="brms-2.html#cb501-10" aria-hidden="true"></a>    <span class="dt">x0 =</span> bwt_Intercept, <span class="dt">y0 =</span> tarsus_Intercept_lo,</span>
<span id="cb501-11"><a href="brms-2.html#cb501-11" aria-hidden="true"></a>    <span class="dt">x1 =</span> bwt_Intercept, <span class="dt">y1 =</span> tarsus_Intercept_up,</span>
<span id="cb501-12"><a href="brms-2.html#cb501-12" aria-hidden="true"></a>    <span class="dt">col =</span> <span class="st">&quot;black&quot;</span></span>
<span id="cb501-13"><a href="brms-2.html#cb501-13" aria-hidden="true"></a>  )</span>
<span id="cb501-14"><a href="brms-2.html#cb501-14" aria-hidden="true"></a>)</span>
<span id="cb501-15"><a href="brms-2.html#cb501-15" aria-hidden="true"></a><span class="kw">with</span>(bl_m2<span class="fl">.1</span>, <span class="kw">segments</span>(</span>
<span id="cb501-16"><a href="brms-2.html#cb501-16" aria-hidden="true"></a>  <span class="dt">x0 =</span> bwt_Intercept_lo, <span class="dt">y0 =</span> tarsus_Intercept,</span>
<span id="cb501-17"><a href="brms-2.html#cb501-17" aria-hidden="true"></a>  <span class="dt">x1 =</span> bwt_Intercept_up, <span class="dt">y1 =</span> tarsus_Intercept,</span>
<span id="cb501-18"><a href="brms-2.html#cb501-18" aria-hidden="true"></a>  <span class="dt">col =</span> <span class="st">&quot;black&quot;</span></span>
<span id="cb501-19"><a href="brms-2.html#cb501-19" aria-hidden="true"></a>))</span>
<span id="cb501-20"><a href="brms-2.html#cb501-20" aria-hidden="true"></a><span class="kw">points</span>(tarsus_Intercept <span class="op">~</span><span class="st"> </span>bwt_Intercept, bl_m2<span class="fl">.1</span>, <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">cex =</span> <span class="fl">1.5</span>)</span>
<span id="cb501-21"><a href="brms-2.html#cb501-21" aria-hidden="true"></a><span class="kw">points</span>(tarsus_Intercept <span class="op">~</span><span class="st"> </span>bwt_Intercept, bl_m2<span class="fl">.1</span>, <span class="dt">pch =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="kw">rgb</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.3</span>), <span class="dt">cex =</span> <span class="kw">c</span>(<span class="fl">1.5</span>))</span>
<span id="cb501-22"><a href="brms-2.html#cb501-22" aria-hidden="true"></a><span class="kw">mtext</span>(<span class="st">&quot;btw (BV±CI)&quot;</span>, <span class="dt">side =</span> <span class="dv">1</span>, <span class="dt">line =</span> <span class="fl">2.4</span>)</span>
<span id="cb501-23"><a href="brms-2.html#cb501-23" aria-hidden="true"></a><span class="kw">mtext</span>(<span class="st">&quot;tarsus (BV±CI)&quot;</span>, <span class="dt">side =</span> <span class="dv">2</span>, <span class="dt">line =</span> <span class="dv">2</span>, <span class="dt">las =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="wam_tuto_files/figure-html/unnamed-chunk-149-1.svg" width="672" /></p>
<!--
Here the code to plot the resiudal correlation.
#```{r}
res.model <- as.data.frame(residuals(brms_m2.1))

plot(Estimate.tarsus ~ Estimate.bwt, res.model, xlab = "", ylab = "", las = 1.2, bty = "o", col = "white")
segments(x0 = res.model$Estimate.bwt, y0 = res.model$Q2.5.tarsus, x1 = res.model$Estimate.bwt, y1 = res.model$Q97.5.tarsus, col = "black")
segments(x0 = res.model$Q2.5.bwt, y0 = res.model$Estimate.tarsus, x1 = res.model$Q97.5.bwt, y1 = res.model$Estimate.tarsus, col = "black")
points(Estimate.tarsus ~ Estimate.bwt, res.model, pch = 16, col = "red", cex = 1.5)
points(Estimate.tarsus ~ Estimate.bwt, res.model, pch = 1, col = rgb(0, 0, 0, 0.3), cex = c(1.5))
mtext("btw (residual±CI)", side = 1, line = 2.4)
mtext("tarsus (residual±CI)", side = 2, line = 2, las = 3)
#```
-->
</div>
<div id="adding-fixed-and-random-effects-2" class="section level3 hasAnchor" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Adding fixed and random effects<a href="brms-2.html#adding-fixed-and-random-effects-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Fixed and random effects can be added just as for the univariate case.
Given that our full model of bwt from tutorial 1 had sex as a fixed effect as well as random effects of byear and mother, we could specify a bivariate formulation of this using the following code (including a line to save the output):</p>
<div class="sourceCode" id="cb502"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb502-1"><a href="brms-2.html#cb502-1" aria-hidden="true"></a>bf_bwt_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">bf</span>(bwt <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>sex <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>a <span class="op">|</span><span class="st"> </span><span class="kw">gr</span>(animal, <span class="dt">cov =</span> Amat)) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>b <span class="op">|</span><span class="st"> </span>byear) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>c <span class="op">|</span><span class="st"> </span>mother))</span>
<span id="cb502-2"><a href="brms-2.html#cb502-2" aria-hidden="true"></a>bf_tarsus_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">bf</span>(tarsus <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>sex <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>a <span class="op">|</span><span class="st"> </span><span class="kw">gr</span>(animal, <span class="dt">cov =</span> Amat)) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>b <span class="op">|</span><span class="st"> </span>byear) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>c <span class="op">|</span><span class="st"> </span>mother))</span>
<span id="cb502-3"><a href="brms-2.html#cb502-3" aria-hidden="true"></a></span>
<span id="cb502-4"><a href="brms-2.html#cb502-4" aria-hidden="true"></a>brms_m2<span class="fl">.2</span> &lt;-<span class="st"> </span><span class="kw">brm</span>(</span>
<span id="cb502-5"><a href="brms-2.html#cb502-5" aria-hidden="true"></a>  bf_bwt_<span class="dv">2</span> <span class="op">+</span><span class="st"> </span>bf_tarsus_<span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="kw">set_rescor</span>(<span class="ot">TRUE</span>),</span>
<span id="cb502-6"><a href="brms-2.html#cb502-6" aria-hidden="true"></a>  <span class="dt">data =</span> gryphon,</span>
<span id="cb502-7"><a href="brms-2.html#cb502-7" aria-hidden="true"></a>  <span class="dt">data2 =</span> <span class="kw">list</span>(<span class="dt">Amat =</span> Amat),</span>
<span id="cb502-8"><a href="brms-2.html#cb502-8" aria-hidden="true"></a>  <span class="dt">chains =</span> <span class="dv">2</span>, <span class="dt">cores =</span> <span class="dv">2</span>, <span class="dt">iter =</span> <span class="dv">1000</span></span>
<span id="cb502-9"><a href="brms-2.html#cb502-9" aria-hidden="true"></a>)</span>
<span id="cb502-10"><a href="brms-2.html#cb502-10" aria-hidden="true"></a></span>
<span id="cb502-11"><a href="brms-2.html#cb502-11" aria-hidden="true"></a><span class="kw">save</span>(brms_m2<span class="fl">.2</span>, <span class="dt">file =</span> <span class="st">&quot;data/brms_m2_2.rda&quot;</span>)</span></code></pre></div>
<p>Again we have provided the data from one such run. It can be accessed using the code:</p>
<div class="sourceCode" id="cb503"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb503-1"><a href="brms-2.html#cb503-1" aria-hidden="true"></a><span class="kw">load</span>(<span class="st">&quot;data/brms_m2_2.rda&quot;</span>)</span>
<span id="cb503-2"><a href="brms-2.html#cb503-2" aria-hidden="true"></a><span class="kw">summary</span>(brms_m2<span class="fl">.2</span>)</span></code></pre></div>
<pre><code>## Warning: Parts of the model have not converged (some Rhats are &gt; 1.05). Be
## careful when analysing the results! We recommend running more iterations and/or
## setting stronger priors.</code></pre>
<pre><code>## Warning: There were 4 divergent transitions after warmup. Increasing adapt_delta
## above 0.8 may help. See http://mc-stan.org/misc/warnings.html#divergent-
## transitions-after-warmup</code></pre>
<pre><code>##  Family: MV(gaussian, gaussian) 
##   Links: mu = identity; sigma = identity
##          mu = identity; sigma = identity 
## Formula: bwt ~ 1 + sex + (1 | a | gr(animal, cov = Amat)) + (1 | b | byear) + (1 | c | mother) 
##          tarsus ~ 1 + sex + (1 | a | gr(animal, cov = Amat)) + (1 | b | byear) + (1 | c | mother) 
##    Data: gryphon (Number of observations: 683) 
##   Draws: 2 chains, each with iter = 1000; warmup = 500; thin = 1;
##          total post-warmup draws = 1000
## 
## Group-Level Effects: 
## ~animal (Number of levels: 683) 
##                                     Estimate Est.Error l-95% CI u-95% CI Rhat
## sd(bwt_Intercept)                       1.31      0.21     0.86     1.69 1.06
## sd(tarsus_Intercept)                    2.88      0.47     1.88     3.70 1.01
## cor(bwt_Intercept,tarsus_Intercept)     0.60      0.17     0.18     0.89 1.09
##                                     Bulk_ESS Tail_ESS
## sd(bwt_Intercept)                         54       58
## sd(tarsus_Intercept)                      52      162
## cor(bwt_Intercept,tarsus_Intercept)       25       30
## 
## ~byear (Number of levels: 34) 
##                                     Estimate Est.Error l-95% CI u-95% CI Rhat
## sd(bwt_Intercept)                       0.99      0.17     0.71     1.39 1.00
## sd(tarsus_Intercept)                    2.02      0.34     1.45     2.78 1.00
## cor(bwt_Intercept,tarsus_Intercept)     0.01      0.22    -0.44     0.44 1.01
##                                     Bulk_ESS Tail_ESS
## sd(bwt_Intercept)                        424      509
## sd(tarsus_Intercept)                     525      699
## cor(bwt_Intercept,tarsus_Intercept)      478      492
## 
## ~mother (Number of levels: 352) 
##                                     Estimate Est.Error l-95% CI u-95% CI Rhat
## sd(bwt_Intercept)                       1.14      0.12     0.90     1.36 1.01
## sd(tarsus_Intercept)                    2.09      0.29     1.54     2.67 1.01
## cor(bwt_Intercept,tarsus_Intercept)    -0.64      0.20    -0.97    -0.24 1.02
##                                     Bulk_ESS Tail_ESS
## sd(bwt_Intercept)                        370      764
## sd(tarsus_Intercept)                     134      420
## cor(bwt_Intercept,tarsus_Intercept)       84      147
## 
## Population-Level Effects: 
##                  Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## bwt_Intercept        6.28      0.24     5.80     6.73 1.00      453      703
## tarsus_Intercept    20.39      0.52    19.45    21.39 1.00      755      760
## bwt_sex2             2.05      0.17     1.71     2.37 1.00     1097      715
## tarsus_sex2          0.11      0.42    -0.67     0.90 1.00      780      578
## 
## Family Specific Parameters: 
##              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma_bwt        1.40      0.16     1.05     1.68 1.04       59       60
## sigma_tarsus     3.73      0.32     3.14     4.32 1.00       55      176
## 
## Residual Correlations: 
##                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## rescor(bwt,tarsus)     0.89      0.07     0.72     0.98 1.50        4       24
## 
## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<div class="sourceCode" id="cb507"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb507-1"><a href="brms-2.html#cb507-1" aria-hidden="true"></a><span class="kw">plot</span>(brms_m2<span class="fl">.2</span>, <span class="dt">ask =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p><img src="wam_tuto_files/figure-html/unnamed-chunk-151-1.svg" width="672" /><img src="wam_tuto_files/figure-html/unnamed-chunk-151-2.svg" width="672" /><img src="wam_tuto_files/figure-html/unnamed-chunk-151-3.svg" width="672" /><img src="wam_tuto_files/figure-html/unnamed-chunk-151-4.svg" width="672" /></p>
<div class="sourceCode" id="cb508"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb508-1"><a href="brms-2.html#cb508-1" aria-hidden="true"></a><span class="kw">VarCorr</span>(brms_m2<span class="fl">.2</span>)</span></code></pre></div>
<pre><code>## $animal
## $animal$sd
##                  Estimate Est.Error      Q2.5    Q97.5
## bwt_Intercept    1.306921 0.2109780 0.8555702 1.687254
## tarsus_Intercept 2.876731 0.4718524 1.8827128 3.699873
## 
## $animal$cor
## , , bwt_Intercept
## 
##                   Estimate Est.Error      Q2.5     Q97.5
## bwt_Intercept    1.0000000 0.0000000 1.0000000 1.0000000
## tarsus_Intercept 0.5961514 0.1727943 0.1849725 0.8929607
## 
## , , tarsus_Intercept
## 
##                   Estimate Est.Error      Q2.5     Q97.5
## bwt_Intercept    0.5961514 0.1727943 0.1849725 0.8929607
## tarsus_Intercept 1.0000000 0.0000000 1.0000000 1.0000000
## 
## 
## $animal$cov
## , , bwt_Intercept
## 
##                  Estimate Est.Error      Q2.5    Q97.5
## bwt_Intercept    1.752510 0.5433004 0.7320013 2.846827
## tarsus_Intercept 2.357852 1.0462644 0.3960956 4.526731
## 
## , , tarsus_Intercept
## 
##                  Estimate Est.Error      Q2.5     Q97.5
## bwt_Intercept    2.357852  1.046264 0.3960956  4.526731
## tarsus_Intercept 8.498003  2.672465 3.5446115 13.689062
## 
## 
## 
## $byear
## $byear$sd
##                   Estimate Est.Error      Q2.5    Q97.5
## bwt_Intercept    0.9904858 0.1696752 0.7102391 1.390260
## tarsus_Intercept 2.0166804 0.3366954 1.4463862 2.777005
## 
## $byear$cor
## , , bwt_Intercept
## 
##                    Estimate Est.Error       Q2.5     Q97.5
## bwt_Intercept    1.00000000 0.0000000  1.0000000 1.0000000
## tarsus_Intercept 0.01351405 0.2206186 -0.4367809 0.4412319
## 
## , , tarsus_Intercept
## 
##                    Estimate Est.Error       Q2.5     Q97.5
## bwt_Intercept    0.01351405 0.2206186 -0.4367809 0.4412319
## tarsus_Intercept 1.00000000 0.0000000  1.0000000 1.0000000
## 
## 
## $byear$cov
## , , bwt_Intercept
## 
##                    Estimate Est.Error       Q2.5    Q97.5
## bwt_Intercept    1.00982294 0.3583697  0.5044397 1.932823
## tarsus_Intercept 0.06412895 0.4880116 -0.8559486 1.092317
## 
## , , tarsus_Intercept
## 
##                    Estimate Est.Error       Q2.5    Q97.5
## bwt_Intercept    0.06412895 0.4880116 -0.8559486 1.092317
## tarsus_Intercept 4.18025049 1.4249595  2.0920330 7.711755
## 
## 
## 
## $mother
## $mother$sd
##                  Estimate Est.Error      Q2.5    Q97.5
## bwt_Intercept    1.137249 0.1175495 0.8968349 1.358078
## tarsus_Intercept 2.088602 0.2865291 1.5425683 2.673791
## 
## $mother$cor
## , , bwt_Intercept
## 
##                    Estimate Est.Error       Q2.5      Q97.5
## bwt_Intercept     1.0000000 0.0000000  1.0000000  1.0000000
## tarsus_Intercept -0.6413329 0.1968102 -0.9745925 -0.2367393
## 
## , , tarsus_Intercept
## 
##                    Estimate Est.Error       Q2.5      Q97.5
## bwt_Intercept    -0.6413329 0.1968102 -0.9745925 -0.2367393
## tarsus_Intercept  1.0000000 0.0000000  1.0000000  1.0000000
## 
## 
## $mother$cov
## , , bwt_Intercept
## 
##                   Estimate Est.Error       Q2.5      Q97.5
## bwt_Intercept     1.307139 0.2669748  0.8043132  1.8443762
## tarsus_Intercept -1.467511 0.3650113 -2.1491979 -0.6718737
## 
## , , tarsus_Intercept
## 
##                   Estimate Est.Error      Q2.5      Q97.5
## bwt_Intercept    -1.467511 0.3650113 -2.149198 -0.6718737
## tarsus_Intercept  4.444274 1.2018090  2.379517  7.1491575
## 
## 
## 
## $residual__
## $residual__$sd
##        Estimate Est.Error     Q2.5    Q97.5
## bwt    1.396815 0.1597393 1.052042 1.684810
## tarsus 3.733614 0.3170549 3.140204 4.319446
## 
## $residual__$cor
## , , bwt
## 
##         Estimate Est.Error      Q2.5     Q97.5
## bwt    1.0000000 0.0000000 1.0000000 1.0000000
## tarsus 0.8925119 0.0672286 0.7167862 0.9774545
## 
## , , tarsus
## 
##         Estimate Est.Error      Q2.5     Q97.5
## bwt    0.8925119 0.0672286 0.7167862 0.9774545
## tarsus 1.0000000 0.0000000 1.0000000 1.0000000
## 
## 
## $residual__$cov
## , , bwt
## 
##        Estimate Est.Error     Q2.5    Q97.5
## bwt    1.976584 0.4347085 1.106793 2.838585
## tarsus 4.683451 0.9103808 2.846560 6.440550
## 
## , , tarsus
## 
##         Estimate Est.Error     Q2.5    Q97.5
## bwt     4.683451 0.9103808 2.846560  6.44055
## tarsus 14.040300 2.3674563 9.860883 18.65761</code></pre>
<p>Evaluation of the statistical support for these genetic and maternal correlations is straightforward. Because we imposed no constraint on their estimation, we can evaluate the extent to which the posterior distributions overlap zero:</p>
<div class="sourceCode" id="cb510"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb510-1"><a href="brms-2.html#cb510-1" aria-hidden="true"></a>cor_g &lt;-<span class="st"> </span><span class="kw">as.mcmc</span>((<span class="kw">VarCorr</span>(brms_m2<span class="fl">.2</span>, <span class="dt">summary =</span> <span class="ot">FALSE</span>)<span class="op">$</span>animal<span class="op">$</span>cor[, <span class="dv">1</span>, <span class="dv">2</span>]))</span>
<span id="cb510-2"><a href="brms-2.html#cb510-2" aria-hidden="true"></a>cor_res &lt;-<span class="st"> </span><span class="kw">as.mcmc</span>((<span class="kw">VarCorr</span>(brms_m2<span class="fl">.2</span>, <span class="dt">summary =</span> <span class="ot">FALSE</span>)<span class="op">$</span>residual<span class="op">$</span>cor[, <span class="dv">1</span>, <span class="dv">2</span>]))</span>
<span id="cb510-3"><a href="brms-2.html#cb510-3" aria-hidden="true"></a>cor_mother &lt;-<span class="st"> </span><span class="kw">as.mcmc</span>((<span class="kw">VarCorr</span>(brms_m2<span class="fl">.2</span>, <span class="dt">summary =</span> <span class="ot">FALSE</span>)<span class="op">$</span>mother<span class="op">$</span>cor[, <span class="dv">1</span>, <span class="dv">2</span>]))</span>
<span id="cb510-4"><a href="brms-2.html#cb510-4" aria-hidden="true"></a>cor_byear &lt;-<span class="st"> </span><span class="kw">as.mcmc</span>((<span class="kw">VarCorr</span>(brms_m2<span class="fl">.2</span>, <span class="dt">summary =</span> <span class="ot">FALSE</span>)<span class="op">$</span>byear<span class="op">$</span>cor[, <span class="dv">1</span>, <span class="dv">2</span>]))</span>
<span id="cb510-5"><a href="brms-2.html#cb510-5" aria-hidden="true"></a></span>
<span id="cb510-6"><a href="brms-2.html#cb510-6" aria-hidden="true"></a><span class="kw">summary</span>(cor_g)</span></code></pre></div>
<pre><code>## 
## Iterations = 1:1000
## Thinning interval = 1 
## Number of chains = 1 
## Sample size per chain = 1000 
## 
## 1. Empirical mean and standard deviation for each variable,
##    plus standard error of the mean:
## 
##           Mean             SD       Naive SE Time-series SE 
##       0.596151       0.172794       0.005464       0.028178 
## 
## 2. Quantiles for each variable:
## 
##   2.5%    25%    50%    75%  97.5% 
## 0.1850 0.5065 0.6117 0.7064 0.8930</code></pre>
<div class="sourceCode" id="cb512"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb512-1"><a href="brms-2.html#cb512-1" aria-hidden="true"></a><span class="kw">summary</span>(cor_mother)</span></code></pre></div>
<pre><code>## 
## Iterations = 1:1000
## Thinning interval = 1 
## Number of chains = 1 
## Sample size per chain = 1000 
## 
## 1. Empirical mean and standard deviation for each variable,
##    plus standard error of the mean:
## 
##           Mean             SD       Naive SE Time-series SE 
##      -0.641333       0.196810       0.006224       0.021355 
## 
## 2. Quantiles for each variable:
## 
##    2.5%     25%     50%     75%   97.5% 
## -0.9746 -0.7933 -0.6507 -0.5027 -0.2367</code></pre>
<div class="sourceCode" id="cb514"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb514-1"><a href="brms-2.html#cb514-1" aria-hidden="true"></a><span class="kw">summary</span>(cor_byear)</span></code></pre></div>
<pre><code>## 
## Iterations = 1:1000
## Thinning interval = 1 
## Number of chains = 1 
## Sample size per chain = 1000 
## 
## 1. Empirical mean and standard deviation for each variable,
##    plus standard error of the mean:
## 
##           Mean             SD       Naive SE Time-series SE 
##       0.013514       0.220619       0.006977       0.009633 
## 
## 2. Quantiles for each variable:
## 
##     2.5%      25%      50%      75%    97.5% 
## -0.43678 -0.13505  0.02408  0.16947  0.44123</code></pre>
<div class="sourceCode" id="cb516"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb516-1"><a href="brms-2.html#cb516-1" aria-hidden="true"></a><span class="kw">summary</span>(cor_res)</span></code></pre></div>
<pre><code>## 
## Iterations = 1:1000
## Thinning interval = 1 
## Number of chains = 1 
## Sample size per chain = 1000 
## 
## 1. Empirical mean and standard deviation for each variable,
##    plus standard error of the mean:
## 
##           Mean             SD       Naive SE Time-series SE 
##       0.892512       0.067229       0.002126       0.026496 
## 
## 2. Quantiles for each variable:
## 
##   2.5%    25%    50%    75%  97.5% 
## 0.7168 0.8620 0.9069 0.9425 0.9775</code></pre>
<div class="sourceCode" id="cb518"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb518-1"><a href="brms-2.html#cb518-1" aria-hidden="true"></a><span class="kw">plot</span>(cor_g)</span></code></pre></div>
<p><img src="wam_tuto_files/figure-html/unnamed-chunk-152-1.svg" width="672" /></p>
<div class="sourceCode" id="cb519"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb519-1"><a href="brms-2.html#cb519-1" aria-hidden="true"></a><span class="kw">plot</span>(cor_res)</span></code></pre></div>
<p><img src="wam_tuto_files/figure-html/unnamed-chunk-152-2.svg" width="672" /></p>
<div class="sourceCode" id="cb520"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb520-1"><a href="brms-2.html#cb520-1" aria-hidden="true"></a><span class="kw">plot</span>(cor_mother)</span></code></pre></div>
<p><img src="wam_tuto_files/figure-html/unnamed-chunk-152-3.svg" width="672" /></p>
<div class="sourceCode" id="cb521"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb521-1"><a href="brms-2.html#cb521-1" aria-hidden="true"></a><span class="kw">plot</span>(cor_byear)</span></code></pre></div>
<p><img src="wam_tuto_files/figure-html/unnamed-chunk-152-4.svg" width="672" /></p>
<p>Neither or these posterior distributions overlaps zero, so we can consider them both statistically supported.</p>
<div class="sourceCode" id="cb522"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb522-1"><a href="brms-2.html#cb522-1" aria-hidden="true"></a>cor.est &lt;-<span class="st"> </span><span class="kw">rbind</span>(</span>
<span id="cb522-2"><a href="brms-2.html#cb522-2" aria-hidden="true"></a>  <span class="kw">cbind</span>(<span class="kw">summary</span>(cor_g)<span class="op">$</span>statistics[<span class="dv">1</span>], <span class="kw">summary</span>(cor_g)<span class="op">$</span>quantiles[<span class="dv">1</span>], <span class="kw">summary</span>(cor_g)<span class="op">$</span>quantiles[<span class="dv">5</span>]),</span>
<span id="cb522-3"><a href="brms-2.html#cb522-3" aria-hidden="true"></a>  <span class="kw">cbind</span>(<span class="kw">summary</span>(cor_mother)<span class="op">$</span>statistics[<span class="dv">1</span>], <span class="kw">summary</span>(cor_mother)<span class="op">$</span>quantiles[<span class="dv">1</span>], <span class="kw">summary</span>(cor_mother)<span class="op">$</span>quantiles[<span class="dv">5</span>]),</span>
<span id="cb522-4"><a href="brms-2.html#cb522-4" aria-hidden="true"></a>  <span class="kw">cbind</span>(<span class="kw">summary</span>(cor_byear)<span class="op">$</span>statistics[<span class="dv">1</span>], <span class="kw">summary</span>(cor_byear)<span class="op">$</span>quantiles[<span class="dv">1</span>], <span class="kw">summary</span>(cor_byear)<span class="op">$</span>quantiles[<span class="dv">5</span>]),</span>
<span id="cb522-5"><a href="brms-2.html#cb522-5" aria-hidden="true"></a>  <span class="kw">cbind</span>(<span class="kw">summary</span>(cor_res)<span class="op">$</span>statistics[<span class="dv">1</span>], <span class="kw">summary</span>(cor_res)<span class="op">$</span>quantiles[<span class="dv">1</span>], <span class="kw">summary</span>(cor_res)<span class="op">$</span>quantiles[<span class="dv">5</span>])</span>
<span id="cb522-6"><a href="brms-2.html#cb522-6" aria-hidden="true"></a>)</span>
<span id="cb522-7"><a href="brms-2.html#cb522-7" aria-hidden="true"></a></span>
<span id="cb522-8"><a href="brms-2.html#cb522-8" aria-hidden="true"></a></span>
<span id="cb522-9"><a href="brms-2.html#cb522-9" aria-hidden="true"></a><span class="kw">plot</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>) <span class="op">~</span><span class="st"> </span>cor.est[, <span class="dv">1</span>], <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">5</span>), <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">cex =</span> <span class="dv">2</span>, <span class="dt">yaxt =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb522-10"><a href="brms-2.html#cb522-10" aria-hidden="true"></a><span class="kw">segments</span>(<span class="dt">y0 =</span> <span class="dv">1</span>, <span class="dt">x0 =</span> cor.est[<span class="dv">1</span>, <span class="dv">1</span>] <span class="op">-</span><span class="st"> </span>cor.est[<span class="dv">1</span>, <span class="dv">2</span>], <span class="dt">y1 =</span> <span class="dv">1</span>, <span class="dt">x1 =</span> cor.est[<span class="dv">1</span>, <span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>cor.est[<span class="dv">1</span>, <span class="dv">2</span>], <span class="dt">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb522-11"><a href="brms-2.html#cb522-11" aria-hidden="true"></a><span class="kw">segments</span>(<span class="dt">y0 =</span> <span class="dv">2</span>, <span class="dt">x0 =</span> cor.est[<span class="dv">2</span>, <span class="dv">1</span>] <span class="op">-</span><span class="st"> </span>cor.est[<span class="dv">2</span>, <span class="dv">2</span>], <span class="dt">y1 =</span> <span class="dv">2</span>, <span class="dt">x1 =</span> cor.est[<span class="dv">2</span>, <span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>cor.est[<span class="dv">2</span>, <span class="dv">2</span>], <span class="dt">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb522-12"><a href="brms-2.html#cb522-12" aria-hidden="true"></a><span class="kw">segments</span>(<span class="dt">y0 =</span> <span class="dv">3</span>, <span class="dt">x0 =</span> cor.est[<span class="dv">3</span>, <span class="dv">1</span>] <span class="op">-</span><span class="st"> </span>cor.est[<span class="dv">3</span>, <span class="dv">2</span>], <span class="dt">y1 =</span> <span class="dv">3</span>, <span class="dt">x1 =</span> cor.est[<span class="dv">3</span>, <span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>cor.est[<span class="dv">3</span>, <span class="dv">2</span>], <span class="dt">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb522-13"><a href="brms-2.html#cb522-13" aria-hidden="true"></a><span class="kw">segments</span>(<span class="dt">y0 =</span> <span class="dv">4</span>, <span class="dt">x0 =</span> cor.est[<span class="dv">4</span>, <span class="dv">1</span>] <span class="op">-</span><span class="st"> </span>cor.est[<span class="dv">4</span>, <span class="dv">2</span>], <span class="dt">y1 =</span> <span class="dv">4</span>, <span class="dt">x1 =</span> cor.est[<span class="dv">4</span>, <span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>cor.est[<span class="dv">4</span>, <span class="dv">2</span>], <span class="dt">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb522-14"><a href="brms-2.html#cb522-14" aria-hidden="true"></a><span class="kw">mtext</span>(<span class="st">&quot;Correlation (±CI)&quot;</span>, <span class="dt">side =</span> <span class="dv">1</span>, <span class="dt">las =</span> <span class="dv">1</span>, <span class="dt">adj =</span> <span class="fl">0.4</span>, <span class="dt">line =</span> <span class="dv">3</span>, <span class="dt">cex =</span> <span class="fl">1.6</span>)</span>
<span id="cb522-15"><a href="brms-2.html#cb522-15" aria-hidden="true"></a><span class="kw">axis</span>(<span class="dv">2</span>, <span class="dt">at =</span> <span class="dv">1</span>, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;genetic&quot;</span>), <span class="dt">las =</span> <span class="dv">2</span>, <span class="dt">cex.axis =</span> <span class="dv">1</span>)</span>
<span id="cb522-16"><a href="brms-2.html#cb522-16" aria-hidden="true"></a><span class="kw">axis</span>(<span class="dv">2</span>, <span class="dt">at =</span> <span class="dv">2</span>, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;mother&quot;</span>), <span class="dt">las =</span> <span class="dv">2</span>, <span class="dt">cex.axis =</span> <span class="dv">1</span>)</span>
<span id="cb522-17"><a href="brms-2.html#cb522-17" aria-hidden="true"></a><span class="kw">axis</span>(<span class="dv">2</span>, <span class="dt">at =</span> <span class="dv">3</span>, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;year&quot;</span>), <span class="dt">las =</span> <span class="dv">2</span>, <span class="dt">cex.axis =</span> <span class="dv">1</span>)</span>
<span id="cb522-18"><a href="brms-2.html#cb522-18" aria-hidden="true"></a><span class="kw">axis</span>(<span class="dv">2</span>, <span class="dt">at =</span> <span class="dv">4</span>, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;residual&quot;</span>), <span class="dt">las =</span> <span class="dv">2</span>, <span class="dt">cex.axis =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="wam_tuto_files/figure-html/unnamed-chunk-153-1.svg" width="672" /></p>
<p>Note, brms estimates the correlation and also the covariance. We can also recalculate the correlation directly from the covariance.To facilitate the extraction of the different parameter, we can the fucntion <code>as_draws_df</code></p>
<div class="sourceCode" id="cb523"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb523-1"><a href="brms-2.html#cb523-1" aria-hidden="true"></a>cov_g &lt;-<span class="st"> </span>(<span class="kw">VarCorr</span>(brms_m2<span class="fl">.2</span>, <span class="dt">summary =</span> <span class="ot">FALSE</span>)<span class="op">$</span>animal<span class="op">$</span>cov)[, <span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb523-2"><a href="brms-2.html#cb523-2" aria-hidden="true"></a>cov_res &lt;-<span class="st"> </span>(<span class="kw">VarCorr</span>(brms_m2<span class="fl">.2</span>, <span class="dt">summary =</span> <span class="ot">FALSE</span>)<span class="op">$</span>residual<span class="op">$</span>cov)[, <span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb523-3"><a href="brms-2.html#cb523-3" aria-hidden="true"></a>cov_mother &lt;-<span class="st"> </span>(<span class="kw">VarCorr</span>(brms_m2<span class="fl">.2</span>, <span class="dt">summary =</span> <span class="ot">FALSE</span>)<span class="op">$</span>mother<span class="op">$</span>cov)[, <span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb523-4"><a href="brms-2.html#cb523-4" aria-hidden="true"></a>cov_byear &lt;-<span class="st"> </span>(<span class="kw">VarCorr</span>(brms_m2<span class="fl">.2</span>, <span class="dt">summary =</span> <span class="ot">FALSE</span>)<span class="op">$</span>byear<span class="op">$</span>cov)[, <span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb523-5"><a href="brms-2.html#cb523-5" aria-hidden="true"></a></span>
<span id="cb523-6"><a href="brms-2.html#cb523-6" aria-hidden="true"></a>var.est &lt;-<span class="st"> </span><span class="kw">as_draws_df</span>(brms_m2<span class="fl">.2</span>, <span class="dt">variable =</span> <span class="kw">c</span>(<span class="st">&quot;sd&quot;</span>, <span class="st">&quot;sigma&quot;</span>), <span class="dt">regex =</span> <span class="ot">TRUE</span>)</span>
<span id="cb523-7"><a href="brms-2.html#cb523-7" aria-hidden="true"></a>var.est &lt;-<span class="st"> </span>var.est<span class="op">^</span><span class="dv">2</span></span>
<span id="cb523-8"><a href="brms-2.html#cb523-8" aria-hidden="true"></a></span>
<span id="cb523-9"><a href="brms-2.html#cb523-9" aria-hidden="true"></a>cor_g_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">as.mcmc</span>(cov_g <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(var.est[<span class="dv">1</span>] <span class="op">*</span><span class="st"> </span>var.est[<span class="dv">2</span>]))</span>
<span id="cb523-10"><a href="brms-2.html#cb523-10" aria-hidden="true"></a>cor_byear_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">as.mcmc</span>(cov_byear <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(var.est[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>var.est[<span class="dv">4</span>]))</span>
<span id="cb523-11"><a href="brms-2.html#cb523-11" aria-hidden="true"></a>cor_mother_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">as.mcmc</span>(cov_g <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(var.est[<span class="dv">5</span>] <span class="op">*</span><span class="st"> </span>var.est[<span class="dv">6</span>]))</span>
<span id="cb523-12"><a href="brms-2.html#cb523-12" aria-hidden="true"></a>cor_res_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">as.mcmc</span>(cov_res <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(var.est[<span class="dv">7</span>] <span class="op">*</span><span class="st"> </span>var.est[<span class="dv">8</span>]))</span>
<span id="cb523-13"><a href="brms-2.html#cb523-13" aria-hidden="true"></a></span>
<span id="cb523-14"><a href="brms-2.html#cb523-14" aria-hidden="true"></a><span class="kw">summary</span>(cor_g_<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## 
## Iterations = 1:1000
## Thinning interval = 1 
## Number of chains = 1 
## Sample size per chain = 1000 
## 
## 1. Empirical mean and standard deviation for each variable,
##    plus standard error of the mean:
## 
##           Mean             SD       Naive SE Time-series SE 
##       0.596151       0.172794       0.005464       0.028178 
## 
## 2. Quantiles for each variable:
## 
##   2.5%    25%    50%    75%  97.5% 
## 0.1850 0.5065 0.6117 0.7064 0.8930</code></pre>
<div class="sourceCode" id="cb525"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb525-1"><a href="brms-2.html#cb525-1" aria-hidden="true"></a><span class="kw">summary</span>(cor_byear_<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## 
## Iterations = 1:1000
## Thinning interval = 1 
## Number of chains = 1 
## Sample size per chain = 1000 
## 
## 1. Empirical mean and standard deviation for each variable,
##    plus standard error of the mean:
## 
##           Mean             SD       Naive SE Time-series SE 
##       0.013514       0.220619       0.006977       0.009633 
## 
## 2. Quantiles for each variable:
## 
##     2.5%      25%      50%      75%    97.5% 
## -0.43678 -0.13505  0.02408  0.16947  0.44123</code></pre>
<div class="sourceCode" id="cb527"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb527-1"><a href="brms-2.html#cb527-1" aria-hidden="true"></a><span class="kw">summary</span>(cor_mother_<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## 
## Iterations = 1:1000
## Thinning interval = 1 
## Number of chains = 1 
## Sample size per chain = 1000 
## 
## 1. Empirical mean and standard deviation for each variable,
##    plus standard error of the mean:
## 
##           Mean             SD       Naive SE Time-series SE 
##        1.01862        0.46337        0.01465        0.06126 
## 
## 2. Quantiles for each variable:
## 
##   2.5%    25%    50%    75%  97.5% 
## 0.1514 0.6969 1.0310 1.3241 2.0032</code></pre>
<div class="sourceCode" id="cb529"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb529-1"><a href="brms-2.html#cb529-1" aria-hidden="true"></a><span class="kw">summary</span>(cor_res_<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## 
## Iterations = 1:1000
## Thinning interval = 1 
## Number of chains = 1 
## Sample size per chain = 1000 
## 
## 1. Empirical mean and standard deviation for each variable,
##    plus standard error of the mean:
## 
##           Mean             SD       Naive SE Time-series SE 
##       0.892512       0.067229       0.002126       0.026496 
## 
## 2. Quantiles for each variable:
## 
##   2.5%    25%    50%    75%  97.5% 
## 0.7168 0.8620 0.9069 0.9425 0.9775</code></pre>
<div class="sourceCode" id="cb531"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb531-1"><a href="brms-2.html#cb531-1" aria-hidden="true"></a><span class="kw">plot</span>(cor_g_<span class="dv">2</span>)</span></code></pre></div>
<p><img src="wam_tuto_files/figure-html/unnamed-chunk-154-1.svg" width="672" /></p>
<div class="sourceCode" id="cb532"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb532-1"><a href="brms-2.html#cb532-1" aria-hidden="true"></a><span class="kw">plot</span>(cor_byear_<span class="dv">2</span>)</span></code></pre></div>
<p><img src="wam_tuto_files/figure-html/unnamed-chunk-154-2.svg" width="672" /></p>
<div class="sourceCode" id="cb533"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb533-1"><a href="brms-2.html#cb533-1" aria-hidden="true"></a><span class="kw">plot</span>(cor_mother_<span class="dv">2</span>)</span></code></pre></div>
<p><img src="wam_tuto_files/figure-html/unnamed-chunk-154-3.svg" width="672" /></p>
<div class="sourceCode" id="cb534"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb534-1"><a href="brms-2.html#cb534-1" aria-hidden="true"></a><span class="kw">plot</span>(cor_res_<span class="dv">2</span>)</span></code></pre></div>
<p><img src="wam_tuto_files/figure-html/unnamed-chunk-154-4.svg" width="672" /></p>
</div>
<div id="partitioning-covariances-1" class="section level3 hasAnchor" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Partitioning (co)variances<a href="brms-2.html#partitioning-covariances-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As in the tutorial 1, it is possible to partition the variance-covariance matrix between groups (here sex)</p>
<div class="sourceCode" id="cb535"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb535-1"><a href="brms-2.html#cb535-1" aria-hidden="true"></a>bf_bwt_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw">bf</span>(bwt <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>sex <span class="op">+</span><span class="st"> </span>((<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>a <span class="op">|</span><span class="st"> </span><span class="kw">gr</span>(animal, <span class="dt">cov =</span> Amat, <span class="dt">by =</span> sex))) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>b <span class="op">|</span><span class="st"> </span>byear) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>c <span class="op">|</span><span class="st"> </span>mother))</span>
<span id="cb535-2"><a href="brms-2.html#cb535-2" aria-hidden="true"></a>bf_tarsus_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw">bf</span>(tarsus <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>sex <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>a <span class="op">|</span><span class="st"> </span><span class="kw">gr</span>(animal, <span class="dt">cov =</span> Amat, <span class="dt">by =</span> sex)) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>b <span class="op">|</span><span class="st"> </span>byear) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>c <span class="op">|</span><span class="st"> </span>mother))</span>
<span id="cb535-3"><a href="brms-2.html#cb535-3" aria-hidden="true"></a></span>
<span id="cb535-4"><a href="brms-2.html#cb535-4" aria-hidden="true"></a>brms_m2<span class="fl">.3</span> &lt;-<span class="st"> </span><span class="kw">brm</span>(</span>
<span id="cb535-5"><a href="brms-2.html#cb535-5" aria-hidden="true"></a>  bf_bwt_<span class="dv">3</span> <span class="op">+</span><span class="st"> </span>bf_tarsus_<span class="dv">3</span> <span class="op">+</span><span class="st"> </span><span class="kw">set_rescor</span>(<span class="ot">TRUE</span>),</span>
<span id="cb535-6"><a href="brms-2.html#cb535-6" aria-hidden="true"></a>  <span class="dt">data =</span> gryphon,</span>
<span id="cb535-7"><a href="brms-2.html#cb535-7" aria-hidden="true"></a>  <span class="dt">data2 =</span> <span class="kw">list</span>(<span class="dt">Amat =</span> Amat),</span>
<span id="cb535-8"><a href="brms-2.html#cb535-8" aria-hidden="true"></a>  <span class="dt">chains =</span> <span class="dv">2</span>, <span class="dt">cores =</span> <span class="dv">2</span>, <span class="dt">iter =</span> <span class="dv">1000</span></span>
<span id="cb535-9"><a href="brms-2.html#cb535-9" aria-hidden="true"></a>)</span>
<span id="cb535-10"><a href="brms-2.html#cb535-10" aria-hidden="true"></a></span>
<span id="cb535-11"><a href="brms-2.html#cb535-11" aria-hidden="true"></a><span class="kw">save</span>(brms_m2<span class="fl">.3</span>, <span class="dt">file =</span> <span class="st">&quot;data/brms_m2_3.rda&quot;</span>)</span></code></pre></div>
<p>Again we have provided the data from one such run. It can be accessed using the code:</p>
<div class="sourceCode" id="cb536"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb536-1"><a href="brms-2.html#cb536-1" aria-hidden="true"></a><span class="kw">load</span>(<span class="st">&quot;data/brms_m2_3.rda&quot;</span>)</span>
<span id="cb536-2"><a href="brms-2.html#cb536-2" aria-hidden="true"></a><span class="kw">summary</span>(brms_m2<span class="fl">.3</span>)</span></code></pre></div>
<pre><code>## Warning: Parts of the model have not converged (some Rhats are &gt; 1.05). Be
## careful when analysing the results! We recommend running more iterations and/or
## setting stronger priors.</code></pre>
<pre><code>## Warning: There were 6 divergent transitions after warmup. Increasing adapt_delta
## above 0.8 may help. See http://mc-stan.org/misc/warnings.html#divergent-
## transitions-after-warmup</code></pre>
<pre><code>##  Family: MV(gaussian, gaussian) 
##   Links: mu = identity; sigma = identity
##          mu = identity; sigma = identity 
## Formula: bwt ~ 1 + sex + ((1 | a | gr(animal, cov = Amat, by = sex))) + (1 | b | byear) + (1 | c | mother) 
##          tarsus ~ 1 + sex + (1 | a | gr(animal, cov = Amat, by = sex)) + (1 | b | byear) + (1 | c | mother) 
##    Data: gryphon (Number of observations: 683) 
##   Draws: 2 chains, each with iter = 1000; warmup = 500; thin = 1;
##          total post-warmup draws = 1000
## 
## Group-Level Effects: 
## ~animal (Number of levels: 683) 
##                                               Estimate Est.Error l-95% CI
## sd(bwt_Intercept:sex1)                            1.05      0.28     0.48
## sd(tarsus_Intercept:sex1)                         1.57      0.78     0.14
## sd(bwt_Intercept:sex2)                            1.23      0.24     0.71
## sd(tarsus_Intercept:sex2)                         3.24      0.48     2.17
## cor(bwt_Intercept:sex1,tarsus_Intercept:sex1)     0.32      0.43    -0.78
## cor(bwt_Intercept:sex2,tarsus_Intercept:sex2)     0.70      0.12     0.45
##                                               u-95% CI Rhat Bulk_ESS Tail_ESS
## sd(bwt_Intercept:sex1)                            1.58 1.27        6       39
## sd(tarsus_Intercept:sex1)                         3.03 1.08       24      117
## sd(bwt_Intercept:sex2)                            1.65 1.24        7       46
## sd(tarsus_Intercept:sex2)                         4.13 1.05       37       79
## cor(bwt_Intercept:sex1,tarsus_Intercept:sex1)     0.90 1.07       25      202
## cor(bwt_Intercept:sex2,tarsus_Intercept:sex2)     0.90 1.09       28       44
## 
## ~byear (Number of levels: 34) 
##                                     Estimate Est.Error l-95% CI u-95% CI Rhat
## sd(bwt_Intercept)                       0.97      0.14     0.70     1.26 1.01
## sd(tarsus_Intercept)                    2.03      0.34     1.47     2.80 1.00
## cor(bwt_Intercept,tarsus_Intercept)     0.01      0.21    -0.41     0.41 1.01
##                                     Bulk_ESS Tail_ESS
## sd(bwt_Intercept)                        282      292
## sd(tarsus_Intercept)                     324      361
## cor(bwt_Intercept,tarsus_Intercept)      183      393
## 
## ~mother (Number of levels: 352) 
##                                     Estimate Est.Error l-95% CI u-95% CI Rhat
## sd(bwt_Intercept)                       1.18      0.11     0.96     1.39 1.02
## sd(tarsus_Intercept)                    2.04      0.34     1.33     2.65 1.09
## cor(bwt_Intercept,tarsus_Intercept)    -0.63      0.21    -0.97    -0.23 1.08
##                                     Bulk_ESS Tail_ESS
## sd(bwt_Intercept)                        170      352
## sd(tarsus_Intercept)                      24       60
## cor(bwt_Intercept,tarsus_Intercept)       22      100
## 
## Population-Level Effects: 
##                  Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## bwt_Intercept        6.27      0.22     5.82     6.68 1.00      195      123
## tarsus_Intercept    20.35      0.48    19.35    21.21 1.00      494      578
## bwt_sex2             2.04      0.17     1.71     2.36 1.01      265      384
## tarsus_sex2          0.14      0.39    -0.60     0.88 1.00      691      621
## 
## Family Specific Parameters: 
##              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma_bwt        1.49      0.15     1.16     1.74 1.33        5       81
## sigma_tarsus     3.88      0.27     3.27     4.35 1.04       42       85
## 
## Residual Correlations: 
##                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## rescor(bwt,tarsus)     0.87      0.05     0.78     0.94 1.04       22       94
## 
## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<div class="sourceCode" id="cb540"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb540-1"><a href="brms-2.html#cb540-1" aria-hidden="true"></a><span class="kw">plot</span>(brms_m2<span class="fl">.3</span>, <span class="dt">ask =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p><img src="wam_tuto_files/figure-html/unnamed-chunk-156-1.svg" width="672" /><img src="wam_tuto_files/figure-html/unnamed-chunk-156-2.svg" width="672" /><img src="wam_tuto_files/figure-html/unnamed-chunk-156-3.svg" width="672" /><img src="wam_tuto_files/figure-html/unnamed-chunk-156-4.svg" width="672" /></p>
<div class="sourceCode" id="cb541"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb541-1"><a href="brms-2.html#cb541-1" aria-hidden="true"></a><span class="kw">VarCorr</span>(brms_m2<span class="fl">.3</span>)</span></code></pre></div>
<pre><code>## $animal
## $animal$sd
##                       Estimate Est.Error      Q2.5    Q97.5
## bwt_Intercept:sex1    1.051791 0.2757021 0.4836926 1.575837
## tarsus_Intercept:sex1 1.573820 0.7777373 0.1389929 3.025426
## bwt_Intercept:sex2    1.232722 0.2436415 0.7075357 1.650628
## tarsus_Intercept:sex2 3.237363 0.4773725 2.1667846 4.126560
## 
## $animal$cor
## , , bwt_Intercept:sex1
## 
##                        Estimate Est.Error       Q2.5     Q97.5
## bwt_Intercept:sex1    1.0000000 0.0000000  1.0000000 1.0000000
## tarsus_Intercept:sex1 0.3232502 0.4324034 -0.7811983 0.9007145
## bwt_Intercept:sex2    0.0000000 0.0000000  0.0000000 0.0000000
## tarsus_Intercept:sex2 0.0000000 0.0000000  0.0000000 0.0000000
## 
## , , tarsus_Intercept:sex1
## 
##                        Estimate Est.Error       Q2.5     Q97.5
## bwt_Intercept:sex1    0.3232502 0.4324034 -0.7811983 0.9007145
## tarsus_Intercept:sex1 1.0000000 0.0000000  1.0000000 1.0000000
## bwt_Intercept:sex2    0.0000000 0.0000000  0.0000000 0.0000000
## tarsus_Intercept:sex2 0.0000000 0.0000000  0.0000000 0.0000000
## 
## , , bwt_Intercept:sex2
## 
##                        Estimate Est.Error      Q2.5     Q97.5
## bwt_Intercept:sex1    0.0000000 0.0000000 0.0000000 0.0000000
## tarsus_Intercept:sex1 0.0000000 0.0000000 0.0000000 0.0000000
## bwt_Intercept:sex2    1.0000000 0.0000000 1.0000000 1.0000000
## tarsus_Intercept:sex2 0.6975925 0.1213692 0.4474181 0.9047623
## 
## , , tarsus_Intercept:sex2
## 
##                        Estimate Est.Error      Q2.5     Q97.5
## bwt_Intercept:sex1    0.0000000 0.0000000 0.0000000 0.0000000
## tarsus_Intercept:sex1 0.0000000 0.0000000 0.0000000 0.0000000
## bwt_Intercept:sex2    0.6975925 0.1213692 0.4474181 0.9047623
## tarsus_Intercept:sex2 1.0000000 0.0000000 1.0000000 1.0000000
## 
## 
## $animal$cov
## , , bwt_Intercept:sex1
## 
##                        Estimate Est.Error       Q2.5    Q97.5
## bwt_Intercept:sex1    1.1821990 0.5768155  0.2339592 2.483263
## tarsus_Intercept:sex1 0.7957577 0.9482719 -0.4879668 3.035395
## bwt_Intercept:sex2    0.0000000 0.0000000  0.0000000 0.000000
## tarsus_Intercept:sex2 0.0000000 0.0000000  0.0000000 0.000000
## 
## , , tarsus_Intercept:sex1
## 
##                        Estimate Est.Error        Q2.5    Q97.5
## bwt_Intercept:sex1    0.7957577 0.9482719 -0.48796685 3.035395
## tarsus_Intercept:sex1 3.0811806 2.5183190  0.01931907 9.153208
## bwt_Intercept:sex2    0.0000000 0.0000000  0.00000000 0.000000
## tarsus_Intercept:sex2 0.0000000 0.0000000  0.00000000 0.000000
## 
## , , bwt_Intercept:sex2
## 
##                       Estimate Est.Error      Q2.5    Q97.5
## bwt_Intercept:sex1    0.000000 0.0000000 0.0000000 0.000000
## tarsus_Intercept:sex1 0.000000 0.0000000 0.0000000 0.000000
## bwt_Intercept:sex2    1.578907 0.5865683 0.5006069 2.724572
## tarsus_Intercept:sex2 2.842372 1.0153859 1.1593760 5.086448
## 
## , , tarsus_Intercept:sex2
## 
##                        Estimate Est.Error     Q2.5     Q97.5
## bwt_Intercept:sex1     0.000000  0.000000 0.000000  0.000000
## tarsus_Intercept:sex1  0.000000  0.000000 0.000000  0.000000
## bwt_Intercept:sex2     2.842372  1.015386 1.159376  5.086448
## tarsus_Intercept:sex2 10.708178  3.017245 4.694964 17.028497
## 
## 
## 
## $byear
## $byear$sd
##                   Estimate Est.Error      Q2.5    Q97.5
## bwt_Intercept    0.9676965 0.1434955 0.7018779 1.258518
## tarsus_Intercept 2.0290144 0.3382466 1.4650518 2.801932
## 
## $byear$cor
## , , bwt_Intercept
## 
##                     Estimate Est.Error       Q2.5    Q97.5
## bwt_Intercept    1.000000000 0.0000000  1.0000000 1.000000
## tarsus_Intercept 0.009103073 0.2077977 -0.4096021 0.410902
## 
## , , tarsus_Intercept
## 
##                     Estimate Est.Error       Q2.5    Q97.5
## bwt_Intercept    0.009103073 0.2077977 -0.4096021 0.410902
## tarsus_Intercept 1.000000000 0.0000000  1.0000000 1.000000
## 
## 
## $byear$cov
## , , bwt_Intercept
## 
##                    Estimate Est.Error       Q2.5    Q97.5
## bwt_Intercept    0.95700691 0.2875804  0.4926327 1.583869
## tarsus_Intercept 0.04233908 0.4457863 -0.8475401 1.014920
## 
## , , tarsus_Intercept
## 
##                    Estimate Est.Error       Q2.5    Q97.5
## bwt_Intercept    0.04233908 0.4457863 -0.8475401 1.014920
## tarsus_Intercept 4.23119588 1.4453420  2.1463767 7.850826
## 
## 
## 
## $mother
## $mother$sd
##                  Estimate Est.Error     Q2.5    Q97.5
## bwt_Intercept    1.175168 0.1083817 0.958963 1.388926
## tarsus_Intercept 2.038471 0.3445355 1.327549 2.648997
## 
## $mother$cor
## , , bwt_Intercept
## 
##                    Estimate Est.Error       Q2.5      Q97.5
## bwt_Intercept     1.0000000 0.0000000  1.0000000  1.0000000
## tarsus_Intercept -0.6301934 0.2113836 -0.9652044 -0.2283133
## 
## , , tarsus_Intercept
## 
##                    Estimate Est.Error       Q2.5      Q97.5
## bwt_Intercept    -0.6301934 0.2113836 -0.9652044 -0.2283133
## tarsus_Intercept  1.0000000 0.0000000  1.0000000  1.0000000
## 
## 
## $mother$cov
## , , bwt_Intercept
## 
##                   Estimate Est.Error       Q2.5     Q97.5
## bwt_Intercept     1.392755 0.2562907  0.9196105  1.929117
## tarsus_Intercept -1.434727 0.3664843 -2.0769067 -0.674943
## 
## , , tarsus_Intercept
## 
##                   Estimate Est.Error      Q2.5     Q97.5
## bwt_Intercept    -1.434727 0.3664843 -2.076907 -0.674943
## tarsus_Intercept  4.273951 1.3914013  1.762387  7.017188
## 
## 
## 
## $residual__
## $residual__$sd
##        Estimate Est.Error     Q2.5    Q97.5
## bwt    1.489342 0.1489641 1.162192 1.741559
## tarsus 3.875633 0.2650604 3.268802 4.345400
## 
## $residual__$cor
## , , bwt
## 
##         Estimate  Est.Error      Q2.5     Q97.5
## bwt    1.0000000 0.00000000 1.0000000 1.0000000
## tarsus 0.8685184 0.04534008 0.7772864 0.9414488
## 
## , , tarsus
## 
##         Estimate  Est.Error      Q2.5     Q97.5
## bwt    0.8685184 0.04534008 0.7772864 0.9414488
## tarsus 1.0000000 0.00000000 1.0000000 1.0000000
## 
## 
## $residual__$cov
## , , bwt
## 
##        Estimate Est.Error     Q2.5    Q97.5
## bwt    2.240307 0.4341334 1.350691 3.033029
## tarsus 5.034739 0.7852137 3.272088 6.400539
## 
## , , tarsus
## 
##         Estimate Est.Error      Q2.5     Q97.5
## bwt     5.034739 0.7852137  3.272088  6.400539
## tarsus 15.090721 2.0309529 10.685067 18.882505</code></pre>
<p>However, this model is lacking an important and essentiel group-specific partitionning (we do with the asreml-R and MCMCglmm). We need to partition the residual variance (or sigma) as well.
Doing so, we will use the argument `sigma`` to parititon the model by sex. To avoid an estimation of the difference between sexes, we need to remove the estimate of the intercept at the sigma level.</p>
<div class="sourceCode" id="cb543"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb543-1"><a href="brms-2.html#cb543-1" aria-hidden="true"></a>bf_bwt_<span class="dv">4</span> &lt;-<span class="st"> </span><span class="kw">bf</span>(bwt <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>sex <span class="op">+</span><span class="st"> </span>((<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>a <span class="op">|</span><span class="st"> </span><span class="kw">gr</span>(animal, <span class="dt">cov =</span> Amat, <span class="dt">by =</span> sex))) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>b <span class="op">|</span><span class="st"> </span>byear) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>c <span class="op">|</span><span class="st"> </span>mother), sigma <span class="op">~</span><span class="st"> </span>sex <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb543-2"><a href="brms-2.html#cb543-2" aria-hidden="true"></a>bf_tarsus_<span class="dv">4</span> &lt;-<span class="st"> </span><span class="kw">bf</span>(tarsus <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>sex <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>a <span class="op">|</span><span class="st"> </span><span class="kw">gr</span>(animal, <span class="dt">cov =</span> Amat, <span class="dt">by =</span> sex)) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>b <span class="op">|</span><span class="st"> </span>byear) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>c <span class="op">|</span><span class="st"> </span>mother), sigma <span class="op">~</span><span class="st"> </span>sex <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb543-3"><a href="brms-2.html#cb543-3" aria-hidden="true"></a></span>
<span id="cb543-4"><a href="brms-2.html#cb543-4" aria-hidden="true"></a>brms_m2<span class="fl">.4</span> &lt;-<span class="st"> </span><span class="kw">brm</span>(</span>
<span id="cb543-5"><a href="brms-2.html#cb543-5" aria-hidden="true"></a>  bf_bwt_<span class="dv">4</span> <span class="op">+</span><span class="st"> </span>bf_tarsus_<span class="dv">4</span> <span class="op">+</span><span class="st"> </span><span class="kw">set_rescor</span>(<span class="ot">TRUE</span>),</span>
<span id="cb543-6"><a href="brms-2.html#cb543-6" aria-hidden="true"></a>  <span class="dt">data =</span> gryphon,</span>
<span id="cb543-7"><a href="brms-2.html#cb543-7" aria-hidden="true"></a>  <span class="dt">data2 =</span> <span class="kw">list</span>(<span class="dt">Amat =</span> Amat),</span>
<span id="cb543-8"><a href="brms-2.html#cb543-8" aria-hidden="true"></a>  <span class="dt">chains =</span> <span class="dv">2</span>, <span class="dt">cores =</span> <span class="dv">2</span>, <span class="dt">iter =</span> <span class="dv">1000</span></span>
<span id="cb543-9"><a href="brms-2.html#cb543-9" aria-hidden="true"></a>)</span>
<span id="cb543-10"><a href="brms-2.html#cb543-10" aria-hidden="true"></a><span class="kw">save</span>(brms_m2<span class="fl">.4</span>, <span class="dt">file =</span> <span class="st">&quot;data/brms_m2_4.rda&quot;</span>)</span></code></pre></div>
<p>Again we have provided the data from one such run. It can be accessed using the code:</p>
<div class="sourceCode" id="cb544"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb544-1"><a href="brms-2.html#cb544-1" aria-hidden="true"></a><span class="kw">load</span>(<span class="st">&quot;data/brms_m2_4.rda&quot;</span>)</span>
<span id="cb544-2"><a href="brms-2.html#cb544-2" aria-hidden="true"></a><span class="kw">summary</span>(brms_m2<span class="fl">.4</span>)</span></code></pre></div>
<pre><code>## Warning: Parts of the model have not converged (some Rhats are &gt; 1.05). Be
## careful when analysing the results! We recommend running more iterations and/or
## setting stronger priors.</code></pre>
<pre><code>## Warning: There were 6 divergent transitions after warmup. Increasing adapt_delta
## above 0.8 may help. See http://mc-stan.org/misc/warnings.html#divergent-
## transitions-after-warmup</code></pre>
<pre><code>##  Family: MV(gaussian, gaussian) 
##   Links: mu = identity; sigma = log
##          mu = identity; sigma = log 
## Formula: bwt ~ 1 + sex + ((1 | a | gr(animal, cov = Amat, by = sex))) + (1 | b | byear) + (1 | c | mother) 
##          sigma ~ sex - 1
##          tarsus ~ 1 + sex + (1 | a | gr(animal, cov = Amat, by = sex)) + (1 | b | byear) + (1 | c | mother) 
##          sigma ~ sex - 1
##    Data: gryphon (Number of observations: 683) 
##   Draws: 2 chains, each with iter = 1000; warmup = 500; thin = 1;
##          total post-warmup draws = 1000
## 
## Group-Level Effects: 
## ~animal (Number of levels: 683) 
##                                               Estimate Est.Error l-95% CI
## sd(bwt_Intercept:sex1)                            0.86      0.35     0.14
## sd(tarsus_Intercept:sex1)                         1.40      0.82     0.10
## sd(bwt_Intercept:sex2)                            1.40      0.23     0.94
## sd(tarsus_Intercept:sex2)                         3.49      0.72     1.96
## cor(bwt_Intercept:sex1,tarsus_Intercept:sex1)     0.28      0.51    -0.85
## cor(bwt_Intercept:sex2,tarsus_Intercept:sex2)     0.78      0.10     0.56
##                                               u-95% CI Rhat Bulk_ESS Tail_ESS
## sd(bwt_Intercept:sex1)                            1.48 1.00       59      101
## sd(tarsus_Intercept:sex1)                         3.00 1.07       45      111
## sd(bwt_Intercept:sex2)                            1.83 1.04       42       40
## sd(tarsus_Intercept:sex2)                         4.62 1.22        8       50
## cor(bwt_Intercept:sex1,tarsus_Intercept:sex1)     0.94 1.05       60      287
## cor(bwt_Intercept:sex2,tarsus_Intercept:sex2)     0.97 1.09       30       94
## 
## ~byear (Number of levels: 34) 
##                                     Estimate Est.Error l-95% CI u-95% CI Rhat
## sd(bwt_Intercept)                       0.97      0.15     0.73     1.30 1.01
## sd(tarsus_Intercept)                    2.01      0.33     1.41     2.70 1.00
## cor(bwt_Intercept,tarsus_Intercept)    -0.00      0.22    -0.42     0.45 1.02
##                                     Bulk_ESS Tail_ESS
## sd(bwt_Intercept)                        283      412
## sd(tarsus_Intercept)                     349      554
## cor(bwt_Intercept,tarsus_Intercept)      225      256
## 
## ~mother (Number of levels: 352) 
##                                     Estimate Est.Error l-95% CI u-95% CI Rhat
## sd(bwt_Intercept)                       1.19      0.11     0.98     1.42 1.00
## sd(tarsus_Intercept)                    2.14      0.30     1.57     2.71 1.05
## cor(bwt_Intercept,tarsus_Intercept)    -0.55      0.21    -0.96    -0.16 1.04
##                                     Bulk_ESS Tail_ESS
## sd(bwt_Intercept)                        279      434
## sd(tarsus_Intercept)                      46      227
## cor(bwt_Intercept,tarsus_Intercept)       46      122
## 
## Population-Level Effects: 
##                   Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## bwt_Intercept         6.27      0.23     5.82     6.73 1.01      336      556
## tarsus_Intercept     20.39      0.49    19.42    21.37 1.00      384      509
## bwt_sex2              2.04      0.17     1.70     2.38 1.00      483      507
## sigma_bwt_sex1        0.45      0.12     0.18     0.63 1.00       68      128
## sigma_bwt_sex2        0.26      0.17    -0.17     0.52 1.06       38       33
## tarsus_sex2           0.10      0.41    -0.69     0.92 1.00      658      659
## sigma_tarsus_sex1     1.37      0.08     1.19     1.50 1.04       65      215
## sigma_tarsus_sex2     1.24      0.16     0.91     1.50 1.22        7       67
## 
## Residual Correlations: 
##                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## rescor(bwt,tarsus)     0.84      0.05     0.73     0.93 1.15       11       29
## 
## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<div class="sourceCode" id="cb548"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb548-1"><a href="brms-2.html#cb548-1" aria-hidden="true"></a><span class="kw">plot</span>(brms_m2<span class="fl">.4</span>, <span class="dt">ask =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p><img src="wam_tuto_files/figure-html/unnamed-chunk-158-1.svg" width="672" /><img src="wam_tuto_files/figure-html/unnamed-chunk-158-2.svg" width="672" /><img src="wam_tuto_files/figure-html/unnamed-chunk-158-3.svg" width="672" /><img src="wam_tuto_files/figure-html/unnamed-chunk-158-4.svg" width="672" /><img src="wam_tuto_files/figure-html/unnamed-chunk-158-5.svg" width="672" /></p>
<div class="sourceCode" id="cb549"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb549-1"><a href="brms-2.html#cb549-1" aria-hidden="true"></a><span class="kw">VarCorr</span>(brms_m2<span class="fl">.4</span>)</span></code></pre></div>
<pre><code>## $animal
## $animal$sd
##                        Estimate Est.Error       Q2.5    Q97.5
## bwt_Intercept:sex1    0.8628389 0.3531696 0.14360929 1.481121
## tarsus_Intercept:sex1 1.3985239 0.8163731 0.09977045 3.002609
## bwt_Intercept:sex2    1.4023202 0.2325863 0.93896619 1.833688
## tarsus_Intercept:sex2 3.4858243 0.7167230 1.96177030 4.620105
## 
## $animal$cor
## , , bwt_Intercept:sex1
## 
##                       Estimate Est.Error       Q2.5     Q97.5
## bwt_Intercept:sex1    1.000000 0.0000000  1.0000000 1.0000000
## tarsus_Intercept:sex1 0.277338 0.5119501 -0.8479996 0.9398158
## bwt_Intercept:sex2    0.000000 0.0000000  0.0000000 0.0000000
## tarsus_Intercept:sex2 0.000000 0.0000000  0.0000000 0.0000000
## 
## , , tarsus_Intercept:sex1
## 
##                       Estimate Est.Error       Q2.5     Q97.5
## bwt_Intercept:sex1    0.277338 0.5119501 -0.8479996 0.9398158
## tarsus_Intercept:sex1 1.000000 0.0000000  1.0000000 1.0000000
## bwt_Intercept:sex2    0.000000 0.0000000  0.0000000 0.0000000
## tarsus_Intercept:sex2 0.000000 0.0000000  0.0000000 0.0000000
## 
## , , bwt_Intercept:sex2
## 
##                        Estimate  Est.Error     Q2.5     Q97.5
## bwt_Intercept:sex1    0.0000000 0.00000000 0.000000 0.0000000
## tarsus_Intercept:sex1 0.0000000 0.00000000 0.000000 0.0000000
## bwt_Intercept:sex2    1.0000000 0.00000000 1.000000 1.0000000
## tarsus_Intercept:sex2 0.7781659 0.09850178 0.564036 0.9699765
## 
## , , tarsus_Intercept:sex2
## 
##                        Estimate  Est.Error     Q2.5     Q97.5
## bwt_Intercept:sex1    0.0000000 0.00000000 0.000000 0.0000000
## tarsus_Intercept:sex1 0.0000000 0.00000000 0.000000 0.0000000
## bwt_Intercept:sex2    0.7781659 0.09850178 0.564036 0.9699765
## tarsus_Intercept:sex2 1.0000000 0.00000000 1.000000 1.0000000
## 
## 
## $animal$cov
## , , bwt_Intercept:sex1
## 
##                        Estimate Est.Error       Q2.5    Q97.5
## bwt_Intercept:sex1    0.8690949 0.6002446  0.0206250 2.193721
## tarsus_Intercept:sex1 0.6483841 0.9143700 -0.4481203 2.989048
## bwt_Intercept:sex2    0.0000000 0.0000000  0.0000000 0.000000
## tarsus_Intercept:sex2 0.0000000 0.0000000  0.0000000 0.000000
## 
## , , tarsus_Intercept:sex1
## 
##                        Estimate Est.Error         Q2.5    Q97.5
## bwt_Intercept:sex1    0.6483841  0.914370 -0.448120294 2.989048
## tarsus_Intercept:sex1 2.6216677  2.500989  0.009954235 9.015666
## bwt_Intercept:sex2    0.0000000  0.000000  0.000000000 0.000000
## tarsus_Intercept:sex2 0.0000000  0.000000  0.000000000 0.000000
## 
## , , bwt_Intercept:sex2
## 
##                       Estimate Est.Error      Q2.5    Q97.5
## bwt_Intercept:sex1    0.000000  0.000000 0.0000000 0.000000
## tarsus_Intercept:sex1 0.000000  0.000000 0.0000000 0.000000
## bwt_Intercept:sex2    2.020544  0.639550 0.8816577 3.362416
## tarsus_Intercept:sex2 3.875299  1.298562 1.4247624 6.415724
## 
## , , tarsus_Intercept:sex2
## 
##                        Estimate Est.Error     Q2.5     Q97.5
## bwt_Intercept:sex1     0.000000  0.000000 0.000000  0.000000
## tarsus_Intercept:sex1  0.000000  0.000000 0.000000  0.000000
## bwt_Intercept:sex2     3.875299  1.298562 1.424762  6.415724
## tarsus_Intercept:sex2 12.664149  4.814957 3.848544 21.345370
## 
## 
## 
## $byear
## $byear$sd
##                   Estimate Est.Error      Q2.5    Q97.5
## bwt_Intercept    0.9707654 0.1478361 0.7256973 1.298668
## tarsus_Intercept 2.0073203 0.3290043 1.4102530 2.699770
## 
## $byear$cor
## , , bwt_Intercept
## 
##                      Estimate Est.Error       Q2.5     Q97.5
## bwt_Intercept     1.000000000 0.0000000  1.0000000 1.0000000
## tarsus_Intercept -0.001551923 0.2236193 -0.4237849 0.4526618
## 
## , , tarsus_Intercept
## 
##                      Estimate Est.Error       Q2.5     Q97.5
## bwt_Intercept    -0.001551923 0.2236193 -0.4237849 0.4526618
## tarsus_Intercept  1.000000000 0.0000000  1.0000000 1.0000000
## 
## 
## $byear$cov
## , , bwt_Intercept
## 
##                   Estimate Est.Error       Q2.5    Q97.5
## bwt_Intercept    0.9642191 0.3021042  0.5266366 1.686538
## tarsus_Intercept 0.0252866 0.4713288 -0.8080314 1.069567
## 
## , , tarsus_Intercept
## 
##                   Estimate Est.Error       Q2.5    Q97.5
## bwt_Intercept    0.0252866 0.4713288 -0.8080314 1.069567
## tarsus_Intercept 4.1374703 1.3676889  1.9888135 7.288761
## 
## 
## 
## $mother
## $mother$sd
##                  Estimate Est.Error      Q2.5    Q97.5
## bwt_Intercept    1.189902 0.1113270 0.9791374 1.423333
## tarsus_Intercept 2.139290 0.2985875 1.5714814 2.708199
## 
## $mother$cor
## , , bwt_Intercept
## 
##                    Estimate Est.Error       Q2.5      Q97.5
## bwt_Intercept     1.0000000 0.0000000  1.0000000  1.0000000
## tarsus_Intercept -0.5501934 0.2066985 -0.9589938 -0.1591737
## 
## , , tarsus_Intercept
## 
##                    Estimate Est.Error       Q2.5      Q97.5
## bwt_Intercept    -0.5501934 0.2066985 -0.9589938 -0.1591737
## tarsus_Intercept  1.0000000 0.0000000  1.0000000  1.0000000
## 
## 
## $mother$cov
## , , bwt_Intercept
## 
##                   Estimate Est.Error      Q2.5      Q97.5
## bwt_Intercept     1.428247 0.2672833  0.958710  2.0258758
## tarsus_Intercept -1.335450 0.3932707 -2.051866 -0.5146954
## 
## , , tarsus_Intercept
## 
##                   Estimate Est.Error      Q2.5      Q97.5
## bwt_Intercept    -1.335450 0.3932707 -2.051866 -0.5146954
## tarsus_Intercept  4.665626 1.2688941  2.469554  7.3343400</code></pre>
<p>Evaluation of the statistical support for these sex-specific correlations is straightforward. Because we imposed no constraint on their estimation, we can evaluate the extent to which the posterior distributions overlap zero or overlap each other:</p>
<div class="sourceCode" id="cb551"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb551-1"><a href="brms-2.html#cb551-1" aria-hidden="true"></a>cor_g_F &lt;-<span class="st"> </span><span class="kw">as.mcmc</span>((<span class="kw">VarCorr</span>(brms_m2<span class="fl">.4</span>, <span class="dt">summary =</span> <span class="ot">FALSE</span>)<span class="op">$</span>animal<span class="op">$</span>cor[, <span class="dv">1</span>, <span class="dv">2</span>]))</span>
<span id="cb551-2"><a href="brms-2.html#cb551-2" aria-hidden="true"></a>cor_g_M &lt;-<span class="st"> </span><span class="kw">as.mcmc</span>((<span class="kw">VarCorr</span>(brms_m2<span class="fl">.4</span>, <span class="dt">summary =</span> <span class="ot">FALSE</span>)<span class="op">$</span>animal<span class="op">$</span>cor[, <span class="dv">3</span>, <span class="dv">4</span>]))</span>
<span id="cb551-3"><a href="brms-2.html#cb551-3" aria-hidden="true"></a></span>
<span id="cb551-4"><a href="brms-2.html#cb551-4" aria-hidden="true"></a><span class="kw">summary</span>(cor_g_F)</span></code></pre></div>
<pre><code>## 
## Iterations = 1:1000
## Thinning interval = 1 
## Number of chains = 1 
## Sample size per chain = 1000 
## 
## 1. Empirical mean and standard deviation for each variable,
##    plus standard error of the mean:
## 
##           Mean             SD       Naive SE Time-series SE 
##        0.27734        0.51195        0.01619        0.05981 
## 
## 2. Quantiles for each variable:
## 
##     2.5%      25%      50%      75%    97.5% 
## -0.84800 -0.02476  0.43226  0.67124  0.93982</code></pre>
<div class="sourceCode" id="cb553"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb553-1"><a href="brms-2.html#cb553-1" aria-hidden="true"></a><span class="kw">summary</span>(cor_g_M)</span></code></pre></div>
<pre><code>## 
## Iterations = 1:1000
## Thinning interval = 1 
## Number of chains = 1 
## Sample size per chain = 1000 
## 
## 1. Empirical mean and standard deviation for each variable,
##    plus standard error of the mean:
## 
##           Mean             SD       Naive SE Time-series SE 
##       0.778166       0.098502       0.003115       0.013827 
## 
## 2. Quantiles for each variable:
## 
##   2.5%    25%    50%    75%  97.5% 
## 0.5640 0.7240 0.7805 0.8424 0.9700</code></pre>
<div class="sourceCode" id="cb555"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb555-1"><a href="brms-2.html#cb555-1" aria-hidden="true"></a><span class="kw">plot</span>(cor_g_F)</span></code></pre></div>
<p><img src="wam_tuto_files/figure-html/unnamed-chunk-159-1.svg" width="672" /></p>
<div class="sourceCode" id="cb556"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb556-1"><a href="brms-2.html#cb556-1" aria-hidden="true"></a><span class="kw">plot</span>(cor_g_M)</span></code></pre></div>
<p><img src="wam_tuto_files/figure-html/unnamed-chunk-159-2.svg" width="672" /></p>
<p>Here a plot to visualize the overlaps of covariances.</p>
<div class="sourceCode" id="cb557"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb557-1"><a href="brms-2.html#cb557-1" aria-hidden="true"></a>cor.est &lt;-<span class="st"> </span><span class="kw">rbind</span>(</span>
<span id="cb557-2"><a href="brms-2.html#cb557-2" aria-hidden="true"></a>  <span class="kw">cbind</span>(<span class="kw">summary</span>(cor_g_F)<span class="op">$</span>statistics[<span class="dv">1</span>], <span class="kw">summary</span>(cor_g_F)<span class="op">$</span>quantiles[<span class="dv">1</span>], <span class="kw">summary</span>(cor_g_F)<span class="op">$</span>quantiles[<span class="dv">5</span>]),</span>
<span id="cb557-3"><a href="brms-2.html#cb557-3" aria-hidden="true"></a>  <span class="kw">cbind</span>(<span class="kw">summary</span>(cor_g_M)<span class="op">$</span>statistics[<span class="dv">1</span>], <span class="kw">summary</span>(cor_g_M)<span class="op">$</span>quantiles[<span class="dv">1</span>], <span class="kw">summary</span>(cor_g_M)<span class="op">$</span>quantiles[<span class="dv">5</span>])</span>
<span id="cb557-4"><a href="brms-2.html#cb557-4" aria-hidden="true"></a>)</span>
<span id="cb557-5"><a href="brms-2.html#cb557-5" aria-hidden="true"></a></span>
<span id="cb557-6"><a href="brms-2.html#cb557-6" aria-hidden="true"></a></span>
<span id="cb557-7"><a href="brms-2.html#cb557-7" aria-hidden="true"></a><span class="kw">plot</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>) <span class="op">~</span><span class="st"> </span>cor.est[, <span class="dv">1</span>], <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">2.5</span>), <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>), <span class="dt">pch =</span> <span class="kw">c</span>(<span class="dv">16</span>, <span class="dv">17</span>), <span class="dt">cex =</span> <span class="dv">2</span>, <span class="dt">yaxt =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb557-8"><a href="brms-2.html#cb557-8" aria-hidden="true"></a><span class="kw">segments</span>(<span class="dt">y0 =</span> <span class="dv">1</span>, <span class="dt">x0 =</span> cor.est[<span class="dv">1</span>, <span class="dv">2</span>], <span class="dt">y1 =</span> <span class="dv">1</span>, <span class="dt">x1 =</span> cor.est[<span class="dv">1</span>, <span class="dv">3</span>], <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>), <span class="dt">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb557-9"><a href="brms-2.html#cb557-9" aria-hidden="true"></a><span class="kw">segments</span>(<span class="dt">y0 =</span> <span class="dv">2</span>, <span class="dt">x0 =</span> cor.est[<span class="dv">2</span>, <span class="dv">2</span>], <span class="dt">y1 =</span> <span class="dv">2</span>, <span class="dt">x1 =</span> cor.est[<span class="dv">2</span>, <span class="dv">3</span>], <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>), <span class="dt">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb557-10"><a href="brms-2.html#cb557-10" aria-hidden="true"></a><span class="kw">mtext</span>(<span class="st">&quot;Covariance (±CI)&quot;</span>, <span class="dt">side =</span> <span class="dv">1</span>, <span class="dt">las =</span> <span class="dv">1</span>, <span class="dt">adj =</span> <span class="fl">0.4</span>, <span class="dt">line =</span> <span class="dv">3</span>, <span class="dt">cex =</span> <span class="fl">1.6</span>)</span>
<span id="cb557-11"><a href="brms-2.html#cb557-11" aria-hidden="true"></a><span class="kw">axis</span>(<span class="dv">2</span>, <span class="dt">at =</span> <span class="dv">1</span>, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;female&quot;</span>), <span class="dt">las =</span> <span class="dv">3</span>, <span class="dt">cex.axis =</span> <span class="fl">1.6</span>)</span>
<span id="cb557-12"><a href="brms-2.html#cb557-12" aria-hidden="true"></a><span class="kw">axis</span>(<span class="dv">2</span>, <span class="dt">at =</span> <span class="dv">2</span>, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;male&quot;</span>), <span class="dt">las =</span> <span class="dv">3</span>, <span class="dt">cex.axis =</span> <span class="fl">1.6</span>)</span></code></pre></div>
<p><img src="wam_tuto_files/figure-html/unnamed-chunk-160-1.svg" width="672" /></p>
<p>Here a simple plot of the sex-specific genetic correlation using the BLUPs</p>
<div class="sourceCode" id="cb558"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb558-1"><a href="brms-2.html#cb558-1" aria-hidden="true"></a>bls_m2<span class="fl">.4</span> &lt;-<span class="st"> </span><span class="kw">ranef</span>(brms_m2<span class="fl">.4</span>)<span class="op">$</span>animal</span>
<span id="cb558-2"><a href="brms-2.html#cb558-2" aria-hidden="true"></a>bl_m2<span class="fl">.4</span> &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(abind<span class="op">::</span><span class="kw">abind</span>(<span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">dim</span>(bls_m2<span class="fl">.4</span>)[<span class="dv">3</span>], <span class="cf">function</span>(x) bls_m2<span class="fl">.4</span>[, <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">4</span>), x])))</span>
<span id="cb558-3"><a href="brms-2.html#cb558-3" aria-hidden="true"></a><span class="kw">colnames</span>(bl_m2<span class="fl">.4</span>) &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">rep</span>(<span class="kw">dimnames</span>(bls_m2<span class="fl">.4</span>)[[<span class="dv">3</span>]], <span class="dt">each =</span> <span class="dv">3</span>), <span class="kw">c</span>(<span class="st">&quot;&quot;</span>, <span class="st">&quot;_lo&quot;</span>, <span class="st">&quot;_up&quot;</span>))</span>
<span id="cb558-4"><a href="brms-2.html#cb558-4" aria-hidden="true"></a>bl_m2<span class="fl">.4</span><span class="op">$</span>id &lt;-<span class="st"> </span><span class="kw">rownames</span>(bl_m2<span class="fl">.4</span>)</span>
<span id="cb558-5"><a href="brms-2.html#cb558-5" aria-hidden="true"></a>bl_m2<span class="fl">.4</span><span class="op">$</span>sex &lt;-<span class="st"> </span><span class="kw">attr</span>(<span class="kw">dimnames</span>(bls_m2<span class="fl">.4</span>)[[<span class="dv">1</span>]], <span class="st">&quot;by&quot;</span>)</span>
<span id="cb558-6"><a href="brms-2.html#cb558-6" aria-hidden="true"></a>FEM &lt;-<span class="st"> </span><span class="kw">subset</span>(bl_m2<span class="fl">.4</span>, sex <span class="op">==</span><span class="st"> &quot;1&quot;</span>)</span>
<span id="cb558-7"><a href="brms-2.html#cb558-7" aria-hidden="true"></a>MAL &lt;-<span class="st"> </span><span class="kw">subset</span>(bl_m2<span class="fl">.4</span>, sex <span class="op">==</span><span class="st"> &quot;2&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb559"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb559-1"><a href="brms-2.html#cb559-1" aria-hidden="true"></a><span class="co">#</span></span>
<span id="cb559-2"><a href="brms-2.html#cb559-2" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb559-3"><a href="brms-2.html#cb559-3" aria-hidden="true"></a><span class="kw">plot</span>(tarsus_Intercept <span class="op">~</span><span class="st"> </span>bwt_Intercept, FEM,</span>
<span id="cb559-4"><a href="brms-2.html#cb559-4" aria-hidden="true"></a>  <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb559-5"><a href="brms-2.html#cb559-5" aria-hidden="true"></a>  <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="kw">min</span>(FEM<span class="op">$</span>bwt_Intercept_lo), <span class="kw">max</span>(FEM<span class="op">$</span>bwt_Intercept_up)),</span>
<span id="cb559-6"><a href="brms-2.html#cb559-6" aria-hidden="true"></a>  <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="kw">min</span>(FEM<span class="op">$</span>tarsus_Intercept_lo), <span class="kw">max</span>(FEM<span class="op">$</span>tarsus_Intercept_up)),</span>
<span id="cb559-7"><a href="brms-2.html#cb559-7" aria-hidden="true"></a>  <span class="dt">las =</span> <span class="fl">1.2</span>, <span class="dt">type =</span> <span class="st">&quot;n&quot;</span></span>
<span id="cb559-8"><a href="brms-2.html#cb559-8" aria-hidden="true"></a>)</span>
<span id="cb559-9"><a href="brms-2.html#cb559-9" aria-hidden="true"></a><span class="kw">segments</span>(</span>
<span id="cb559-10"><a href="brms-2.html#cb559-10" aria-hidden="true"></a>  <span class="dt">x0 =</span> FEM<span class="op">$</span>bwt_Intercept, <span class="dt">y0 =</span> FEM<span class="op">$</span>tarsus_Intercept_lo,</span>
<span id="cb559-11"><a href="brms-2.html#cb559-11" aria-hidden="true"></a>  <span class="dt">x1 =</span> FEM<span class="op">$</span>bwt_Intercept, <span class="dt">y1 =</span> FEM<span class="op">$</span>tarsus_Intercept_up,</span>
<span id="cb559-12"><a href="brms-2.html#cb559-12" aria-hidden="true"></a>  <span class="dt">col =</span> <span class="st">&quot;black&quot;</span></span>
<span id="cb559-13"><a href="brms-2.html#cb559-13" aria-hidden="true"></a>)</span>
<span id="cb559-14"><a href="brms-2.html#cb559-14" aria-hidden="true"></a><span class="kw">segments</span>(</span>
<span id="cb559-15"><a href="brms-2.html#cb559-15" aria-hidden="true"></a>  <span class="dt">x0 =</span> FEM<span class="op">$</span>bwt_Intercept_lo, <span class="dt">y0 =</span> FEM<span class="op">$</span>tarsus_Intercept,</span>
<span id="cb559-16"><a href="brms-2.html#cb559-16" aria-hidden="true"></a>  <span class="dt">x1 =</span> FEM<span class="op">$</span>bwt_Intercept_up, <span class="dt">y1 =</span> FEM<span class="op">$</span>tarsus_Intercept,</span>
<span id="cb559-17"><a href="brms-2.html#cb559-17" aria-hidden="true"></a>  <span class="dt">col =</span> <span class="st">&quot;black&quot;</span></span>
<span id="cb559-18"><a href="brms-2.html#cb559-18" aria-hidden="true"></a>)</span>
<span id="cb559-19"><a href="brms-2.html#cb559-19" aria-hidden="true"></a><span class="kw">points</span>(tarsus_Intercept <span class="op">~</span><span class="st"> </span>bwt_Intercept, FEM, <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">cex =</span> <span class="fl">1.5</span>)</span>
<span id="cb559-20"><a href="brms-2.html#cb559-20" aria-hidden="true"></a><span class="kw">points</span>(tarsus_Intercept <span class="op">~</span><span class="st"> </span>bwt_Intercept, FEM, <span class="dt">pch =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="kw">rgb</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.3</span>), <span class="dt">cex =</span> <span class="kw">c</span>(<span class="fl">1.5</span>))</span>
<span id="cb559-21"><a href="brms-2.html#cb559-21" aria-hidden="true"></a><span class="kw">mtext</span>(<span class="st">&quot;btw (BV±CI)&quot;</span>, <span class="dt">side =</span> <span class="dv">1</span>, <span class="dt">line =</span> <span class="fl">2.4</span>)</span>
<span id="cb559-22"><a href="brms-2.html#cb559-22" aria-hidden="true"></a><span class="kw">mtext</span>(<span class="st">&quot;tarsus (BV±CI)&quot;</span>, <span class="dt">side =</span> <span class="dv">2</span>, <span class="dt">line =</span> <span class="dv">2</span>, <span class="dt">las =</span> <span class="dv">3</span>)</span>
<span id="cb559-23"><a href="brms-2.html#cb559-23" aria-hidden="true"></a><span class="co">#</span></span>
<span id="cb559-24"><a href="brms-2.html#cb559-24" aria-hidden="true"></a><span class="kw">plot</span>(tarsus_Intercept <span class="op">~</span><span class="st"> </span>bwt_Intercept, MAL,</span>
<span id="cb559-25"><a href="brms-2.html#cb559-25" aria-hidden="true"></a>  <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb559-26"><a href="brms-2.html#cb559-26" aria-hidden="true"></a>  <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="kw">min</span>(MAL<span class="op">$</span>bwt_Intercept_lo), <span class="kw">max</span>(MAL<span class="op">$</span>bwt_Intercept_up)),</span>
<span id="cb559-27"><a href="brms-2.html#cb559-27" aria-hidden="true"></a>  <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="kw">min</span>(MAL<span class="op">$</span>tarsus_Intercept_lo), <span class="kw">max</span>(MAL<span class="op">$</span>tarsus_Intercept_up)),</span>
<span id="cb559-28"><a href="brms-2.html#cb559-28" aria-hidden="true"></a>  <span class="dt">las =</span> <span class="fl">1.2</span>, <span class="dt">type =</span> <span class="st">&quot;n&quot;</span></span>
<span id="cb559-29"><a href="brms-2.html#cb559-29" aria-hidden="true"></a>)</span>
<span id="cb559-30"><a href="brms-2.html#cb559-30" aria-hidden="true"></a><span class="kw">segments</span>(</span>
<span id="cb559-31"><a href="brms-2.html#cb559-31" aria-hidden="true"></a>  <span class="dt">x0 =</span> MAL<span class="op">$</span>bwt_Intercept, <span class="dt">y0 =</span> MAL<span class="op">$</span>tarsus_Intercept_lo,</span>
<span id="cb559-32"><a href="brms-2.html#cb559-32" aria-hidden="true"></a>  <span class="dt">x1 =</span> MAL<span class="op">$</span>bwt_Intercept, <span class="dt">y1 =</span> MAL<span class="op">$</span>tarsus_Intercept_up, <span class="dt">col =</span> <span class="st">&quot;black&quot;</span></span>
<span id="cb559-33"><a href="brms-2.html#cb559-33" aria-hidden="true"></a>)</span>
<span id="cb559-34"><a href="brms-2.html#cb559-34" aria-hidden="true"></a><span class="kw">segments</span>(</span>
<span id="cb559-35"><a href="brms-2.html#cb559-35" aria-hidden="true"></a>  <span class="dt">x0 =</span> MAL<span class="op">$</span>bwt_Intercept_lo, <span class="dt">y0 =</span> MAL<span class="op">$</span>tarsus_Intercept,</span>
<span id="cb559-36"><a href="brms-2.html#cb559-36" aria-hidden="true"></a>  <span class="dt">x1 =</span> MAL<span class="op">$</span>bwt_Intercept_up, <span class="dt">y1 =</span> MAL<span class="op">$</span>tarsus_Intercept, <span class="dt">col =</span> <span class="st">&quot;black&quot;</span></span>
<span id="cb559-37"><a href="brms-2.html#cb559-37" aria-hidden="true"></a>)</span>
<span id="cb559-38"><a href="brms-2.html#cb559-38" aria-hidden="true"></a><span class="kw">points</span>(tarsus_Intercept <span class="op">~</span><span class="st"> </span>bwt_Intercept, MAL, <span class="dt">pch =</span> <span class="dv">17</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">cex =</span> <span class="fl">1.5</span>)</span>
<span id="cb559-39"><a href="brms-2.html#cb559-39" aria-hidden="true"></a><span class="kw">points</span>(tarsus_Intercept <span class="op">~</span><span class="st"> </span>bwt_Intercept, MAL, <span class="dt">pch =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="kw">rgb</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.3</span>), <span class="dt">cex =</span> <span class="kw">c</span>(<span class="fl">1.5</span>))</span>
<span id="cb559-40"><a href="brms-2.html#cb559-40" aria-hidden="true"></a><span class="kw">mtext</span>(<span class="st">&quot;btw (BV±CI)&quot;</span>, <span class="dt">side =</span> <span class="dv">1</span>, <span class="dt">line =</span> <span class="fl">2.4</span>)</span>
<span id="cb559-41"><a href="brms-2.html#cb559-41" aria-hidden="true"></a><span class="kw">mtext</span>(<span class="st">&quot;tarsus (BV±CI)&quot;</span>, <span class="dt">side =</span> <span class="dv">2</span>, <span class="dt">line =</span> <span class="dv">2</span>, <span class="dt">las =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="wam_tuto_files/figure-html/unnamed-chunk-162-1.svg" width="672" /></p>
</div>
<div id="between-groups-covariances-and-the-b-matrix-2" class="section level3 hasAnchor" number="3.5.4">
<h3><span class="header-section-number">3.5.4</span> Between groups (co)variances and the B-matrix<a href="brms-2.html#between-groups-covariances-and-the-b-matrix-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Animal models are amazing model. With different group within a population, it is also possible to estimate how much the different groups shared the same genetic via the cross-group genetic covariance.
This covariance is essential to understand ontogenic or sexual conflict, which can constraint or enhanced response to evolution.
As an example, we estimate the cross-sex genetic correlation <code>r_{fm}</code></p>
<p>It is important to keep in mind the covariance matrix at the residual level is zero and it is important to avoid estimating the cross-sex residual covariance because no individual switched sex during the experiment.</p>
<p>Note: the way of partitionning variance per sex is a bit different then the previous code “,by=sex”.<br />
This code is faster and also easier to understand. Note, it is possible to play with the <code>|</code> or <code>||</code> to estimate or not covariance between sexes.</p>
<div class="sourceCode" id="cb560"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb560-1"><a href="brms-2.html#cb560-1" aria-hidden="true"></a>bf_bwt_<span class="dv">5</span> &lt;-<span class="st"> </span><span class="kw">bf</span>(</span>
<span id="cb560-2"><a href="brms-2.html#cb560-2" aria-hidden="true"></a>  bwt <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>sex <span class="op">+</span><span class="st"> </span>(<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>sex <span class="op">|</span><span class="st"> </span>a <span class="op">|</span><span class="st"> </span><span class="kw">gr</span>(animal, <span class="dt">cov =</span> Amat)) <span class="op">+</span><span class="st"> </span>(<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>sex <span class="op">|</span><span class="st"> </span>b <span class="op">|</span><span class="st"> </span>mother) <span class="op">+</span><span class="st"> </span>(<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>sex <span class="op">|</span><span class="st"> </span>c <span class="op">|</span><span class="st"> </span>byear),</span>
<span id="cb560-3"><a href="brms-2.html#cb560-3" aria-hidden="true"></a>  sigma <span class="op">~</span><span class="st"> </span>sex <span class="op">-</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb560-4"><a href="brms-2.html#cb560-4" aria-hidden="true"></a>)</span>
<span id="cb560-5"><a href="brms-2.html#cb560-5" aria-hidden="true"></a>bf_tarsus_<span class="dv">5</span> &lt;-<span class="st"> </span><span class="kw">bf</span>(</span>
<span id="cb560-6"><a href="brms-2.html#cb560-6" aria-hidden="true"></a>  tarsus <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>sex <span class="op">+</span><span class="st"> </span>(<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>sex <span class="op">|</span><span class="st"> </span>a <span class="op">|</span><span class="st"> </span><span class="kw">gr</span>(animal, <span class="dt">cov =</span> Amat)) <span class="op">+</span><span class="st"> </span>(<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>sex <span class="op">|</span><span class="st"> </span>b <span class="op">|</span><span class="st"> </span>mother) <span class="op">+</span><span class="st"> </span>(<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>sex <span class="op">|</span><span class="st"> </span>c <span class="op">|</span><span class="st"> </span>byear),</span>
<span id="cb560-7"><a href="brms-2.html#cb560-7" aria-hidden="true"></a>  sigma <span class="op">~</span><span class="st"> </span>sex <span class="op">-</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb560-8"><a href="brms-2.html#cb560-8" aria-hidden="true"></a>)</span>
<span id="cb560-9"><a href="brms-2.html#cb560-9" aria-hidden="true"></a></span>
<span id="cb560-10"><a href="brms-2.html#cb560-10" aria-hidden="true"></a>brms_m2<span class="fl">.5</span> &lt;-<span class="st"> </span><span class="kw">brm</span>(</span>
<span id="cb560-11"><a href="brms-2.html#cb560-11" aria-hidden="true"></a>  bf_bwt_<span class="dv">5</span> <span class="op">+</span><span class="st"> </span>bf_tarsus_<span class="dv">5</span> <span class="op">+</span><span class="st"> </span><span class="kw">set_rescor</span>(<span class="ot">TRUE</span>),</span>
<span id="cb560-12"><a href="brms-2.html#cb560-12" aria-hidden="true"></a>  <span class="dt">data =</span> gryphon,</span>
<span id="cb560-13"><a href="brms-2.html#cb560-13" aria-hidden="true"></a>  <span class="dt">data2 =</span> <span class="kw">list</span>(<span class="dt">Amat =</span> Amat),</span>
<span id="cb560-14"><a href="brms-2.html#cb560-14" aria-hidden="true"></a>  <span class="dt">chains =</span> <span class="dv">2</span>, <span class="dt">cores =</span> <span class="dv">2</span>, <span class="dt">iter =</span> <span class="dv">1000</span></span>
<span id="cb560-15"><a href="brms-2.html#cb560-15" aria-hidden="true"></a>)</span>
<span id="cb560-16"><a href="brms-2.html#cb560-16" aria-hidden="true"></a><span class="kw">save</span>(brms_m2<span class="fl">.5</span>, <span class="dt">file =</span> <span class="st">&quot;data/brms_m2_5.rda&quot;</span>)</span></code></pre></div>
<p>Again we have provided the data from one such run. It can be accessed using the code:</p>
<div class="sourceCode" id="cb561"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb561-1"><a href="brms-2.html#cb561-1" aria-hidden="true"></a><span class="kw">load</span>(<span class="st">&quot;data/brms_m2_5.rda&quot;</span>)</span>
<span id="cb561-2"><a href="brms-2.html#cb561-2" aria-hidden="true"></a><span class="kw">summary</span>(brms_m2<span class="fl">.5</span>)</span></code></pre></div>
<pre><code>## Warning: Parts of the model have not converged (some Rhats are &gt; 1.05). Be
## careful when analysing the results! We recommend running more iterations and/or
## setting stronger priors.</code></pre>
<pre><code>## Warning: There were 45 divergent transitions after warmup. Increasing
## adapt_delta above 0.8 may help. See http://mc-stan.org/misc/
## warnings.html#divergent-transitions-after-warmup</code></pre>
<pre><code>##  Family: MV(gaussian, gaussian) 
##   Links: mu = identity; sigma = log
##          mu = identity; sigma = log 
## Formula: bwt ~ 1 + sex + (0 + sex | a | gr(animal, cov = Amat)) + (0 + sex | b | mother) + (0 + sex | c | byear) 
##          sigma ~ sex - 1
##          tarsus ~ 1 + sex + (0 + sex | a | gr(animal, cov = Amat)) + (0 + sex | b | mother) + (0 + sex | c | byear) 
##          sigma ~ sex - 1
##    Data: gryphon (Number of observations: 683) 
##   Draws: 2 chains, each with iter = 1000; warmup = 500; thin = 1;
##          total post-warmup draws = 1000
## 
## Group-Level Effects: 
## ~animal (Number of levels: 683) 
##                              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
## sd(bwt_sex1)                     1.26      0.30     0.63     1.73 1.06       21
## sd(bwt_sex2)                     1.08      0.42     0.20     1.77 1.08       18
## sd(tarsus_sex1)                  2.26      0.72     0.61     3.57 1.04       40
## sd(tarsus_sex2)                  2.74      1.05     0.61     4.47 1.13       12
## cor(bwt_sex1,bwt_sex2)           0.48      0.29    -0.24     0.87 1.02       84
## cor(bwt_sex1,tarsus_sex1)        0.57      0.25    -0.07     0.89 1.14       10
## cor(bwt_sex2,tarsus_sex1)        0.38      0.38    -0.53     0.91 1.25        7
## cor(bwt_sex1,tarsus_sex2)        0.17      0.31    -0.49     0.75 1.04       60
## cor(bwt_sex2,tarsus_sex2)        0.52      0.33    -0.37     0.87 1.20        8
## cor(tarsus_sex1,tarsus_sex2)     0.44      0.29    -0.30     0.87 1.03       47
##                              Tail_ESS
## sd(bwt_sex1)                      104
## sd(bwt_sex2)                       25
## sd(tarsus_sex1)                    99
## sd(tarsus_sex2)                    42
## cor(bwt_sex1,bwt_sex2)            112
## cor(bwt_sex1,tarsus_sex1)         145
## cor(bwt_sex2,tarsus_sex1)          67
## cor(bwt_sex1,tarsus_sex2)          94
## cor(bwt_sex2,tarsus_sex2)          50
## cor(tarsus_sex1,tarsus_sex2)       44
## 
## ~byear (Number of levels: 34) 
##                              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
## sd(bwt_sex1)                     0.80      0.16     0.53     1.16 1.00      394
## sd(bwt_sex2)                     1.14      0.19     0.81     1.55 1.01      358
## sd(tarsus_sex1)                  2.23      0.46     1.50     3.18 1.01      297
## sd(tarsus_sex2)                  2.34      0.49     1.56     3.41 1.01      229
## cor(bwt_sex1,bwt_sex2)           0.74      0.15     0.35     0.96 1.01      266
## cor(bwt_sex1,tarsus_sex1)       -0.11      0.24    -0.55     0.35 1.01      190
## cor(bwt_sex2,tarsus_sex1)       -0.39      0.20    -0.73     0.00 1.01      410
## cor(bwt_sex1,tarsus_sex2)        0.29      0.23    -0.17     0.71 1.00      256
## cor(bwt_sex2,tarsus_sex2)        0.29      0.21    -0.16     0.66 1.01      327
## cor(tarsus_sex1,tarsus_sex2)     0.52      0.19     0.12     0.84 1.00      285
##                              Tail_ESS
## sd(bwt_sex1)                      619
## sd(bwt_sex2)                      653
## sd(tarsus_sex1)                   559
## sd(tarsus_sex2)                   239
## cor(bwt_sex1,bwt_sex2)            433
## cor(bwt_sex1,tarsus_sex1)         603
## cor(bwt_sex2,tarsus_sex1)         656
## cor(bwt_sex1,tarsus_sex2)         319
## cor(bwt_sex2,tarsus_sex2)         474
## cor(tarsus_sex1,tarsus_sex2)      600
## 
## ~mother (Number of levels: 352) 
##                              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
## sd(bwt_sex1)                     1.08      0.15     0.79     1.39 1.01      281
## sd(bwt_sex2)                     1.33      0.15     1.03     1.62 1.00      233
## sd(tarsus_sex1)                  2.21      0.40     1.36     2.95 1.01       72
## sd(tarsus_sex2)                  2.31      0.49     1.38     3.34 1.05       50
## cor(bwt_sex1,bwt_sex2)           0.83      0.11     0.57     0.98 1.01       68
## cor(bwt_sex1,tarsus_sex1)       -0.50      0.24    -0.91    -0.07 1.01       57
## cor(bwt_sex2,tarsus_sex1)       -0.64      0.17    -0.93    -0.28 1.06       50
## cor(bwt_sex1,tarsus_sex2)       -0.51      0.22    -0.88    -0.08 1.05       67
## cor(bwt_sex2,tarsus_sex2)       -0.36      0.26    -0.84     0.11 1.05       54
## cor(tarsus_sex1,tarsus_sex2)     0.72      0.16     0.37     0.95 1.01      249
##                              Tail_ESS
## sd(bwt_sex1)                      518
## sd(bwt_sex2)                      585
## sd(tarsus_sex1)                   224
## sd(tarsus_sex2)                   191
## cor(bwt_sex1,bwt_sex2)            296
## cor(bwt_sex1,tarsus_sex1)         156
## cor(bwt_sex2,tarsus_sex1)         268
## cor(bwt_sex1,tarsus_sex2)         124
## cor(bwt_sex2,tarsus_sex2)         297
## cor(tarsus_sex1,tarsus_sex2)      596
## 
## Population-Level Effects: 
##                   Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## bwt_Intercept         6.18      0.22     5.81     6.66 1.01      421      413
## tarsus_Intercept     20.24      0.55    19.12    21.25 1.01      497      527
## bwt_sex2              2.11      0.24     1.61     2.57 1.01      541      569
## sigma_bwt_sex1        0.27      0.20    -0.16     0.56 1.08       18       66
## sigma_bwt_sex2        0.31      0.23    -0.35     0.59 1.11       18       22
## tarsus_sex2           0.29      0.63    -0.96     1.56 1.00      490      535
## sigma_tarsus_sex1     1.26      0.12     1.01     1.47 1.02       50      109
## sigma_tarsus_sex2     1.28      0.20     0.80     1.53 1.13       12       42
## 
## Residual Correlations: 
##                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## rescor(bwt,tarsus)     0.88      0.05     0.71     0.95 1.32        5       33
## 
## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<div class="sourceCode" id="cb565"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb565-1"><a href="brms-2.html#cb565-1" aria-hidden="true"></a><span class="kw">plot</span>(brms_m2<span class="fl">.5</span>, <span class="dt">ask =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p><img src="wam_tuto_files/figure-html/unnamed-chunk-164-1.svg" width="672" /><img src="wam_tuto_files/figure-html/unnamed-chunk-164-2.svg" width="672" /><img src="wam_tuto_files/figure-html/unnamed-chunk-164-3.svg" width="672" /><img src="wam_tuto_files/figure-html/unnamed-chunk-164-4.svg" width="672" /><img src="wam_tuto_files/figure-html/unnamed-chunk-164-5.svg" width="672" /><img src="wam_tuto_files/figure-html/unnamed-chunk-164-6.svg" width="672" /><img src="wam_tuto_files/figure-html/unnamed-chunk-164-7.svg" width="672" /><img src="wam_tuto_files/figure-html/unnamed-chunk-164-8.svg" width="672" /></p>
<div class="sourceCode" id="cb566"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb566-1"><a href="brms-2.html#cb566-1" aria-hidden="true"></a><span class="kw">VarCorr</span>(brms_m2<span class="fl">.5</span>)</span></code></pre></div>
<pre><code>## $animal
## $animal$sd
##             Estimate Est.Error      Q2.5    Q97.5
## bwt_sex1    1.256797 0.3027123 0.6293789 1.733715
## bwt_sex2    1.077842 0.4168427 0.1958640 1.767136
## tarsus_sex1 2.259727 0.7239967 0.6135135 3.567762
## tarsus_sex2 2.744785 1.0537686 0.6051135 4.468542
## 
## $animal$cor
## , , bwt_sex1
## 
##              Estimate Est.Error        Q2.5     Q97.5
## bwt_sex1    1.0000000 0.0000000  1.00000000 1.0000000
## bwt_sex2    0.4823461 0.2872049 -0.23539931 0.8699222
## tarsus_sex1 0.5711397 0.2473353 -0.06616842 0.8936581
## tarsus_sex2 0.1685774 0.3102320 -0.48914110 0.7539686
## 
## , , bwt_sex2
## 
##              Estimate Est.Error       Q2.5     Q97.5
## bwt_sex1    0.4823461 0.2872049 -0.2353993 0.8699222
## bwt_sex2    1.0000000 0.0000000  1.0000000 1.0000000
## tarsus_sex1 0.3772862 0.3765302 -0.5312556 0.9085651
## tarsus_sex2 0.5246223 0.3336679 -0.3678213 0.8692250
## 
## , , tarsus_sex1
## 
##              Estimate Est.Error        Q2.5     Q97.5
## bwt_sex1    0.5711397 0.2473353 -0.06616842 0.8936581
## bwt_sex2    0.3772862 0.3765302 -0.53125561 0.9085651
## tarsus_sex1 1.0000000 0.0000000  1.00000000 1.0000000
## tarsus_sex2 0.4401433 0.2929178 -0.29616405 0.8720453
## 
## , , tarsus_sex2
## 
##              Estimate Est.Error       Q2.5     Q97.5
## bwt_sex1    0.1685774 0.3102320 -0.4891411 0.7539686
## bwt_sex2    0.5246223 0.3336679 -0.3678213 0.8692250
## tarsus_sex1 0.4401433 0.2929178 -0.2961641 0.8720453
## tarsus_sex2 1.0000000 0.0000000  1.0000000 1.0000000
## 
## 
## $animal$cov
## , , bwt_sex1
## 
##              Estimate Est.Error        Q2.5    Q97.5
## bwt_sex1    1.6710810 0.7317405  0.39611874 3.005768
## bwt_sex2    0.7428820 0.5579922 -0.10600955 2.049110
## tarsus_sex1 1.8733421 1.2159805 -0.05815667 4.340959
## tarsus_sex2 0.6471034 1.0646022 -1.25297349 2.930019
## 
## , , bwt_sex2
## 
##             Estimate Est.Error        Q2.5    Q97.5
## bwt_sex1    0.742882 0.5579922 -0.10600955 2.049110
## bwt_sex2    1.335327 0.8557561  0.03836336 3.122771
## tarsus_sex1 1.105102 1.0991534 -0.68104784 3.388813
## tarsus_sex2 2.171388 1.8198507 -0.18718074 5.946047
## 
## , , tarsus_sex1
## 
##             Estimate Est.Error        Q2.5     Q97.5
## bwt_sex1    1.873342  1.215980 -0.05815667  4.340959
## bwt_sex2    1.105102  1.099153 -0.68104784  3.388813
## tarsus_sex1 5.630014  3.143741  0.37639882 12.728924
## tarsus_sex2 3.150235  2.476892 -0.67170548  8.755673
## 
## , , tarsus_sex2
## 
##              Estimate Est.Error       Q2.5     Q97.5
## bwt_sex1    0.6471034  1.064602 -1.2529735  2.930019
## bwt_sex2    2.1713876  1.819851 -0.1871807  5.946047
## tarsus_sex1 3.1502347  2.476892 -0.6717055  8.755673
## tarsus_sex2 8.6431609  5.649764  0.3661935 19.967865
## 
## 
## 
## $byear
## $byear$sd
##              Estimate Est.Error      Q2.5    Q97.5
## bwt_sex1    0.7989572 0.1620838 0.5318383 1.156162
## bwt_sex2    1.1420876 0.1912205 0.8090083 1.549360
## tarsus_sex1 2.2286834 0.4609182 1.4995560 3.183107
## tarsus_sex2 2.3428101 0.4941316 1.5596304 3.405106
## 
## $byear$cor
## , , bwt_sex1
## 
##               Estimate Est.Error       Q2.5     Q97.5
## bwt_sex1     1.0000000 0.0000000  1.0000000 1.0000000
## bwt_sex2     0.7404024 0.1542690  0.3534945 0.9558481
## tarsus_sex1 -0.1137836 0.2357386 -0.5534464 0.3543949
## tarsus_sex2  0.2922708 0.2345550 -0.1749420 0.7113421
## 
## , , bwt_sex2
## 
##               Estimate Est.Error       Q2.5       Q97.5
## bwt_sex1     0.7404024 0.1542690  0.3534945 0.955848060
## bwt_sex2     1.0000000 0.0000000  1.0000000 1.000000000
## tarsus_sex1 -0.3874250 0.1987378 -0.7323699 0.004258363
## tarsus_sex2  0.2937354 0.2059346 -0.1577533 0.659531338
## 
## , , tarsus_sex1
## 
##               Estimate Est.Error       Q2.5       Q97.5
## bwt_sex1    -0.1137836 0.2357386 -0.5534464 0.354394929
## bwt_sex2    -0.3874250 0.1987378 -0.7323699 0.004258363
## tarsus_sex1  1.0000000 0.0000000  1.0000000 1.000000000
## tarsus_sex2  0.5226217 0.1897518  0.1183176 0.839911077
## 
## , , tarsus_sex2
## 
##              Estimate Est.Error       Q2.5     Q97.5
## bwt_sex1    0.2922708 0.2345550 -0.1749420 0.7113421
## bwt_sex2    0.2937354 0.2059346 -0.1577533 0.6595313
## tarsus_sex1 0.5226217 0.1897518  0.1183176 0.8399111
## tarsus_sex2 1.0000000 0.0000000  1.0000000 1.0000000
## 
## 
## $byear$cov
## , , bwt_sex1
## 
##               Estimate Est.Error       Q2.5     Q97.5
## bwt_sex1     0.6645776 0.2761781  0.2828520 1.3367115
## bwt_sex2     0.6843681 0.2597687  0.2749460 1.2955568
## tarsus_sex1 -0.1581409 0.4589758 -1.0281983 0.8339776
## tarsus_sex2  0.5456796 0.5013040 -0.3608892 1.5951028
## 
## , , bwt_sex2
## 
##               Estimate Est.Error       Q2.5       Q97.5
## bwt_sex1     0.6843681 0.2597687  0.2749460 1.295556807
## bwt_sex2     1.3408929 0.4593417  0.6544951 2.400516888
## tarsus_sex1 -1.0167438 0.6693667 -2.4775184 0.009371017
## tarsus_sex2  0.8646682 0.7242669 -0.3384814 2.623722863
## 
## , , tarsus_sex1
## 
##               Estimate Est.Error       Q2.5        Q97.5
## bwt_sex1    -0.1581409 0.4589758 -1.0281983  0.833977585
## bwt_sex2    -1.0167438 0.6693667 -2.4775184  0.009371017
## tarsus_sex1  5.1792626 2.3047474  2.2486683 10.132170288
## tarsus_sex2  2.7818157 1.5318128  0.5297591  5.970346660
## 
## , , tarsus_sex2
## 
##              Estimate Est.Error       Q2.5     Q97.5
## bwt_sex1    0.5456796 0.5013040 -0.3608892  1.595103
## bwt_sex2    0.8646682 0.7242669 -0.3384814  2.623723
## tarsus_sex1 2.7818157 1.5318128  0.5297591  5.970347
## tarsus_sex2 5.7326811 2.5639312  2.4324504 11.594758
## 
## 
## 
## $mother
## $mother$sd
##             Estimate Est.Error      Q2.5    Q97.5
## bwt_sex1    1.076447 0.1526711 0.7866154 1.390273
## bwt_sex2    1.325206 0.1540539 1.0256350 1.621175
## tarsus_sex1 2.214033 0.3976449 1.3647309 2.946910
## tarsus_sex2 2.310902 0.4940802 1.3795156 3.339175
## 
## $mother$cor
## , , bwt_sex1
## 
##               Estimate Est.Error       Q2.5       Q97.5
## bwt_sex1     1.0000000 0.0000000  1.0000000  1.00000000
## bwt_sex2     0.8260360 0.1110784  0.5676601  0.97826511
## tarsus_sex1 -0.5024557 0.2385053 -0.9137423 -0.06798800
## tarsus_sex2 -0.5073494 0.2162931 -0.8806394 -0.07677131
## 
## , , bwt_sex2
## 
##               Estimate Est.Error       Q2.5      Q97.5
## bwt_sex1     0.8260360 0.1110784  0.5676601  0.9782651
## bwt_sex2     1.0000000 0.0000000  1.0000000  1.0000000
## tarsus_sex1 -0.6373889 0.1744852 -0.9272366 -0.2775698
## tarsus_sex2 -0.3593672 0.2577845 -0.8364419  0.1135921
## 
## , , tarsus_sex1
## 
##               Estimate Est.Error       Q2.5      Q97.5
## bwt_sex1    -0.5024557 0.2385053 -0.9137423 -0.0679880
## bwt_sex2    -0.6373889 0.1744852 -0.9272366 -0.2775698
## tarsus_sex1  1.0000000 0.0000000  1.0000000  1.0000000
## tarsus_sex2  0.7206209 0.1561300  0.3688228  0.9518425
## 
## , , tarsus_sex2
## 
##               Estimate Est.Error       Q2.5       Q97.5
## bwt_sex1    -0.5073494 0.2162931 -0.8806394 -0.07677131
## bwt_sex2    -0.3593672 0.2577845 -0.8364419  0.11359208
## tarsus_sex1  0.7206209 0.1561300  0.3688228  0.95184250
## tarsus_sex2  1.0000000 0.0000000  1.0000000  1.00000000
## 
## 
## $mother$cov
## , , bwt_sex1
## 
##              Estimate Est.Error       Q2.5      Q97.5
## bwt_sex1     1.182023 0.3330334  0.6187659  1.9328578
## bwt_sex2     1.179468 0.2744898  0.6821359  1.7479435
## tarsus_sex1 -1.110068 0.4557029 -1.9379754 -0.2103052
## tarsus_sex2 -1.223308 0.5582766 -2.3558658 -0.1900476
## 
## , , bwt_sex2
## 
##               Estimate Est.Error       Q2.5      Q97.5
## bwt_sex1     1.1794683 0.2744898  0.6821359  1.7479435
## bwt_sex2     1.7798788 0.4088241  1.0519272  2.6282093
## tarsus_sex1 -1.8437371 0.5678929 -2.9129058 -0.7723013
## tarsus_sex2 -0.9438083 0.6393327 -2.0044262  0.4581811
## 
## , , tarsus_sex1
## 
##              Estimate Est.Error      Q2.5      Q97.5
## bwt_sex1    -1.110068 0.4557029 -1.937975 -0.2103052
## bwt_sex2    -1.843737 0.5678929 -2.912906 -0.7723013
## tarsus_sex1  5.059904 1.7495725  1.862491  8.6842757
## tarsus_sex2  3.692391 1.3309441  1.432767  6.5202798
## 
## , , tarsus_sex2
## 
##               Estimate Est.Error      Q2.5      Q97.5
## bwt_sex1    -1.2233079 0.5582766 -2.355866 -0.1900476
## bwt_sex2    -0.9438083 0.6393327 -2.004426  0.4581811
## tarsus_sex1  3.6923914 1.3309441  1.432767  6.5202798
## tarsus_sex2  5.5841373 2.3245515  1.903063 11.1500916</code></pre>
<p>The cross-sex genetic correlation can estimate form the output of the model.
For tarsus length at fledging, sexes shared a lot of genetic variance which is commun for a trait with low sexual dimorphism.
If the selection is antagonistic between males and females, sexes can not evolve freely from the other sexes and a intralocus sexual conflict can appeared.</p>
<div class="sourceCode" id="cb568"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb568-1"><a href="brms-2.html#cb568-1" aria-hidden="true"></a>cross_sex.cor.btw &lt;-<span class="st"> </span><span class="kw">as.mcmc</span>((<span class="kw">VarCorr</span>(brms_m2<span class="fl">.5</span>, <span class="dt">summary =</span> <span class="ot">FALSE</span>)<span class="op">$</span>animal<span class="op">$</span>cor[, <span class="dv">1</span>, <span class="dv">2</span>]))</span>
<span id="cb568-2"><a href="brms-2.html#cb568-2" aria-hidden="true"></a>cross_sex.cor.tarsus &lt;-<span class="st"> </span><span class="kw">as.mcmc</span>((<span class="kw">VarCorr</span>(brms_m2<span class="fl">.5</span>, <span class="dt">summary =</span> <span class="ot">FALSE</span>)<span class="op">$</span>animal<span class="op">$</span>cor[, <span class="dv">3</span>, <span class="dv">4</span>]))</span>
<span id="cb568-3"><a href="brms-2.html#cb568-3" aria-hidden="true"></a></span>
<span id="cb568-4"><a href="brms-2.html#cb568-4" aria-hidden="true"></a><span class="kw">summary</span>(cross_sex.cor.btw)</span></code></pre></div>
<pre><code>## 
## Iterations = 1:1000
## Thinning interval = 1 
## Number of chains = 1 
## Sample size per chain = 1000 
## 
## 1. Empirical mean and standard deviation for each variable,
##    plus standard error of the mean:
## 
##           Mean             SD       Naive SE Time-series SE 
##       0.482346       0.287205       0.009082       0.032430 
## 
## 2. Quantiles for each variable:
## 
##    2.5%     25%     50%     75%   97.5% 
## -0.2354  0.3433  0.5365  0.6861  0.8699</code></pre>
<div class="sourceCode" id="cb570"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb570-1"><a href="brms-2.html#cb570-1" aria-hidden="true"></a><span class="kw">summary</span>(cross_sex.cor.tarsus)</span></code></pre></div>
<pre><code>## 
## Iterations = 1:1000
## Thinning interval = 1 
## Number of chains = 1 
## Sample size per chain = 1000 
## 
## 1. Empirical mean and standard deviation for each variable,
##    plus standard error of the mean:
## 
##           Mean             SD       Naive SE Time-series SE 
##       0.440143       0.292918       0.009263       0.048863 
## 
## 2. Quantiles for each variable:
## 
##    2.5%     25%     50%     75%   97.5% 
## -0.2962  0.2950  0.4846  0.6419  0.8720</code></pre>
<div class="sourceCode" id="cb572"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb572-1"><a href="brms-2.html#cb572-1" aria-hidden="true"></a><span class="kw">plot</span>(cross_sex.cor.btw)</span></code></pre></div>
<p><img src="wam_tuto_files/figure-html/unnamed-chunk-165-1.svg" width="672" /></p>
<div class="sourceCode" id="cb573"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb573-1"><a href="brms-2.html#cb573-1" aria-hidden="true"></a><span class="kw">plot</span>(cross_sex.cor.tarsus)</span></code></pre></div>
<p><img src="wam_tuto_files/figure-html/unnamed-chunk-165-2.svg" width="672" /></p>
<p>Here, some simple code to extract the BLUP.</p>
<div class="sourceCode" id="cb574"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb574-1"><a href="brms-2.html#cb574-1" aria-hidden="true"></a>bls_m2<span class="fl">.5</span> &lt;-<span class="st"> </span><span class="kw">ranef</span>(brms_m2<span class="fl">.5</span>)<span class="op">$</span>animal</span>
<span id="cb574-2"><a href="brms-2.html#cb574-2" aria-hidden="true"></a>bl_m2<span class="fl">.5</span> &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(abind<span class="op">::</span><span class="kw">abind</span>(<span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="cf">function</span>(x) bls_m2<span class="fl">.5</span>[, <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">4</span>), x])))</span>
<span id="cb574-3"><a href="brms-2.html#cb574-3" aria-hidden="true"></a><span class="kw">colnames</span>(bl_m2<span class="fl">.5</span>) &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">rep</span>(<span class="kw">dimnames</span>(bls_m2<span class="fl">.5</span>)[[<span class="dv">3</span>]], <span class="dt">each =</span> <span class="dv">3</span>), <span class="kw">c</span>(<span class="st">&quot;&quot;</span>, <span class="st">&quot;_lo&quot;</span>, <span class="st">&quot;_up&quot;</span>))</span>
<span id="cb574-4"><a href="brms-2.html#cb574-4" aria-hidden="true"></a>bl_m2<span class="fl">.5</span><span class="op">$</span>id &lt;-<span class="st"> </span><span class="kw">rownames</span>(bl_m2<span class="fl">.5</span>)</span></code></pre></div>
<p>Here, some simple code to plot the cross-sex genetic correlation.</p>
<div class="sourceCode" id="cb575"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb575-1"><a href="brms-2.html#cb575-1" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb575-2"><a href="brms-2.html#cb575-2" aria-hidden="true"></a><span class="kw">plot</span>(bwt_sex2 <span class="op">~</span><span class="st"> </span>bwt_sex1, bl_m2<span class="fl">.5</span>,</span>
<span id="cb575-3"><a href="brms-2.html#cb575-3" aria-hidden="true"></a>  <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">las =</span> <span class="fl">1.2</span>, <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>,</span>
<span id="cb575-4"><a href="brms-2.html#cb575-4" aria-hidden="true"></a>  <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="kw">min</span>(bl_m2<span class="fl">.5</span><span class="op">$</span>bwt_sex1_lo), <span class="kw">max</span>(bl_m2<span class="fl">.5</span><span class="op">$</span>bwt_sex1_up)),</span>
<span id="cb575-5"><a href="brms-2.html#cb575-5" aria-hidden="true"></a>  <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="kw">min</span>(bl_m2<span class="fl">.5</span><span class="op">$</span>bwt_sex2_lo), <span class="kw">max</span>(bl_m2<span class="fl">.5</span><span class="op">$</span>bwt_sex2_up))</span>
<span id="cb575-6"><a href="brms-2.html#cb575-6" aria-hidden="true"></a>)</span>
<span id="cb575-7"><a href="brms-2.html#cb575-7" aria-hidden="true"></a><span class="kw">with</span>(bl_m2<span class="fl">.5</span>, <span class="kw">segments</span>(<span class="dt">x0 =</span> bwt_sex1, <span class="dt">y0 =</span> bwt_sex2_lo, <span class="dt">x1 =</span> bwt_sex1, <span class="dt">y1 =</span> bwt_sex2_up, <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>))</span>
<span id="cb575-8"><a href="brms-2.html#cb575-8" aria-hidden="true"></a><span class="kw">with</span>(bl_m2<span class="fl">.5</span>, <span class="kw">segments</span>(<span class="dt">x0 =</span> bwt_sex1_lo, <span class="dt">y0 =</span> bwt_sex2, <span class="dt">x1 =</span> bwt_sex1_up, <span class="dt">y1 =</span> bwt_sex2, <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>))</span>
<span id="cb575-9"><a href="brms-2.html#cb575-9" aria-hidden="true"></a><span class="kw">points</span>(bwt_sex2 <span class="op">~</span><span class="st"> </span>bwt_sex1, bl_m2<span class="fl">.5</span>, <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">cex =</span> <span class="fl">1.5</span>)</span>
<span id="cb575-10"><a href="brms-2.html#cb575-10" aria-hidden="true"></a><span class="kw">points</span>(bwt_sex2 <span class="op">~</span><span class="st"> </span>bwt_sex1, bl_m2<span class="fl">.5</span>, <span class="dt">pch =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="kw">rgb</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.3</span>), <span class="dt">cex =</span> <span class="kw">c</span>(<span class="fl">1.5</span>))</span>
<span id="cb575-11"><a href="brms-2.html#cb575-11" aria-hidden="true"></a><span class="kw">mtext</span>(<span class="st">&quot;bwt male (BV±CI)&quot;</span>, <span class="dt">side =</span> <span class="dv">1</span>, <span class="dt">line =</span> <span class="fl">2.4</span>)</span>
<span id="cb575-12"><a href="brms-2.html#cb575-12" aria-hidden="true"></a><span class="kw">mtext</span>(<span class="st">&quot;bwt female (BV±CI)&quot;</span>, <span class="dt">side =</span> <span class="dv">2</span>, <span class="dt">line =</span> <span class="dv">2</span>, <span class="dt">las =</span> <span class="dv">3</span>)</span>
<span id="cb575-13"><a href="brms-2.html#cb575-13" aria-hidden="true"></a></span>
<span id="cb575-14"><a href="brms-2.html#cb575-14" aria-hidden="true"></a><span class="kw">plot</span>(tarsus_sex2 <span class="op">~</span><span class="st"> </span>tarsus_sex1, bl_m2<span class="fl">.5</span>,</span>
<span id="cb575-15"><a href="brms-2.html#cb575-15" aria-hidden="true"></a>  <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">las =</span> <span class="fl">1.2</span>, <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>,</span>
<span id="cb575-16"><a href="brms-2.html#cb575-16" aria-hidden="true"></a>  <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="kw">min</span>(bl_m2<span class="fl">.5</span><span class="op">$</span>tarsus_sex1_lo), <span class="kw">max</span>(bl_m2<span class="fl">.5</span><span class="op">$</span>tarsus_sex1_up)),</span>
<span id="cb575-17"><a href="brms-2.html#cb575-17" aria-hidden="true"></a>  <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="kw">min</span>(bl_m2<span class="fl">.5</span><span class="op">$</span>tarsus_sex2_lo), <span class="kw">max</span>(bl_m2<span class="fl">.5</span><span class="op">$</span>tarsus_sex2_up))</span>
<span id="cb575-18"><a href="brms-2.html#cb575-18" aria-hidden="true"></a>)</span>
<span id="cb575-19"><a href="brms-2.html#cb575-19" aria-hidden="true"></a><span class="kw">with</span>(bl_m2<span class="fl">.5</span>, <span class="kw">segments</span>(<span class="dt">x0 =</span> tarsus_sex1, <span class="dt">y0 =</span> tarsus_sex2_lo, <span class="dt">x1 =</span> tarsus_sex1, <span class="dt">y1 =</span> tarsus_sex2_up, <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>))</span>
<span id="cb575-20"><a href="brms-2.html#cb575-20" aria-hidden="true"></a><span class="kw">with</span>(bl_m2<span class="fl">.5</span>, <span class="kw">segments</span>(<span class="dt">x0 =</span> tarsus_sex1_lo, <span class="dt">y0 =</span> tarsus_sex2, <span class="dt">x1 =</span> tarsus_sex1_up, <span class="dt">y1 =</span> tarsus_sex2, <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>))</span>
<span id="cb575-21"><a href="brms-2.html#cb575-21" aria-hidden="true"></a><span class="kw">points</span>(tarsus_sex2 <span class="op">~</span><span class="st"> </span>tarsus_sex1, bl_m2<span class="fl">.5</span>, <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">cex =</span> <span class="fl">1.5</span>)</span>
<span id="cb575-22"><a href="brms-2.html#cb575-22" aria-hidden="true"></a><span class="kw">points</span>(tarsus_sex2 <span class="op">~</span><span class="st"> </span>tarsus_sex1, bl_m2<span class="fl">.5</span>, <span class="dt">pch =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="kw">rgb</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.3</span>), <span class="dt">cex =</span> <span class="kw">c</span>(<span class="fl">1.5</span>))</span>
<span id="cb575-23"><a href="brms-2.html#cb575-23" aria-hidden="true"></a><span class="kw">mtext</span>(<span class="st">&quot;tarsus male (BV±CI)&quot;</span>, <span class="dt">side =</span> <span class="dv">1</span>, <span class="dt">line =</span> <span class="fl">2.4</span>)</span>
<span id="cb575-24"><a href="brms-2.html#cb575-24" aria-hidden="true"></a><span class="kw">mtext</span>(<span class="st">&quot;tarsus female (BV±CI)&quot;</span>, <span class="dt">side =</span> <span class="dv">2</span>, <span class="dt">line =</span> <span class="dv">2</span>, <span class="dt">las =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="wam_tuto_files/figure-html/unnamed-chunk-167-1.svg" width="672" /></p>
<p>Within this model, we also have acces to the rest of the B-matrix. Note, the cross-sex genetic correlation is just the diagonal of the B matrix. For now on, you can explore this matrix and estimate the cross-sex-cross-trait genetic correlation.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="mcmcglmm-2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="stan-1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/JulienGAMartin/wam_tuto/edit/master/03_04-biv_brms.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["wam_tuto.pdf", "wam_tuto.epub", "wam_tuto.mobi"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection",
"scroll_highlight": true
},
"toc_depth": 4
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
