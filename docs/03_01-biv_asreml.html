<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.550">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Julien Martin">
<meta name="description" content="Tutorial on how to fit an animal model using multiple R packages. Updated and extended tutorials from An ecologist guide to animal model (Wilson et al. 2010).">
<title>How to fit an animal model - 7&nbsp; Asreml-R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./03_02-biv_gremlin.html" rel="next">
<link href="./03_00-biv.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-LLHQEESR2L"></script><script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-LLHQEESR2L', { 'anonymize_ip': true});
</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script><link rel="stylesheet" href="css/style.css">
</head>
<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Wam tutorial</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-extra-resources" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Extra resources</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-extra-resources">
<li>
    <a class="dropdown-item" href="https://wildanimalmodels.org/">
 <span class="dropdown-text">WamWiki</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://devillemereuil.legtux.org/downloads/">
 <span class="dropdown-text">Tutorials by P de Vilemereuil</span></a>
  </li>  
    </ul>
</li>
</ul>
</div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools tools-wide">
    <a href="https://github.com/juliengamartin/wam_tuto/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="./How-to-fit-an-animal-model.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./03_00-biv.html">Multivariate animal model</a></li><li class="breadcrumb-item"><a href="./03_01-biv_asreml.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Asreml-R</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./02_00-univ.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Univariate animal model</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_01-univ_asreml.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Asreml-R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_02-univ_gremlin.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">gremlin</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_03-univ_mcmcglmm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">MCMCglmm</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_04-univ_brms.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">brms</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_05-univ_stan.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">stan</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./03_00-biv.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multivariate animal model</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_01-biv_asreml.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Asreml-R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_02-biv_gremlin.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">gremlin</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_03-biv_mcmcglmm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">MCMCglmm</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_04-biv_brms.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">brms</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_05-biv_stan.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">stan</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./04_00-rep.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A repeated measures animal model</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_01-rep_asreml.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Asreml-R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_02-rep_gremlin.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">gremlin</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_03-rep_mcmcglmm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">MCMCglmm</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_04-rep_brms.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">brms</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_05-rep_stan.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">stan</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_code_cheatsheet.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Quick comparison of codes</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./98_references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#running-the-model" id="toc-running-the-model" class="nav-link active" data-scroll-target="#running-the-model"><span class="header-section-number">7.0.1</span> Running the model</a></li>
  <li><a href="#adding-fixed-and-random-effects" id="toc-adding-fixed-and-random-effects" class="nav-link" data-scroll-target="#adding-fixed-and-random-effects"><span class="header-section-number">7.0.2</span> Adding fixed and random effects</a></li>
  <li><a href="#significance-testing" id="toc-significance-testing" class="nav-link" data-scroll-target="#significance-testing"><span class="header-section-number">7.0.3</span> Significance testing</a></li>
  <li><a href="#estimate-directly-the-genetic-correlation-within-the-model" id="toc-estimate-directly-the-genetic-correlation-within-the-model" class="nav-link" data-scroll-target="#estimate-directly-the-genetic-correlation-within-the-model"><span class="header-section-number">7.0.4</span> Estimate directly the genetic correlation within the model</a></li>
  <li><a href="#visualisation-of-the-correlation-aka-blup-extraction" id="toc-visualisation-of-the-correlation-aka-blup-extraction" class="nav-link" data-scroll-target="#visualisation-of-the-correlation-aka-blup-extraction"><span class="header-section-number">7.0.5</span> Visualisation of the correlation (aka BLUP extraction)</a></li>
  <li><a href="#partitionning-covariance-between-groups" id="toc-partitionning-covariance-between-groups" class="nav-link" data-scroll-target="#partitionning-covariance-between-groups"><span class="header-section-number">7.0.6</span> Partitionning (co)variance between groups</a></li>
  <li><a href="#between-groups-covariances-and-the-b-matrix" id="toc-between-groups-covariances-and-the-b-matrix" class="nav-link" data-scroll-target="#between-groups-covariances-and-the-b-matrix"><span class="header-section-number">7.0.7</span> Between groups (co)variances and the B-matrix</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/juliengamartin/wam_tuto/edit/main/03_01-biv_asreml.Rmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/juliengamartin/wam_tuto/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./03_00-biv.html">Multivariate animal model</a></li><li class="breadcrumb-item"><a href="./03_01-biv_asreml.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Asreml-R</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title"><span id="asreml-biv" class="quarto-section-identifier"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Asreml-R</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>       id father mother
1    1306   &lt;NA&gt;   &lt;NA&gt;
2    1304   &lt;NA&gt;   &lt;NA&gt;
3    1298   &lt;NA&gt;   &lt;NA&gt;
4    1293   &lt;NA&gt;   &lt;NA&gt;
5    1290   &lt;NA&gt;   &lt;NA&gt;
6    1288   &lt;NA&gt;   &lt;NA&gt;
7    1284   &lt;NA&gt;   &lt;NA&gt;
8    1283   &lt;NA&gt;   &lt;NA&gt;
9    1282   &lt;NA&gt;   &lt;NA&gt;
10   1278   &lt;NA&gt;   &lt;NA&gt;
11   1276   &lt;NA&gt;   &lt;NA&gt;
12   1263   &lt;NA&gt;   &lt;NA&gt;
13   1260   &lt;NA&gt;   &lt;NA&gt;
14   1257   &lt;NA&gt;   &lt;NA&gt;
15   1252   &lt;NA&gt;   &lt;NA&gt;
16   1251   &lt;NA&gt;   &lt;NA&gt;
17   1243   &lt;NA&gt;   &lt;NA&gt;
18   1237   &lt;NA&gt;   &lt;NA&gt;
19   1235   &lt;NA&gt;   &lt;NA&gt;
20   1232   &lt;NA&gt;   &lt;NA&gt;
21   1229   &lt;NA&gt;   &lt;NA&gt;
22   1227   &lt;NA&gt;   &lt;NA&gt;
23   1224   &lt;NA&gt;   &lt;NA&gt;
24   1220   &lt;NA&gt;   &lt;NA&gt;
25   1219   &lt;NA&gt;   &lt;NA&gt;
26   1216   &lt;NA&gt;   &lt;NA&gt;
27   1214   &lt;NA&gt;   &lt;NA&gt;
28   1211   &lt;NA&gt;   &lt;NA&gt;
29   1195   &lt;NA&gt;   &lt;NA&gt;
30   1186   &lt;NA&gt;   &lt;NA&gt;
31   1184   &lt;NA&gt;   &lt;NA&gt;
32   1174   &lt;NA&gt;   &lt;NA&gt;
33   1150   &lt;NA&gt;   &lt;NA&gt;
34   1146   &lt;NA&gt;   &lt;NA&gt;
35   1145   &lt;NA&gt;   &lt;NA&gt;
36   1140   &lt;NA&gt;   &lt;NA&gt;
37   1137   &lt;NA&gt;   &lt;NA&gt;
38   1128   &lt;NA&gt;   &lt;NA&gt;
39   1126   &lt;NA&gt;   &lt;NA&gt;
40   1117   &lt;NA&gt;   &lt;NA&gt;
41   1116   &lt;NA&gt;   &lt;NA&gt;
42   1113   &lt;NA&gt;   &lt;NA&gt;
43   1112   &lt;NA&gt;   &lt;NA&gt;
44   1108   &lt;NA&gt;   &lt;NA&gt;
45   1107   &lt;NA&gt;   &lt;NA&gt;
46   1097   &lt;NA&gt;   &lt;NA&gt;
47   1091   &lt;NA&gt;   &lt;NA&gt;
48   1089   &lt;NA&gt;   &lt;NA&gt;
49   1087   &lt;NA&gt;   &lt;NA&gt;
50   1085   &lt;NA&gt;   &lt;NA&gt;
51   1084   &lt;NA&gt;   &lt;NA&gt;
52   1078   &lt;NA&gt;   &lt;NA&gt;
53   1077   &lt;NA&gt;   &lt;NA&gt;
54   1076   &lt;NA&gt;   &lt;NA&gt;
55   1075   &lt;NA&gt;   &lt;NA&gt;
56   1072   &lt;NA&gt;   &lt;NA&gt;
57   1065   &lt;NA&gt;   &lt;NA&gt;
58   1042   &lt;NA&gt;   &lt;NA&gt;
59   1033   &lt;NA&gt;   &lt;NA&gt;
60   1030   &lt;NA&gt;   &lt;NA&gt;
61   1025   &lt;NA&gt;   &lt;NA&gt;
62   1011   &lt;NA&gt;   &lt;NA&gt;
63   1010   &lt;NA&gt;   &lt;NA&gt;
64   1007   &lt;NA&gt;   &lt;NA&gt;
65   1005   &lt;NA&gt;   &lt;NA&gt;
66    997   &lt;NA&gt;   &lt;NA&gt;
67    991   &lt;NA&gt;   &lt;NA&gt;
68    990   &lt;NA&gt;   &lt;NA&gt;
69    979   &lt;NA&gt;   &lt;NA&gt;
70    977   &lt;NA&gt;   &lt;NA&gt;
71    976   &lt;NA&gt;   &lt;NA&gt;
72    968   &lt;NA&gt;   &lt;NA&gt;
73    956   &lt;NA&gt;   &lt;NA&gt;
74    955   &lt;NA&gt;   &lt;NA&gt;
75    953   &lt;NA&gt;   &lt;NA&gt;
76    952   &lt;NA&gt;   &lt;NA&gt;
77    950   &lt;NA&gt;   &lt;NA&gt;
78    942   &lt;NA&gt;   &lt;NA&gt;
79    934   &lt;NA&gt;   &lt;NA&gt;
80    926   &lt;NA&gt;   &lt;NA&gt;
81    922   &lt;NA&gt;   &lt;NA&gt;
82    909   &lt;NA&gt;   &lt;NA&gt;
83    908   &lt;NA&gt;   &lt;NA&gt;
84    895   &lt;NA&gt;   &lt;NA&gt;
85    893   &lt;NA&gt;   &lt;NA&gt;
86    884   &lt;NA&gt;   &lt;NA&gt;
87    883   &lt;NA&gt;   &lt;NA&gt;
88    882   &lt;NA&gt;   &lt;NA&gt;
89    873   &lt;NA&gt;   &lt;NA&gt;
90    869   &lt;NA&gt;   &lt;NA&gt;
91    868   &lt;NA&gt;   &lt;NA&gt;
92    866   &lt;NA&gt;   &lt;NA&gt;
93    863   &lt;NA&gt;   &lt;NA&gt;
94    862   &lt;NA&gt;   &lt;NA&gt;
95    855   &lt;NA&gt;   &lt;NA&gt;
96    854   &lt;NA&gt;   &lt;NA&gt;
97    853   &lt;NA&gt;   &lt;NA&gt;
98    842   &lt;NA&gt;   &lt;NA&gt;
99    821   &lt;NA&gt;   &lt;NA&gt;
100   812   &lt;NA&gt;   &lt;NA&gt;
101   811   &lt;NA&gt;   &lt;NA&gt;
102   796   &lt;NA&gt;   &lt;NA&gt;
103   792   &lt;NA&gt;   &lt;NA&gt;
104   791   &lt;NA&gt;   &lt;NA&gt;
105   775   &lt;NA&gt;   &lt;NA&gt;
106   772   &lt;NA&gt;   &lt;NA&gt;
107   771   &lt;NA&gt;   &lt;NA&gt;
108   768   &lt;NA&gt;   &lt;NA&gt;
109   765   &lt;NA&gt;   &lt;NA&gt;
110   761   &lt;NA&gt;   &lt;NA&gt;
111   745   &lt;NA&gt;   &lt;NA&gt;
112   742   &lt;NA&gt;   &lt;NA&gt;
113   740   &lt;NA&gt;   &lt;NA&gt;
114   736   &lt;NA&gt;   &lt;NA&gt;
115   710   &lt;NA&gt;   &lt;NA&gt;
116   703   &lt;NA&gt;   &lt;NA&gt;
117   702   &lt;NA&gt;   &lt;NA&gt;
118   701   &lt;NA&gt;   &lt;NA&gt;
119   700   &lt;NA&gt;   &lt;NA&gt;
120   695   &lt;NA&gt;   &lt;NA&gt;
121   692   &lt;NA&gt;   &lt;NA&gt;
122   687   &lt;NA&gt;   &lt;NA&gt;
123   683   &lt;NA&gt;   &lt;NA&gt;
124   677   &lt;NA&gt;   &lt;NA&gt;
125   672   &lt;NA&gt;   &lt;NA&gt;
126   670   &lt;NA&gt;   &lt;NA&gt;
127   666   &lt;NA&gt;   &lt;NA&gt;
128   659   &lt;NA&gt;   &lt;NA&gt;
129   657   &lt;NA&gt;   &lt;NA&gt;
130   652   &lt;NA&gt;   &lt;NA&gt;
131   644   &lt;NA&gt;   &lt;NA&gt;
132   642   &lt;NA&gt;   &lt;NA&gt;
133   641   &lt;NA&gt;   &lt;NA&gt;
134   634   &lt;NA&gt;   &lt;NA&gt;
135   625   &lt;NA&gt;   &lt;NA&gt;
136   623   &lt;NA&gt;   &lt;NA&gt;
137   620   &lt;NA&gt;   &lt;NA&gt;
138   618   &lt;NA&gt;   &lt;NA&gt;
139   617   &lt;NA&gt;   &lt;NA&gt;
140   601   &lt;NA&gt;   &lt;NA&gt;
141   600   &lt;NA&gt;   &lt;NA&gt;
142   587   &lt;NA&gt;   &lt;NA&gt;
143   580   &lt;NA&gt;   &lt;NA&gt;
144   577   &lt;NA&gt;   &lt;NA&gt;
145   573   &lt;NA&gt;   &lt;NA&gt;
146   571   &lt;NA&gt;   &lt;NA&gt;
147   570   &lt;NA&gt;   &lt;NA&gt;
148   566   &lt;NA&gt;   &lt;NA&gt;
149   565   &lt;NA&gt;   &lt;NA&gt;
150   555   &lt;NA&gt;   &lt;NA&gt;
151   554   &lt;NA&gt;   &lt;NA&gt;
152   542   &lt;NA&gt;   &lt;NA&gt;
153   540   &lt;NA&gt;   &lt;NA&gt;
154   539   &lt;NA&gt;   &lt;NA&gt;
155   538   &lt;NA&gt;   &lt;NA&gt;
156   529   &lt;NA&gt;   &lt;NA&gt;
157   527   &lt;NA&gt;   &lt;NA&gt;
158   512   &lt;NA&gt;   &lt;NA&gt;
159   511   &lt;NA&gt;   &lt;NA&gt;
160   504   &lt;NA&gt;   &lt;NA&gt;
161   497   &lt;NA&gt;   &lt;NA&gt;
162   489   &lt;NA&gt;   &lt;NA&gt;
163   485   &lt;NA&gt;   &lt;NA&gt;
164   475   &lt;NA&gt;   &lt;NA&gt;
165   474   &lt;NA&gt;   &lt;NA&gt;
166   473   &lt;NA&gt;   &lt;NA&gt;
167   468   &lt;NA&gt;   &lt;NA&gt;
168   467   &lt;NA&gt;   &lt;NA&gt;
169   465   &lt;NA&gt;   &lt;NA&gt;
170   458   &lt;NA&gt;   &lt;NA&gt;
171   456   &lt;NA&gt;   &lt;NA&gt;
172   451   &lt;NA&gt;   &lt;NA&gt;
173   450   &lt;NA&gt;   &lt;NA&gt;
174   440   &lt;NA&gt;   &lt;NA&gt;
175   438   &lt;NA&gt;   &lt;NA&gt;
176   421   &lt;NA&gt;   &lt;NA&gt;
177   412   &lt;NA&gt;   &lt;NA&gt;
178   393   &lt;NA&gt;   &lt;NA&gt;
179   381   &lt;NA&gt;   &lt;NA&gt;
180   374   &lt;NA&gt;   &lt;NA&gt;
181   354   &lt;NA&gt;   &lt;NA&gt;
182   350   &lt;NA&gt;   &lt;NA&gt;
183   339   &lt;NA&gt;   &lt;NA&gt;
184   331   &lt;NA&gt;   &lt;NA&gt;
185   328   &lt;NA&gt;   &lt;NA&gt;
186   327   &lt;NA&gt;   &lt;NA&gt;
187   323   &lt;NA&gt;   &lt;NA&gt;
188   320   &lt;NA&gt;   &lt;NA&gt;
189   313   &lt;NA&gt;   &lt;NA&gt;
190   299   &lt;NA&gt;   &lt;NA&gt;
191   293   &lt;NA&gt;   &lt;NA&gt;
192   290   &lt;NA&gt;   &lt;NA&gt;
193   273   &lt;NA&gt;   &lt;NA&gt;
194   272   &lt;NA&gt;   &lt;NA&gt;
195   267   &lt;NA&gt;   &lt;NA&gt;
196   266   &lt;NA&gt;   &lt;NA&gt;
197   265   &lt;NA&gt;   &lt;NA&gt;
198   256   &lt;NA&gt;   &lt;NA&gt;
199   252   &lt;NA&gt;   &lt;NA&gt;
200   245   &lt;NA&gt;   &lt;NA&gt;
201   228   &lt;NA&gt;   &lt;NA&gt;
202   215   &lt;NA&gt;   &lt;NA&gt;
203   205   &lt;NA&gt;   &lt;NA&gt;
204   199   &lt;NA&gt;   &lt;NA&gt;
205   196   &lt;NA&gt;   &lt;NA&gt;
206   191   &lt;NA&gt;   &lt;NA&gt;
207   185   &lt;NA&gt;   &lt;NA&gt;
208   174   &lt;NA&gt;   &lt;NA&gt;
209   164   &lt;NA&gt;   &lt;NA&gt;
210   160   &lt;NA&gt;   &lt;NA&gt;
211   143   &lt;NA&gt;   &lt;NA&gt;
212   140   &lt;NA&gt;   &lt;NA&gt;
213   102   &lt;NA&gt;   &lt;NA&gt;
214    92   &lt;NA&gt;   &lt;NA&gt;
215    85   &lt;NA&gt;   &lt;NA&gt;
216    58   &lt;NA&gt;   &lt;NA&gt;
217    46   &lt;NA&gt;   &lt;NA&gt;
218    45   &lt;NA&gt;   &lt;NA&gt;
219    39   &lt;NA&gt;   &lt;NA&gt;
220    31   &lt;NA&gt;   &lt;NA&gt;
221    23   &lt;NA&gt;   &lt;NA&gt;
222    19   &lt;NA&gt;   &lt;NA&gt;
223    18   &lt;NA&gt;   &lt;NA&gt;
224    13   &lt;NA&gt;   &lt;NA&gt;
225     4   &lt;NA&gt;   &lt;NA&gt;
226  1029   &lt;NA&gt;   1145
227  1299   &lt;NA&gt;    811
228   643   &lt;NA&gt;    642
229  1183   &lt;NA&gt;   1186
230  1238   &lt;NA&gt;   1237
231   891   &lt;NA&gt;    895
232  1181   &lt;NA&gt;   1010
233   568   &lt;NA&gt;    761
234  1080   &lt;NA&gt;   1085
235   697   &lt;NA&gt;    701
236  1295   &lt;NA&gt;   1299
237  1182   &lt;NA&gt;   1186
238   585   &lt;NA&gt;    587
239   951   &lt;NA&gt;    956
240  1249   &lt;NA&gt;   1252
241  1144    625   1145
242   564   &lt;NA&gt;    565
243   948   &lt;NA&gt;    950
244  1009   &lt;NA&gt;   1010
245   731    821   1306
246   665    821    666
247   810   &lt;NA&gt;    811
248  1236   &lt;NA&gt;   1237
249  1226   &lt;NA&gt;   1232
250   954    745    956
251   947    745    955
252   537   &lt;NA&gt;    538
253   949    821    950
254  1275   &lt;NA&gt;   1278
255  1305   &lt;NA&gt;   1306
256   576   &lt;NA&gt;    577
257   809    821    811
258  1180   &lt;NA&gt;   1186
259   584   &lt;NA&gt;    587
260  1088    512   1091
261   533   &lt;NA&gt;    542
262   614   &lt;NA&gt;    618
263   865   &lt;NA&gt;    540
264   889   &lt;NA&gt;    600
265   905   &lt;NA&gt;    908
266   944    601    956
267   967   &lt;NA&gt;    968
268   551    601    538
269  1026   &lt;NA&gt;   1029
270   859   &lt;NA&gt;    863
271  1109   &lt;NA&gt;   1112
272  1302   &lt;NA&gt;   1306
273  1073   &lt;NA&gt;   1077
274   661   &lt;NA&gt;    666
275   759   &lt;NA&gt;    761
276   636   &lt;NA&gt;    642
277   698   &lt;NA&gt;    701
278  1296   &lt;NA&gt;   1299
279   558   &lt;NA&gt;    570
280  1253   &lt;NA&gt;   1257
281   578   &lt;NA&gt;    585
282  1090   &lt;NA&gt;   1091
283   978   &lt;NA&gt;    979
284  1233   &lt;NA&gt;   1237
285   906   &lt;NA&gt;    908
286   945   &lt;NA&gt;    955
287  1250   &lt;NA&gt;   1252
288   963   &lt;NA&gt;    968
289   535   &lt;NA&gt;    538
290   793   &lt;NA&gt;    796
291   621   &lt;NA&gt;    623
292  1027   &lt;NA&gt;   1029
293   682   &lt;NA&gt;    683
294   655   &lt;NA&gt;    657
295  1303   1290   1306
296   662   &lt;NA&gt;    666
297   631   &lt;NA&gt;    665
298   760   &lt;NA&gt;    761
299  1081   1097   1085
300  1079   1097   1080
301   637   1097    642
302  1294   1097   1295
303   586   &lt;NA&gt;    587
304   579   &lt;NA&gt;    585
305   541    742    542
306  1225   &lt;NA&gt;   1232
307   946   &lt;NA&gt;    955
308  1127   &lt;NA&gt;   1128
309   525   &lt;NA&gt;    527
310   536   &lt;NA&gt;    538
311   794   &lt;NA&gt;    796
312   790   &lt;NA&gt;    792
313   622   1042    623
314   892   1042    895
315  1028   &lt;NA&gt;   1029
316  1194   &lt;NA&gt;   1195
317   656   &lt;NA&gt;    657
318  1110    926   1112
319  1277   &lt;NA&gt;   1278
320  1074    926   1077
321   632   &lt;NA&gt;    665
322   638   1290    642
323   699    926    701
324   574   &lt;NA&gt;    577
325   572    926    576
326  1141   &lt;NA&gt;    809
327   807   &lt;NA&gt;    810
328   932    926   1295
329   559   &lt;NA&gt;    570
330  1176   1097   1182
331  1177   &lt;NA&gt;   1183
332   988   &lt;NA&gt;    990
333   676   &lt;NA&gt;   1088
334   599   &lt;NA&gt;    600
335  1234   &lt;NA&gt;   1237
336  1228   &lt;NA&gt;   1236
337   503    670   1226
338   960   &lt;NA&gt;    952
339   526   &lt;NA&gt;    527
340   964    555    968
341   530   &lt;NA&gt;    537
342   795   &lt;NA&gt;    796
343   860   &lt;NA&gt;    863
344   562   &lt;NA&gt;    565
345  1136   &lt;NA&gt;   1195
346  1178   &lt;NA&gt;   1305
347   975    926   1073
348  1082   1290   1085
349   639   1290    642
350   885   1097    697
351   575   &lt;NA&gt;    577
352  1142    926    809
353   808   &lt;NA&gt;    810
354   933   &lt;NA&gt;   1295
355  1041   1290   1183
356   608   &lt;NA&gt;    652
357  1254   &lt;NA&gt;   1257
358   582   &lt;NA&gt;    584
359   989   &lt;NA&gt;    990
360   717    740    533
361  1047   &lt;NA&gt;    600
362  1045   &lt;NA&gt;   1233
363  1191   &lt;NA&gt;   1236
364   907   &lt;NA&gt;    908
365   911   &lt;NA&gt;    953
366   965   &lt;NA&gt;    968
367   531   &lt;NA&gt;    537
368   861   &lt;NA&gt;    863
369   993   &lt;NA&gt;   1109
370  1008    677   1010
371  1198   &lt;NA&gt;   1302
372   730   &lt;NA&gt;    731
373   663    926    666
374   678   &lt;NA&gt;    662
375   633   &lt;NA&gt;    665
376  1261    926   1080
377   961   &lt;NA&gt;    698
378   626    926    576
379  1297   &lt;NA&gt;   1299
380  1185   &lt;NA&gt;   1186
381  1189   1097   1182
382   628   1298    652
383  1255   &lt;NA&gt;   1257
384   711   &lt;NA&gt;   1253
385   828   &lt;NA&gt;    541
386   888   &lt;NA&gt;    889
387  1221    555   1232
388   505   &lt;NA&gt;   1226
389   966   &lt;NA&gt;    968
390   894   &lt;NA&gt;    895
391  1129   &lt;NA&gt;    891
392   681   1108   1027
393  1053   &lt;NA&gt;   1026
394   718   &lt;NA&gt;    682
395   563   &lt;NA&gt;    565
396   553   &lt;NA&gt;    554
397   598   &lt;NA&gt;    655
398   596   &lt;NA&gt;    949
399  1111   &lt;NA&gt;   1112
400   664   1108    666
401   679   &lt;NA&gt;    662
402   567    926    568
403  1083    926   1085
404  1262    926   1080
405   640   &lt;NA&gt;    642
406  1064    926    558
407  1179    926   1180
408  1256    926   1257
409   583   &lt;NA&gt;    584
410   744   &lt;NA&gt;    614
411  1048   1084    600
412  1279    926    978
413  1192   1298   1236
414   915    539    954
415   925    539    945
416   510   &lt;NA&gt;   1249
417   532   &lt;NA&gt;    537
418   557    539    790
419   943   &lt;NA&gt;    622
420  1199   &lt;NA&gt;   1028
421   560   &lt;NA&gt;    565
422   899   &lt;NA&gt;    562
423  1006   &lt;NA&gt;   1010
424  1274    641   1277
425   597    641   1275
426  1196   1078   1302
427   660   1005    666
428   654    571    661
429   629   &lt;NA&gt;    665
430   825   &lt;NA&gt;    631
431  1259    926   1080
432  1096   &lt;NA&gt;    699
433  1248    909    932
434  1040   &lt;NA&gt;   1183
435   709   &lt;NA&gt;   1253
436   867   1005    585
437   615   1146    618
438   521   1084    540
439   864   &lt;NA&gt;    865
440   887    926    889
441  1231    926   1237
442  1190   &lt;NA&gt;   1236
443   502   &lt;NA&gt;   1226
444   914   &lt;NA&gt;    954
445   910   &lt;NA&gt;    953
446   770    539    947
447   524   &lt;NA&gt;    527
448   509   1084   1249
449   480   &lt;NA&gt;    963
450   534   &lt;NA&gt;    538
451   789   1146    792
452  1052   &lt;NA&gt;   1026
453   561   &lt;NA&gt;    565
454   552   &lt;NA&gt;    554
455  1019   1224   1110
456   992   &lt;NA&gt;   1109
457  1070   &lt;NA&gt;   1303
458  1197    641   1302
459   973    909   1073
460   739   &lt;NA&gt;    678
461   630   &lt;NA&gt;    665
462   635    687    642
463   528   &lt;NA&gt;    572
464  1143   &lt;NA&gt;    809
465   627   &lt;NA&gt;    628
466   507   &lt;NA&gt;   1255
467   581   1298    584
468   675   1229   1088
469   616   &lt;NA&gt;    618
470   743   &lt;NA&gt;    614
471  1046    942    600
472   782   &lt;NA&gt;   1047
473  1247   1229   1225
474   881    641    946
475   688    812    526
476   962   &lt;NA&gt;    968
477   481   &lt;NA&gt;    963
478   872   &lt;NA&gt;    536
479   556   1229    790
480   890   &lt;NA&gt;    895
481  1024   &lt;NA&gt;    892
482  1130   &lt;NA&gt;    891
483   671   &lt;NA&gt;    672
484   122   &lt;NA&gt;    562
485    94   &lt;NA&gt;    554
486   118   &lt;NA&gt;    855
487    99   1150   1275
488   150   1065   1302
489   109    893    731
490   139   &lt;NA&gt;   1077
491   108   &lt;NA&gt;    661
492   104   &lt;NA&gt;    665
493   154    700   1080
494   111   1184   1261
495   106    700    636
496    98   1030    626
497   146   1146   1294
498   101   &lt;NA&gt;    608
499   153   1084   1257
500    91    641   1255
501   156   &lt;NA&gt;    711
502    96    909    584
503   119   1184    585
504   136   &lt;NA&gt;    600
505   121    812    889
506   135    812   1233
507   152   1184   1225
508   112   &lt;NA&gt;    906
509   125   &lt;NA&gt;    954
510   129   &lt;NA&gt;    968
511   116   1184    964
512    89   1150    963
513    93   1229    538
514   128    539    622
515   147   &lt;NA&gt;    891
516   148   &lt;NA&gt;    883
517   193   &lt;NA&gt;   1029
518   203   &lt;NA&gt;   1028
519   195   &lt;NA&gt;   1199
520   198   &lt;NA&gt;   1112
521   207   &lt;NA&gt;   1274
522   166   &lt;NA&gt;   1275
523   177    791   1198
524   204   &lt;NA&gt;    975
525   172   1282    660
526   206   1227   1080
527   173   1011   1261
528   167    687    639
529   190   &lt;NA&gt;    698
530   162   &lt;NA&gt;    572
531   187   &lt;NA&gt;   1296
532   197   &lt;NA&gt;    558
533   194    687   1183
534   184   1011    628
535   182   &lt;NA&gt;   1254
536   171    991   1253
537   209    687    711
538   165   1227    584
539   183   1227    585
540   181   &lt;NA&gt;    541
541   192   &lt;NA&gt;    744
542   180    573   1048
543   179    909   1047
544   186    909    889
545   211   &lt;NA&gt;    978
546   202    812   1236
547   175    991    906
548   188   1224    954
549   189    812    945
550   178    812    925
551   176    812    947
552   169   1075    526
553   210   1251   1250
554   208   1184   1276
555   161    812   1249
556   212    812    510
557   163   &lt;NA&gt;    537
558   200    812    891
559   170   &lt;NA&gt;    869
560   201   &lt;NA&gt;   1126
561   168   &lt;NA&gt;    659
562   234   &lt;NA&gt;    562
563   233   &lt;NA&gt;    866
564   243   &lt;NA&gt;    489
565   232   &lt;NA&gt;    855
566   227   &lt;NA&gt;    597
567   240   &lt;NA&gt;   1303
568   248    884   1302
569   237   1007   1073
570   235   1117    663
571   238   &lt;NA&gt;    679
572   223   &lt;NA&gt;    661
573   239   &lt;NA&gt;    629
574   224   &lt;NA&gt;    634
575   249    909    637
576   220    909    626
577   221    909   1142
578   251    909    932
579   225   1075   1248
580   244   &lt;NA&gt;   1189
581   230   &lt;NA&gt;   1254
582   219   1227    584
583   217   &lt;NA&gt;    581
584   229   &lt;NA&gt;    541
585   222   1227    618
586   231   1227    615
587   226   &lt;NA&gt;    887
588   218    909   1279
589   247    768   1236
590   246   1075   1190
591   250   1304   1225
592   254   &lt;NA&gt;   1250
593   253   1184   1276
594   216   &lt;NA&gt;   1249
595   255    768    510
596   213   1007    963
597   236   1184    622
598   241   &lt;NA&gt;    620
599   242   &lt;NA&gt;    891
600   214   &lt;NA&gt;   1089
601   288   &lt;NA&gt;   1029
602   298    566    563
603   257   &lt;NA&gt;    552
604   296   1075   1293
605   301   &lt;NA&gt;   1284
606   283   &lt;NA&gt;   1109
607   286   &lt;NA&gt;   1010
608   278   &lt;NA&gt;    730
609   282   &lt;NA&gt;   1073
610   297   &lt;NA&gt;    975
611   281   1220    664
612   261    873    665
613   284   &lt;NA&gt;    629
614   260    909    639
615   264   &lt;NA&gt;    638
616   285    868   1096
617   280    504    698
618   258   &lt;NA&gt;    626
619   259   &lt;NA&gt;   1142
620   279   1007   1296
621   268   &lt;NA&gt;   1256
622   271   1227    541
623   287   1211    744
624   274   &lt;NA&gt;    865
625   270   &lt;NA&gt;   1047
626   276   1235    889
627   300   &lt;NA&gt;    978
628   295   &lt;NA&gt;   1236
629   294   1075   1190
630   277   1075   1221
631   269    922    925
632   263   &lt;NA&gt;    526
633   275   &lt;NA&gt;    967
634   291   &lt;NA&gt;    891
635   292   &lt;NA&gt;   1126
636   262   &lt;NA&gt;    672
637   289   &lt;NA&gt;   1033
638   332   &lt;NA&gt;   1293
639   302   &lt;NA&gt;    497
640   319   &lt;NA&gt;    855
641   325   &lt;NA&gt;   1110
642   329   &lt;NA&gt;   1019
643   335   &lt;NA&gt;   1277
644   334   &lt;NA&gt;   1274
645   310   1075    597
646   330   1220   1302
647   311   &lt;NA&gt;    660
648   303   &lt;NA&gt;    654
649   307   &lt;NA&gt;    104
650   306   &lt;NA&gt;    634
651   316   &lt;NA&gt;    631
652   318   1011   1262
653   312   1116   1261
654   326    617    961
655   304    909    584
656   309   &lt;NA&gt;     96
657   324   1304    988
658   317   &lt;NA&gt;    615
659   315   1087   1047
660   308   1227    887
661   322    922   1221
662   321   &lt;NA&gt;    907
663   333    580    905
664   314    922    925
665   305    504    526
666   336    922   1250
667   378   &lt;NA&gt;   1140
668   376   &lt;NA&gt;    489
669   360   &lt;NA&gt;   1283
670   359   &lt;NA&gt;    854
671   344   &lt;NA&gt;   1275
672   380   &lt;NA&gt;   1302
673   379   1263    150
674   338   &lt;NA&gt;   1197
675   340   &lt;NA&gt;    177
676   383   &lt;NA&gt;    975
677   356   1007    204
678   337   &lt;NA&gt;    654
679   348   &lt;NA&gt;    104
680   361   1007    567
681   358   1076   1262
682   346   &lt;NA&gt;    639
683   368    504   1096
684   343    862    626
685   370   1087     98
686   363   &lt;NA&gt;   1296
687   366     92   1295
688   353   &lt;NA&gt;    146
689   377   1076   1189
690   345    976    184
691   382   1087    153
692   384   1072    711
693   341   1076    581
694   357   &lt;NA&gt;    615
695   372   &lt;NA&gt;    744
696   351   1087    192
697   373   &lt;NA&gt;    186
698   349   &lt;NA&gt;    887
699   385   &lt;NA&gt;    978
700   352   &lt;NA&gt;    135
701   362   &lt;NA&gt;    907
702   365    768    189
703   355    934    925
704   347    893    526
705   367   1075    161
706   371   1075    509
707   386   1304    510
708   342   &lt;NA&gt;    537
709   364    768    557
710   375   &lt;NA&gt;    620
711   369   &lt;NA&gt;    148
712   419   &lt;NA&gt;    563
713   397   &lt;NA&gt;    298
714   417   &lt;NA&gt;     94
715   400   &lt;NA&gt;    232
716   394   &lt;NA&gt;    597
717   414   1260    248
718   403    504    730
719   395   &lt;NA&gt;    660
720   408   &lt;NA&gt;    629
721   391   &lt;NA&gt;    634
722   401   1007    567
723   399    692   1262
724   418   &lt;NA&gt;    249
725   390   &lt;NA&gt;    285
726   411    566    961
727   413    692    220
728   424   1087    221
729   406   1087   1295
730   420   &lt;NA&gt;    932
731   404   &lt;NA&gt;    244
732   387    228   1255
733   388   &lt;NA&gt;    581
734   407   &lt;NA&gt;    988
735   398   1304    541
736   392   1304    229
737   409   &lt;NA&gt;    744
738   410   1211   1233
739   396    934    135
740   416   &lt;NA&gt;    202
741   415    143   1190
742   402   1260   1221
743   422    934   1250
744   405    692    216
745   423   1304    510
746   389   1304    236
747   436   &lt;NA&gt;    193
748   464   &lt;NA&gt;   1026
749   460    772    198
750   471   &lt;NA&gt;   1019
751   437   &lt;NA&gt;    329
752   441   &lt;NA&gt;    597
753   472    566   1302
754   469   &lt;NA&gt;    150
755   428   &lt;NA&gt;   1197
756   445   1211   1198
757   430   &lt;NA&gt;    177
758   439    290    109
759   443   1087    139
760   433    692    281
761   435    566    235
762   459   &lt;NA&gt;    629
763   425   &lt;NA&gt;    284
764   444    143   1261
765   476   &lt;NA&gt;    260
766   448   &lt;NA&gt;    279
767   457   &lt;NA&gt;    268
768   429    873   1255
769   478   1087    711
770   434   &lt;NA&gt;    584
771   431    710    581
772   426   1211    119
773   449   1260    541
774   447    853   1047
775   462   &lt;NA&gt;    276
776   442   1260    135
777   463   1075    247
778   470    199    202
779   452   &lt;NA&gt;   1221
780   427    853    505
781   453    267    189
782   446   1075    925
783   479    504    269
784   455   1075    178
785   477   1075   1276
786   454   1260    216
787   461   1075    509
788   466    191    116
789   432    245    537
790    34   &lt;NA&gt;   1026
791     6   &lt;NA&gt;    325
792    36    771   1019
793    14    256    139
794    33    252    973
795    21   &lt;NA&gt;    204
796    12   1087    660
797    17    692    739
798    15   &lt;NA&gt;   1261
799    30    775   1096
800     8   1076    285
801    16   1137    146
802     7   &lt;NA&gt;    184
803    28   1263    268
804     3   1087   1255
805     9   1260     96
806    37   1072    217
807     1    873    119
808    10    873    324
809    22   1260    541
810     5   1076    287
811    11   &lt;NA&gt;    192
812    20   1107   1048
813     2   1260    270
814    24   1075    295
815    35   1075   1190
816    25   &lt;NA&gt;    907
817    26    293    189
818    27    934    178
819    29   1075    161
820    32   1211    509
821    38   &lt;NA&gt;    510
822    67   &lt;NA&gt;   1053
823    79   &lt;NA&gt;   1019
824    51   &lt;NA&gt;    329
825    81   &lt;NA&gt;    344
826    43    160    330
827    77    164    150
828    41   1219    379
829    54    381    109
830    70    290    282
831    87    350    237
832    69    160    973
833    50   &lt;NA&gt;    383
834    48   &lt;NA&gt;    235
835    44    228    654
836    62    882    567
837    60   &lt;NA&gt;   1262
838    59   1076    318
839    82    529    249
840    75    266    368
841    68   &lt;NA&gt;    190
842    80   &lt;NA&gt;    251
843    52    185   1248
844    49    185    225
845    64    185    382
846    56   &lt;NA&gt;    230
847    88    350    711
848    55   1107    209
849    53    842     96
850    83   &lt;NA&gt;    217
851    42   1107    119
852    61   &lt;NA&gt;    357
853    78    252    372
854    47    205    287
855    71   &lt;NA&gt;    276
856    57    215    135
857    65    102    352
858    72   1075    247
859    76   &lt;NA&gt;   1190
860    40     92    355
861    74    164    314
862    73     92    254
863    63   &lt;NA&gt;    536
864    66     92    557
865    86   1263    241
866    84   &lt;NA&gt;    369
867   696    143    436
868   858   &lt;NA&gt;    232
869  1020   1072   1110
870   588   &lt;NA&gt;    325
871  1123   &lt;NA&gt;    469
872   974   &lt;NA&gt;   1073
873   919    354    297
874   813    695    204
875   844    421    356
876   996   &lt;NA&gt;    629
877   845    215   1262
878   741    473    358
879   836    393    318
880  1004    215    346
881  1267    215    260
882  1086    882    961
883  1200    140    370
884  1286    350    221
885   712   1260     96
886  1124   1072    341
887   490   1260    119
888   827   1260    541
889   843   &lt;NA&gt;    615
890   735    215    192
891   787    140    274
892  1035    185    276
893  1061   1260    186
894   870    102    295
895  1050    228    367
896  1022    252    509
897  1021   &lt;NA&gt;   1110
898   492    196    330
899   763   &lt;NA&gt;    443
900  1264    299    237
901  1023   &lt;NA&gt;    973
902   814    374    204
903   748    174    660
904   802   &lt;NA&gt;     12
905   593    102    235
906   752   &lt;NA&gt;    476
907  1187    695    411
908  1169    695    326
909  1201    412    370
910   823    702    363
911   912   &lt;NA&gt;    244
912   876   &lt;NA&gt;    382
913   980   &lt;NA&gt;    457
914  1161    465    478
915   610    299    384
916   733    328    209
917   513   &lt;NA&gt;    581
918   645   &lt;NA&gt;    449
919   719   1107    229
920   830    215    317
921  1175   &lt;NA&gt;    372
922   518    702    287
923   788    273    274
924  1062   1260    186
925   779    695    218
926   901   &lt;NA&gt;    352
927   916    143    189
928   781    102    925
929   548    143    446
930   482    102    355
931  1114    191    466
932  1246   &lt;NA&gt;    241
933  1193   &lt;NA&gt;    460
934  1043   &lt;NA&gt;     36
935   493    456    330
936  1258    290     43
937   486    290    379
938  1051    438     33
939   920    320    297
940   815   &lt;NA&gt;    204
941   857    205     21
942   749    695    660
943   569    468    281
944   673    299     17
945   837    205    318
946   753   &lt;NA&gt;    476
947   998    695   1096
948  1098   &lt;NA&gt;    220
949  1287    205    221
950  1204    695    251
951   706   &lt;NA&gt;   1248
952   607   &lt;NA&gt;    101
953   877   &lt;NA&gt;    382
954  1212   &lt;NA&gt;     28
955   798    695      3
956  1157    228    429
957  1162    215    478
958   611   &lt;NA&gt;    384
959   734    695    209
960   514    228    581
961   646    331    449
962   726    191    398
963   720    191    229
964   849    191    357
965   831    191    317
966   519   &lt;NA&gt;    287
967  1155    191    447
968   506    102    270
969   756    265    135
970   902   &lt;NA&gt;    352
971  1167   &lt;NA&gt;   1190
972   549    252    446
973   483    313    355
974  1133    293    314
975  1057    474    455
976   995    293    161
977  1131    265     29
978   957    313    129
979   624   &lt;NA&gt;    163
980   494   &lt;NA&gt;    330
981  1170    465    150
982   487    450    379
983  1265   &lt;NA&gt;    237
984   816   &lt;NA&gt;    204
985   803    467     12
986   674   &lt;NA&gt;     17
987  1101   &lt;NA&gt;    459
988   838   &lt;NA&gt;    318
989  1015   &lt;NA&gt;     75
990  1002    272      8
991  1188    320    411
992  1099   &lt;NA&gt;    220
993   824     46    363
994  1209   &lt;NA&gt;     80
995   680    473    225
996   878    299    382
997  1153   &lt;NA&gt;     56
998   612    299    384
999   713    102     96
1000  515    299    581
1001  667    205     42
1002  721    205    229
1003  850   &lt;NA&gt;    357
1004 1119    215     78
1005  606    102      2
1006 1036   &lt;NA&gt;    276
1007 1031    199    462
1008 1063   &lt;NA&gt;    186
1009  757   &lt;NA&gt;    135
1010 1271   &lt;NA&gt;     65
1011  871   &lt;NA&gt;    295
1012  777    393     35
1013  786   &lt;NA&gt;    321
1014  917    327    189
1015  550    265    446
1016 1115   &lt;NA&gt;    254
1017  958    199    129
1018  689   &lt;NA&gt;    236
1019  603   &lt;NA&gt;    588
1020 1044   &lt;NA&gt;     36
1021  495   &lt;NA&gt;    330
1022  499   &lt;NA&gt;    338
1023  691     13    763
1024  927   &lt;NA&gt;   1264
1025  984    475    844
1026  750    272    660
1027  804    272     12
1028  594    473    235
1029 1066    339    435
1030 1245    644     62
1031  937     46    361
1032 1056    272   1004
1033 1268    272    260
1034  754   &lt;NA&gt;    476
1035  999    272   1096
1036 1240    473     30
1037 1202   &lt;NA&gt;    370
1038 1205    473    251
1039  879   &lt;NA&gt;    382
1040  981   &lt;NA&gt;    457
1041 1158    475    429
1042  737   &lt;NA&gt;    230
1043 1163   &lt;NA&gt;    478
1044  714    299     96
1045  516   &lt;NA&gt;    581
1046  590   &lt;NA&gt;    513
1047  668    205     42
1048  647   &lt;NA&gt;    449
1049  727    474    398
1050  722   &lt;NA&gt;    229
1051 1120    458     78
1052  520    215    287
1053 1032    323    462
1054 1272   &lt;NA&gt;     65
1055 1173   &lt;NA&gt;    416
1056 1168    474   1190
1057  923   &lt;NA&gt;    453
1058 1166   &lt;NA&gt;     27
1059 1058    323    455
1060  959   &lt;NA&gt;    129
1061 1222   &lt;NA&gt;    369
1062  604   &lt;NA&gt;    588
1063 1054    339    428
1064  500    997    338
1065  764   &lt;NA&gt;    443
1066 1266   &lt;NA&gt;    237
1067  685    474   1023
1068  707    997     50
1069 1148   &lt;NA&gt;    815
1070 1013   &lt;NA&gt;    593
1071 1067   &lt;NA&gt;    435
1072  491   &lt;NA&gt;    673
1073 1269    272    260
1074 1241    473     30
1075 1003   1243      8
1076 1103   1243   1187
1077 1039   &lt;NA&gt;    823
1078 1071    421   1204
1079  738    458    912
1080  649   &lt;NA&gt;    345
1081  523     39    607
1082 1213    320     28
1083  799     23      3
1084  897   &lt;NA&gt;    798
1085  650   1113   1157
1086 1154   &lt;NA&gt;     56
1087  715    327     96
1088  773    327      9
1089  766   &lt;NA&gt;      1
1090  704    327    426
1091  728    327    398
1092  851    474    357
1093  832   &lt;NA&gt;    317
1094  936     19    518
1095  846   &lt;NA&gt;     11
1096 1156    199    447
1097 1037    474    276
1098  758   &lt;NA&gt;    135
1099  903   &lt;NA&gt;    352
1100  784   &lt;NA&gt;   1167
1101  918    440    189
1102  970    458    916
1103 1049    765    548
1104 1059    458    455
1105  690   &lt;NA&gt;    236
1106  605   &lt;NA&gt;    588
1107  496   &lt;NA&gt;    330
1108  994   &lt;NA&gt;    494
1109  488   &lt;NA&gt;    379
1110  762     45    487
1111 1307   1025     41
1112 1055   &lt;NA&gt;    428
1113  724   &lt;NA&gt;     14
1114 1034   &lt;NA&gt;    282
1115  708   &lt;NA&gt;     50
1116 1207   &lt;NA&gt;    816
1117  928   &lt;NA&gt;    748
1118  805   &lt;NA&gt;     12
1119  595   &lt;NA&gt;    235
1120 1068   &lt;NA&gt;    435
1121  938   &lt;NA&gt;    361
1122  839    458    318
1123  939   &lt;NA&gt;    753
1124 1217   &lt;NA&gt;    249
1125 1242   &lt;NA&gt;     30
1126 1104   &lt;NA&gt;   1187
1127 1151   &lt;NA&gt;   1098
1128 1203   &lt;NA&gt;    370
1129 1210    511     80
1130  913   &lt;NA&gt;    244
1131  982   &lt;NA&gt;    457
1132  800   &lt;NA&gt;      3
1133  898    977    798
1134 1164    485    478
1135 1281   1025    611
1136  591   &lt;NA&gt;    513
1137  669   &lt;NA&gt;     42
1138  767   &lt;NA&gt;      1
1139  705   &lt;NA&gt;    426
1140  729   &lt;NA&gt;    398
1141  986    475    726
1142  723   &lt;NA&gt;    229
1143  852   &lt;NA&gt;    357
1144  819   &lt;NA&gt;    519
1145  847   &lt;NA&gt;     11
1146  508   &lt;NA&gt;   1062
1147  780   &lt;NA&gt;    218
1148 1230     45    756
1149  904    458    352
1150  785   &lt;NA&gt;   1167
1151 1106     45    322
1152  931    440    917
1153  971     18    916
1154  924     85    453
1155  969   &lt;NA&gt;    483
1156 1060    393    455
1157  546     19    995
1158 1223   &lt;NA&gt;    369
1159 1171   &lt;NA&gt;    150
1160  941    412   1170
1161  501   &lt;NA&gt;    338
1162  686     45   1023
1163  921   &lt;NA&gt;    297
1164 1149    412    815
1165  929     58    748
1166  806   &lt;NA&gt;     12
1167 1215   &lt;NA&gt;    395
1168 1069   1216    435
1169  840    511    318
1170  755   &lt;NA&gt;    476
1171 1218   &lt;NA&gt;    249
1172  694   &lt;NA&gt;    999
1173 1016   &lt;NA&gt;     75
1174 1105   &lt;NA&gt;   1187
1175  834   &lt;NA&gt;   1169
1176 1100   &lt;NA&gt;    220
1177 1147     23    878
1178 1095      4   1158
1179  651   &lt;NA&gt;   1157
1180 1001   &lt;NA&gt;   1163
1181  613    511    384
1182  716   &lt;NA&gt;     96
1183  774   &lt;NA&gt;      9
1184  592   &lt;NA&gt;    513
1185  987    703    726
1186  972    451    722
1187 1292   &lt;NA&gt;    831
1188 1121     31     78
1189  602   &lt;NA&gt;   1119
1190  848    511     11
1191 1038   &lt;NA&gt;    276
1192 1134   1214    314
1193  547   &lt;NA&gt;    995
1194  747   &lt;NA&gt;    624
1195 1172   &lt;NA&gt;   1246
1196  817   &lt;NA&gt;     77
1197  684   &lt;NA&gt;   1023
1198 1012     85    593
1199 1289    421    937
1200  835   &lt;NA&gt;    318
1201  751   &lt;NA&gt;    476
1202 1239   &lt;NA&gt;     30
1203  822   &lt;NA&gt;   1002
1204 1102   &lt;NA&gt;   1187
1205  833   &lt;NA&gt;   1169
1206  886   &lt;NA&gt;   1205
1207 1208   &lt;NA&gt;     80
1208 1308   &lt;NA&gt;     52
1209  648   &lt;NA&gt;    345
1210  797    458      3
1211 1092   &lt;NA&gt;    799
1212  896   &lt;NA&gt;    798
1213 1093   &lt;NA&gt;   1158
1214  609   &lt;NA&gt;    384
1215 1280   &lt;NA&gt;    611
1216  880   &lt;NA&gt;    515
1217  589   &lt;NA&gt;    513
1218  725   &lt;NA&gt;    398
1219  829   &lt;NA&gt;    317
1220 1300   &lt;NA&gt;   1120
1221  818   &lt;NA&gt;    519
1222  935   &lt;NA&gt;    518
1223 1138   &lt;NA&gt;    788
1224 1017   &lt;NA&gt;   1036
1225  900   &lt;NA&gt;    352
1226  732   &lt;NA&gt;    901
1227 1135   &lt;NA&gt;    786
1228  930   &lt;NA&gt;    917
1229 1165   &lt;NA&gt;     27
1230  544   &lt;NA&gt;    995
1231  778   &lt;NA&gt;     32
1232  517   &lt;NA&gt;    959
1233  940   &lt;NA&gt;   1170
1234  484   &lt;NA&gt;    379
1235  498   &lt;NA&gt;    338
1236 1206   &lt;NA&gt;    816
1237  801    475     12
1238 1125   &lt;NA&gt;    804
1239  658   &lt;NA&gt;   1013
1240 1244   &lt;NA&gt;     62
1241 1122   1216    838
1242  543   &lt;NA&gt;    754
1243  693   &lt;NA&gt;    999
1244 1014   &lt;NA&gt;     75
1245 1309   &lt;NA&gt;     52
1246  653   &lt;NA&gt;    649
1247  522   &lt;NA&gt;    607
1248  875   &lt;NA&gt;    382
1249 1094   &lt;NA&gt;   1158
1250  841   &lt;NA&gt;    737
1251 1152   &lt;NA&gt;     56
1252 1159   &lt;NA&gt;   1153
1253 1160     58    478
1254 1000   &lt;NA&gt;   1163
1255  856   &lt;NA&gt;    612
1256  769   &lt;NA&gt;    773
1257  985   &lt;NA&gt;    726
1258 1273   1216    721
1259  820    475    851
1260 1291   &lt;NA&gt;    831
1261 1118   &lt;NA&gt;     78
1262 1301   &lt;NA&gt;   1120
1263 1139   &lt;NA&gt;    788
1264  983   1216   1156
1265  826   &lt;NA&gt;   1037
1266 1018   &lt;NA&gt;   1036
1267 1270    393     65
1268  619   &lt;NA&gt;   1271
1269  783   &lt;NA&gt;   1167
1270  776   &lt;NA&gt;     35
1271  874   &lt;NA&gt;    549
1272 1132   1174    314
1273  545   &lt;NA&gt;    995
1274  746   &lt;NA&gt;    624
1275 1285   &lt;NA&gt;    689
1276  134     23   1034
1277  103     23     69
1278  126   1288   1207
1279  115   &lt;NA&gt;     12
1280  124   &lt;NA&gt;    595
1281  159   &lt;NA&gt;    937
1282  105   &lt;NA&gt;   1268
1283  137   &lt;NA&gt;   1242
1284  132   &lt;NA&gt;     75
1285  151   &lt;NA&gt;     80
1286  107   &lt;NA&gt;   1210
1287  141   &lt;NA&gt;   1209
1288  120   &lt;NA&gt;    382
1289  114   &lt;NA&gt;      3
1290  142   &lt;NA&gt;    799
1291  123    511    897
1292  149   &lt;NA&gt;    429
1293  138   &lt;NA&gt;   1164
1294  157   &lt;NA&gt;    611
1295   97   &lt;NA&gt;    513
1296  113   &lt;NA&gt;    705
1297  130   &lt;NA&gt;    726
1298  155   &lt;NA&gt;    721
1299  100   &lt;NA&gt;   1119
1300  145   &lt;NA&gt;    819
1301  133   &lt;NA&gt;   1036
1302   90    736    508
1303  110   &lt;NA&gt;    901
1304  127   &lt;NA&gt;    917
1305  117   &lt;NA&gt;    550
1306   95   &lt;NA&gt;     29
1307  158   &lt;NA&gt;    689
1308  131   &lt;NA&gt;   1223
1309  144   &lt;NA&gt;   1222</code></pre>
</div>
</div>
<section id="running-the-model" class="level3" data-number="7.0.1"><h3 data-number="7.0.1" class="anchored" data-anchor-id="running-the-model">
<span class="header-section-number">7.0.1</span> Running the model</h3>
<p>First we need to load the <code>asreml</code> library:</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">asreml</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: Matrix</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Online License checked out Mon Mar 25 16:48:01 2024</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading ASReml-R version 4.2</code></pre>
</div>
</div>
<p>For running multivariate analyses in ASReml-R, the code is slightly more complex than for the univariate case. This is because ASReml-R allows us to make different assumptions about the way in which traits might be related. We need to explicitly specify a covariance structure with difference covariance functions <code>us()</code>, <code>idh()</code> or <code>corgh()</code> which for example would estimate an unconstrained (co)variance matrix, an identity matrix and a variance and correlation matrix repestively. We can also specify some starting values for the variance matrices. These can be very approximate <em>guestimates</em> or not at all, but having reasonable starting values can help convergence. It is also possible to let the model running without specifying starting values. Finally, we have increased the default maximum number of iterations (<code>maxiter</code>) which can help to achieve convergence for more complicated models. Another way to increase the number of iteration will be to use the <code>update</code> function. Notes that if the <code>LogLik</code> is not stabilized after several iterations, it is good indication of the model require more iteration.</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ainv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/ainverse.html">ainverse</a></span><span class="op">(</span><span class="va">gryphonped</span><span class="op">)</span></span>
<span></span>
<span><span class="va">modela</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/asreml.html">asreml</a></span><span class="op">(</span></span>
<span>  fixed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">bwt</span>, <span class="va">tarsus</span><span class="op">)</span> <span class="op">~</span> <span class="va">trait</span>,</span>
<span>  random <span class="op">=</span> <span class="op">~</span> <span class="fu">us</span><span class="op">(</span><span class="va">trait</span>, init <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">:</span><span class="fu">vm</span><span class="op">(</span><span class="va">animal</span>, <span class="va">ainv</span><span class="op">)</span>,</span>
<span>  residual <span class="op">=</span> <span class="op">~</span> <span class="fu">id</span><span class="op">(</span><span class="va">units</span><span class="op">)</span><span class="op">:</span><span class="fu">us</span><span class="op">(</span><span class="va">trait</span>, init <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">gryphon</span>,</span>
<span>  na.action <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/na.method.html">na.method</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"include"</span>, y <span class="op">=</span> <span class="st">"include"</span><span class="op">)</span>,</span>
<span>  maxit <span class="op">=</span> <span class="fl">20</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ASReml Version 4.2 25/03/2024 16:50:01
          LogLik        Sigma2     DF     wall
 1     -7108.741           1.0   1535   16:50:01
 2     -5837.803           1.0   1535   16:50:01
 3     -4437.495           1.0   1535   16:50:01
 4     -3459.378           1.0   1535   16:50:01
 5     -2914.034           1.0   1535   16:50:01
 6     -2729.131           1.0   1535   16:50:01
 7     -2684.659           1.0   1535   16:50:01
 8     -2679.838           1.0   1535   16:50:01
 9     -2679.742           1.0   1535   16:50:01
10     -2679.741           1.0   1535   16:50:01</code></pre>
</div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">modela</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span><span class="op">(</span><span class="va">modela</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ASReml Version 4.2 25/03/2024 16:50:01
          LogLik        Sigma2     DF     wall
 1     -2679.741           1.0   1535   16:50:01
 2     -2679.741           1.0   1535   16:50:01</code></pre>
</div>
</div>
<p><code>modela</code> has fitted a bivariate model of <code>bwt</code> and <code>tarsus</code>, with the mean for each of the traits as a fixed effect (<code>trait</code>). The additive genetic variance-covariance matrix (<span class="math inline">\(\textbf{G}\)</span>) is unstructured (<code>us</code>; <em>i.e.</em> all elements are free to vary) and the starting values for <span class="math inline">\(V_A\)</span> for <code>bwt</code>, <span class="math inline">\(COV_A\)</span> between <code>bwt</code> and <code>tarsus</code>, and <span class="math inline">\(V_A\)</span> for <code>tarsus</code> are set to 1, 0.1 and 1, respectively. Similarly, the residual matrix is unstructured and uses the same starting values.</p>
<p>Note that the argument <code>na.action = na.method(x = "include", y = "include")</code> can be added to the model. In a bivariate model, it will help calculate the covariance between two traits with different missing information <code>NA</code> and so help imbalance phenotypage and save sample size. However, it is important to scale ( mean =0, var =1) the two traits to correctly adjust the model(see Asreml-R manual for more information).</p>
<p>Lets have a look at the variance components, and notice that there are now seven (co)variance components reported in the table:</p>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">modela</span><span class="op">)</span><span class="op">$</span><span class="va">varcomp</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                           component std.error  z.ratio bound
trait:vm(animal, ainv)!trait_bwt:bwt        3.368397 0.6348307 5.305977     P
trait:vm(animal, ainv)!trait_tarsus:bwt     2.459809 1.0732644 2.291895     P
trait:vm(animal, ainv)!trait_tarsus:tarsus 12.345792 3.0744285 4.015638     P
units:trait!R                               1.000000        NA       NA     F
units:trait!trait_bwt:bwt                   3.849916 0.5200101 7.403541     P
units:trait!trait_tarsus:bwt                3.313282 0.9129234 3.629310     P
units:trait!trait_tarsus:tarsus            17.646432 2.6670380 6.616491     P
                                           %ch
trait:vm(animal, ainv)!trait_bwt:bwt         0
trait:vm(animal, ainv)!trait_tarsus:bwt      0
trait:vm(animal, ainv)!trait_tarsus:tarsus   0
units:trait!R                                0
units:trait!trait_bwt:bwt                    0
units:trait!trait_tarsus:bwt                 0
units:trait!trait_tarsus:tarsus              0</code></pre>
</div>
</div>
<p>The first three terms are related to the genetic matrix and, in order are <span class="math inline">\(V_{A,bwt}\)</span>, <span class="math inline">\(COV_A\)</span>, <span class="math inline">\(V_{A, tarsus}\)</span>. Below is again a line where the <code>units:traitr!R</code> component equals to 1, which again can be ignored. The final three terms relate to the residual matrix and correspond to <span class="math inline">\(V_{R,bwt}\)</span>, <span class="math inline">\(COV_R\)</span>, <span class="math inline">\(V_{R,tarsus}\)</span>. Based on our quick and dirty check (is <code>z.ratio</code> &gt; 1.96?) all components look to be statistically significant.</p>
<p>We can calculate the genetic correlation as <span class="math inline">\(COV_A / \sqrt{V_{A,bwt} \cdot V_{A,tarsus}}\)</span>. Thus this model gives an estimate of <span class="math inline">\(r_A\)</span> = 0.38. It is also possible to estimate the residual correlation <span class="math inline">\(r_{res}\)</span> = 0.4. <!-- C1 issue the annotation of the residual correlation--></p>
<p>Both correlations are distinct in nature. The genetic correlation reflects how much the traits are linked by genetic via polygenic effect or linkage desequilibrium, whereas the residual correlation reflects the environmental correlation or errors measurement correlation.</p>
<p>Although we can calculate this by hand, we can also use <code><a href="https://rdrr.io/pkg/asreml/man/vpredict.html">vpredict()</a></code>, which also provides an (approximate) standard error:</p>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/asreml/man/vpredict.html">vpredict</a></span><span class="op">(</span><span class="va">modela</span>, <span class="va">r_A</span> <span class="op">~</span> <span class="va">V2</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">V1</span> <span class="op">*</span> <span class="va">V3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Estimate        SE
r_A 0.3814436 0.1299759</code></pre>
</div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/asreml/man/vpredict.html">vpredict</a></span><span class="op">(</span><span class="va">modela</span>, <span class="va">r_res</span> <span class="op">~</span> <span class="va">V6</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">V5</span> <span class="op">*</span> <span class="va">V7</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Estimate         SE
r_res 0.4019799 0.08607104</code></pre>
</div>
</div>
<p>Of course we can also calculate the heritability of <code>bwt</code> and <code>tarsus</code> from this model:</p>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/asreml/man/vpredict.html">vpredict</a></span><span class="op">(</span><span class="va">modela</span>, <span class="va">h2.bwt</span> <span class="op">~</span> <span class="va">V1</span> <span class="op">/</span> <span class="op">(</span><span class="va">V1</span> <span class="op">+</span> <span class="va">V5</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Estimate         SE
h2.bwt 0.466646 0.07671533</code></pre>
</div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/asreml/man/vpredict.html">vpredict</a></span><span class="op">(</span><span class="va">modela</span>, <span class="va">h2.tarsus</span> <span class="op">~</span> <span class="va">V3</span> <span class="op">/</span> <span class="op">(</span><span class="va">V3</span> <span class="op">+</span> <span class="va">V7</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Estimate         SE
h2.tarsus 0.4116331 0.09305863</code></pre>
</div>
</div>
</section><section id="adding-fixed-and-random-effects" class="level3" data-number="7.0.2"><h3 data-number="7.0.2" class="anchored" data-anchor-id="adding-fixed-and-random-effects">
<span class="header-section-number">7.0.2</span> Adding fixed and random effects</h3>
<p>Fixed and random effects can be added just as for the univariate case. Given that our full model of bwt from tutorial 1 had sex as a fixed effect as well as birth year and mother as random effects, we could specify a bivariate formulation with the same complexity:</p>
<div class="cell">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">modelb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/asreml.html">asreml</a></span><span class="op">(</span></span>
<span>  fixed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">bwt</span>, <span class="va">tarsus</span><span class="op">)</span> <span class="op">~</span> <span class="va">trait</span> <span class="op">+</span> <span class="fu">at</span><span class="op">(</span><span class="va">trait</span><span class="op">)</span><span class="op">:</span><span class="va">sex</span>,</span>
<span>  random <span class="op">=</span> <span class="op">~</span> <span class="fu">us</span><span class="op">(</span><span class="va">trait</span>, init <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">:</span><span class="fu">vm</span><span class="op">(</span><span class="va">animal</span>, <span class="va">ainv</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">us</span><span class="op">(</span><span class="va">trait</span>, init <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">:</span><span class="va">byear</span> <span class="op">+</span></span>
<span>    <span class="fu">us</span><span class="op">(</span><span class="va">trait</span>, init <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">:</span><span class="va">mother</span>,</span>
<span>  residual <span class="op">=</span> <span class="op">~</span> <span class="fu">id</span><span class="op">(</span><span class="va">units</span><span class="op">)</span><span class="op">:</span><span class="fu">us</span><span class="op">(</span><span class="va">trait</span>, init <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">gryphon</span>,</span>
<span>  na.action <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/na.method.html">na.method</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"include"</span>, y <span class="op">=</span> <span class="st">"include"</span><span class="op">)</span>,</span>
<span>  maxit <span class="op">=</span> <span class="fl">20</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ASReml Version 4.2 25/03/2024 16:50:02
          LogLik        Sigma2     DF     wall
 1     -4672.301           1.0   1533   16:50:02
 2     -4005.616           1.0   1533   16:50:02
 3     -3271.484           1.0   1533   16:50:02  (  1 restrained)
 4     -2761.414           1.0   1533   16:50:02  (  1 restrained)
 5     -2481.355           1.0   1533   16:50:02
 6     -2395.858           1.0   1533   16:50:02
 7     -2381.050           1.0   1533   16:50:02
 8     -2380.251           1.0   1533   16:50:02
 9     -2380.246           1.0   1533   16:50:02</code></pre>
</div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">modelb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span><span class="op">(</span><span class="va">modelb</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ASReml Version 4.2 25/03/2024 16:50:02
          LogLik        Sigma2     DF     wall
 1     -2380.246           1.0   1533   16:50:02
 2     -2380.246           1.0   1533   16:50:02</code></pre>
</div>
</div>
<p>Note that we have specified a covariance structure for each random effect and an estimate of the effect of sex on both birth weight and tarsus length.</p>
<p>There will now be thirteen (co)variance components reported after running the code:</p>
<div class="cell">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">modelb</span><span class="op">)</span><span class="op">$</span><span class="va">varcomp</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                            component std.error    z.ratio
trait:byear!trait_bwt:bwt                   0.9746385 0.2825727  3.4491602
trait:byear!trait_tarsus:bwt                0.1624076 0.4185079  0.3880635
trait:byear!trait_tarsus:tarsus             3.7383721 1.2065992  3.0982716
trait:mother!trait_bwt:bwt                  1.1445184 0.2302182  4.9714512
trait:mother!trait_tarsus:bwt              -1.5567306 0.4051848 -3.8420260
trait:mother!trait_tarsus:tarsus            4.8206132 1.3201300  3.6516202
trait:vm(animal, ainv)!trait_bwt:bwt        1.9893546 0.4410246  4.5107569
trait:vm(animal, ainv)!trait_tarsus:bwt     3.3170404 0.9032323  3.6724110
trait:vm(animal, ainv)!trait_tarsus:tarsus 10.2294887 2.8077066  3.6433610
units:trait!R                               1.0000000        NA         NA
units:trait!trait_bwt:bwt                   1.8443110 0.3443178  5.3564203
units:trait!trait_tarsus:bwt                4.0142841 0.7412540  5.4155308
units:trait!trait_tarsus:tarsus            12.4845955 2.2893363  5.4533690
                                           bound %ch
trait:byear!trait_bwt:bwt                      P   0
trait:byear!trait_tarsus:bwt                   P   0
trait:byear!trait_tarsus:tarsus                P   0
trait:mother!trait_bwt:bwt                     P   0
trait:mother!trait_tarsus:bwt                  P   0
trait:mother!trait_tarsus:tarsus               P   0
trait:vm(animal, ainv)!trait_bwt:bwt           P   0
trait:vm(animal, ainv)!trait_tarsus:bwt        P   0
trait:vm(animal, ainv)!trait_tarsus:tarsus     P   0
units:trait!R                                  F   0
units:trait!trait_bwt:bwt                      P   0
units:trait!trait_tarsus:bwt                   P   0
units:trait!trait_tarsus:tarsus                P   0</code></pre>
</div>
</div>
<p>we can estimate the different correlations using <code>vpredict</code>:</p>
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/asreml/man/vpredict.html">vpredict</a></span><span class="op">(</span><span class="va">modelb</span>, <span class="va">r_byear</span> <span class="op">~</span> <span class="va">V2</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">V1</span> <span class="op">*</span> <span class="va">V3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Estimate        SE
r_byear 0.08508312 0.2134209</code></pre>
</div>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/asreml/man/vpredict.html">vpredict</a></span><span class="op">(</span><span class="va">modelb</span>, <span class="va">r_M</span> <span class="op">~</span> <span class="va">V5</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">V4</span> <span class="op">*</span> <span class="va">V6</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Estimate        SE
r_M -0.6627518 0.2487963</code></pre>
</div>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/asreml/man/vpredict.html">vpredict</a></span><span class="op">(</span><span class="va">modelb</span>, <span class="va">r_A</span> <span class="op">~</span> <span class="va">V8</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">V7</span> <span class="op">*</span> <span class="va">V9</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Estimate        SE
r_A 0.7353053 0.1094747</code></pre>
</div>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/asreml/man/vpredict.html">vpredict</a></span><span class="op">(</span><span class="va">modelb</span>, <span class="va">r_res</span> <span class="op">~</span> <span class="va">V12</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">V11</span> <span class="op">*</span> <span class="va">V13</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Estimate         SE
r_res 0.8365729 0.07366762</code></pre>
</div>
</div>
<p>Now we can look at the fixed effects parameters and assess their significance with a conditional Wald F-test: ::: {.content-visible when-format=html}</p>
<div class="cell">
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">modelb</span>, coef <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="va">coef.fi</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                            solution std error    z.ratio
trait_bwt                  6.3844483 0.2328210 27.4221324
trait_tarsus              20.5936436 0.5098944 40.3880569
at(trait, 'bwt'):sex_1     0.0000000        NA         NA
at(trait, 'bwt'):sex_2     1.9502053 0.1480467 13.1729086
at(trait, 'tarsus'):sex_1  0.0000000        NA         NA
at(trait, 'tarsus'):sex_2 -0.0684413 0.3823448 -0.1790041</code></pre>
</div>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/asreml/man/wald.asreml.html">wald.asreml</a></span><span class="op">(</span><span class="va">modelb</span>, denDF <span class="op">=</span> <span class="st">"default"</span>, ssType <span class="op">=</span> <span class="st">"conditional"</span><span class="op">)</span><span class="op">$</span><span class="va">Wald</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ASReml Version 4.2 25/03/2024 16:50:02
          LogLik        Sigma2     DF     wall
 1     -2380.246           1.0   1533   16:50:02
 2     -2380.246           1.0   1533   16:50:03</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[0;34m
Wald tests for fixed effects.[0m
[0;34mResponse: cbind(bwt, tarsus)[0m

                        Df denDF   F.inc   F.con Margin      Pr
trait                    2  52.6 1396.00 1396.00        0.00000
at(trait, 'bwt'):sex     1 812.8  298.40  173.50      B 0.00000
at(trait, 'tarsus'):sex  1 747.9    0.03    0.03      B 0.85798</code></pre>
</div>
</div>
<p>:::</p>
<p>Note that it is possible to specify a fixed effect to a specific trait by adding the number of order within <code>cbind</code> inside the argument <code>at(trait,x)</code>. For example, here we apply the fixed effect <code>sex</code> only to the response variable <code>tarsus</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">modelb_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/asreml.html">asreml</a></span><span class="op">(</span></span>
<span>  fixed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">bwt</span>, <span class="va">tarsus</span><span class="op">)</span> <span class="op">~</span> <span class="va">trait</span> <span class="op">+</span> <span class="fu">at</span><span class="op">(</span><span class="va">trait</span>, <span class="fl">2</span><span class="op">)</span><span class="op">:</span><span class="va">sex</span>,</span>
<span>  random <span class="op">=</span> <span class="op">~</span> <span class="fu">us</span><span class="op">(</span><span class="va">trait</span>, init <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">:</span><span class="fu">vm</span><span class="op">(</span><span class="va">animal</span>, <span class="va">ainv</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">us</span><span class="op">(</span><span class="va">trait</span>, init <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">:</span><span class="va">byear</span> <span class="op">+</span></span>
<span>    <span class="fu">us</span><span class="op">(</span><span class="va">trait</span>, init <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">:</span><span class="va">mother</span>,</span>
<span>  residual <span class="op">=</span> <span class="op">~</span> <span class="fu">id</span><span class="op">(</span><span class="va">units</span><span class="op">)</span><span class="op">:</span><span class="fu">us</span><span class="op">(</span><span class="va">trait</span>, init <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">gryphon</span>,</span>
<span>  na.action <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/na.method.html">na.method</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"include"</span>, y <span class="op">=</span> <span class="st">"include"</span><span class="op">)</span>,</span>
<span>  maxit <span class="op">=</span> <span class="fl">20</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ASReml Version 4.2 25/03/2024 16:50:03
          LogLik        Sigma2     DF     wall
 1     -4810.563           1.0   1534   16:50:03
 2     -4129.799           1.0   1534   16:50:03
 3     -3382.529           1.0   1534   16:50:03  (  1 restrained)
 4     -2864.076           1.0   1534   16:50:03
 5     -2574.891           1.0   1534   16:50:03
 6     -2478.879           1.0   1534   16:50:03
 7     -2458.305           1.0   1534   16:50:03
 8     -2456.425           1.0   1534   16:50:04
 9     -2456.377           1.0   1534   16:50:04
10     -2456.376           1.0   1534   16:50:04</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">modelb_2</span>, coef <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="va">coef.fi</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                           solution std error   z.ratio
trait_bwt                  7.636226 0.2389515  31.95722
trait_tarsus              22.703658 0.4827348  47.03133
at(trait, 'tarsus'):sex_1  0.000000        NA        NA
at(trait, 'tarsus'):sex_2 -3.267042 0.2953279 -11.06242</code></pre>
</div>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/asreml/man/wald.asreml.html">wald.asreml</a></span><span class="op">(</span><span class="va">modelb_2</span>, denDF <span class="op">=</span> <span class="st">"default"</span>, ssType <span class="op">=</span> <span class="st">"conditional"</span><span class="op">)</span><span class="op">$</span><span class="va">Wald</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ASReml Version 4.2 25/03/2024 16:50:04
          LogLik        Sigma2     DF     wall
 1     -2456.376           1.0   1534   16:50:04
 2     -2456.376           1.0   1534   16:50:04</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[0;34m
Wald tests for fixed effects.[0m
[0;34mResponse: cbind(bwt, tarsus)[0m

                        Df denDF  F.inc  F.con Margin Pr
trait                    2  50.7 1233.0 1233.0         0
at(trait, 'tarsus'):sex  1 522.9  122.4  122.4      B  0</code></pre>
</div>
</div>
</section><section id="significance-testing" class="level3" data-number="7.0.3"><h3 data-number="7.0.3" class="anchored" data-anchor-id="significance-testing">
<span class="header-section-number">7.0.3</span> Significance testing</h3>
<p>Under the model above <span class="math inline">\(r_M\)</span> is estimated as -0.66 and the <code>z.ratio</code> associated with the corresponding covariance (<span class="math inline">\(COV_M\)</span>) is &gt;2 (in absolute terms). We might therefore infer that there is evidence for a strong negative correlation between the traits with respect to the mother and that while maternal identity explains variance in both traits those mothers that tend to produce heavier offspring actually tend to produce offspring with shorter tarsus lengths.</p>
<p>To formally test if <span class="math inline">\(COV_M\)</span> is significantly different from zero, we can compare the log-likelihood for this model:</p>
<div class="cell">
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">modelb</span><span class="op">$</span><span class="va">loglik</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -2380.246</code></pre>
</div>
</div>
<p>to a model in which we specify that <span class="math inline">\(COV_M\)</span>=0. Since this constraint reduces the number of parameters to be estimated by one, we can use a likelihood ratio test (LRT) with one degree of freedom. To run the constrained model, we modify the G structure defined for the <code>mother</code> random effect to diagonal (<code>diag</code>), which means we only estimate the variances (the diagonal of the matrix) but not the covariance (the covariance are fixed to 0):</p>
<div class="cell">
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">modelc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/asreml.html">asreml</a></span><span class="op">(</span></span>
<span>  fixed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">bwt</span>, <span class="va">tarsus</span><span class="op">)</span> <span class="op">~</span> <span class="va">trait</span> <span class="op">+</span> <span class="fu">at</span><span class="op">(</span><span class="va">trait</span><span class="op">)</span><span class="op">:</span><span class="va">sex</span>,</span>
<span>  random <span class="op">=</span> <span class="op">~</span> <span class="fu">us</span><span class="op">(</span><span class="va">trait</span>, init <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">:</span><span class="fu">vm</span><span class="op">(</span><span class="va">animal</span>, <span class="va">ainv</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">us</span><span class="op">(</span><span class="va">trait</span>, init <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">:</span><span class="va">byear</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">trait</span>, init <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">:</span><span class="va">mother</span>,</span>
<span>  residual <span class="op">=</span> <span class="op">~</span> <span class="fu">id</span><span class="op">(</span><span class="va">units</span><span class="op">)</span><span class="op">:</span><span class="fu">us</span><span class="op">(</span><span class="va">trait</span>, init <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">gryphon</span>,</span>
<span>  na.action <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/na.method.html">na.method</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"include"</span>, y <span class="op">=</span> <span class="st">"include"</span><span class="op">)</span>,</span>
<span>  maxit <span class="op">=</span> <span class="fl">20</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ASReml Version 4.2 25/03/2024 16:50:04
          LogLik        Sigma2     DF     wall
 1     -4677.820           1.0   1533   16:50:04
 2     -4010.442           1.0   1533   16:50:04
 3     -3275.409           1.0   1533   16:50:05
 4     -2763.519           1.0   1533   16:50:05
 5     -2483.732           1.0   1533   16:50:05
 6     -2400.242           1.0   1533   16:50:05
 7     -2386.663           1.0   1533   16:50:05
 8     -2386.049           1.0   1533   16:50:05
 9     -2386.045           1.0   1533   16:50:05</code></pre>
</div>
</div>
<p>You can run <code>summary(modelc)$varcomp</code> to confirm this worked. We can now obtain the log-likelihood of this model and compare this to that of <code>modelb</code> using a likelihood ratio test:</p>
<div class="cell">
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">modelc</span><span class="op">$</span><span class="va">loglik</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -2386.045</code></pre>
</div>
</div>
<p>We can see that the model log-likelihood is now -2386.05. And comparing the models using a likelihood ratio test:</p>
<div class="cell">
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="va">modelb</span><span class="op">$</span><span class="va">loglik</span> <span class="op">-</span> <span class="va">modelc</span><span class="op">$</span><span class="va">loglik</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 11.59835</code></pre>
</div>
</div>
<p>So our chi-square test statistic is <span class="math inline">\(\chi^2_1\)</span>= 11.6. The p-value that goes with this is obtained by:</p>
<div class="cell">
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html">pchisq</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="va">modelb</span><span class="op">$</span><span class="va">loglik</span> <span class="op">-</span> <span class="va">modelc</span><span class="op">$</span><span class="va">loglik</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0006601037</code></pre>
</div>
</div>
<p>We would therefore conclude that the maternal covariance is significantly different from zero.</p>
<p>We could apply the same procedure to show that the residual (environmental) covariance and the genetic covariance estimates are significantly greater than zero (<em>i.e.</em>, heavier individuals tend to have longer tarsus lengths). In contrast, we should find that the byear covariance between the two traits is non-significant.</p>
<div class="cell">
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">modeld</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/asreml.html">asreml</a></span><span class="op">(</span></span>
<span>  fixed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">bwt</span>, <span class="va">tarsus</span><span class="op">)</span> <span class="op">~</span> <span class="va">trait</span> <span class="op">+</span> <span class="fu">at</span><span class="op">(</span><span class="va">trait</span><span class="op">)</span><span class="op">:</span><span class="va">sex</span>,</span>
<span>  random <span class="op">=</span> <span class="op">~</span> <span class="fu">us</span><span class="op">(</span><span class="va">trait</span>, init <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">:</span><span class="fu">vm</span><span class="op">(</span><span class="va">animal</span>, <span class="va">ainv</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">trait</span>, init <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">:</span><span class="va">byear</span> <span class="op">+</span></span>
<span>    <span class="fu">us</span><span class="op">(</span><span class="va">trait</span>, init <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">:</span><span class="va">mother</span>,</span>
<span>  residual <span class="op">=</span> <span class="op">~</span> <span class="fu">id</span><span class="op">(</span><span class="va">units</span><span class="op">)</span><span class="op">:</span><span class="fu">us</span><span class="op">(</span><span class="va">trait</span>, init <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">gryphon</span>,</span>
<span>  na.action <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/na.method.html">na.method</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"include"</span>, y <span class="op">=</span> <span class="st">"include"</span><span class="op">)</span>,</span>
<span>  maxit <span class="op">=</span> <span class="fl">20</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ASReml Version 4.2 25/03/2024 16:50:05
          LogLik        Sigma2     DF     wall
 1     -4672.708           1.0   1533   16:50:05
 2     -4005.954           1.0   1533   16:50:05
 3     -3271.738           1.0   1533   16:50:05  (  1 restrained)
 4     -2761.626           1.0   1533   16:50:05  (  1 restrained)
 5     -2481.647           1.0   1533   16:50:05
 6     -2395.992           1.0   1533   16:50:05
 7     -2381.136           1.0   1533   16:50:05
 8     -2380.331           1.0   1533   16:50:05
 9     -2380.326           1.0   1533   16:50:05</code></pre>
</div>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="va">modelb</span><span class="op">$</span><span class="va">loglik</span> <span class="op">-</span> <span class="va">modeld</span><span class="op">$</span><span class="va">loglik</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1600641</code></pre>
</div>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html">pchisq</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="va">modelb</span><span class="op">$</span><span class="va">loglik</span> <span class="op">-</span> <span class="va">modeld</span><span class="op">$</span><span class="va">loglik</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6890975</code></pre>
</div>
</div>
</section><section id="estimate-directly-the-genetic-correlation-within-the-model" class="level3" data-number="7.0.4"><h3 data-number="7.0.4" class="anchored" data-anchor-id="estimate-directly-the-genetic-correlation-within-the-model">
<span class="header-section-number">7.0.4</span> Estimate directly the genetic correlation within the model</h3>
<p>Within Asreml-r, different matrix structure can be specify such as <code>us</code>,<code>corg</code>, <code>diag</code>, etc (cf see the Asreml-r guide). Instead of the fitting an unstructured matrix with the argument <code>us</code> or a reduced model with no covariance with the argument <code>diag</code>, we can also directly estimate the genetic correlation between the <code>bwt</code> and <code>tarsus</code> with <code>corgh</code>.</p>
<p>Here we decide to estimate directly the additive genetic correlation.</p>
<div class="cell">
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">modele</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/asreml.html">asreml</a></span><span class="op">(</span></span>
<span>  fixed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">bwt</span>, <span class="va">tarsus</span><span class="op">)</span> <span class="op">~</span> <span class="va">trait</span> <span class="op">+</span> <span class="fu">at</span><span class="op">(</span><span class="va">trait</span><span class="op">)</span><span class="op">:</span><span class="va">sex</span>,</span>
<span>  random <span class="op">=</span> <span class="op">~</span> <span class="fu">corgh</span><span class="op">(</span><span class="va">trait</span>, init <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">:</span><span class="fu">vm</span><span class="op">(</span><span class="va">animal</span>, <span class="va">ainv</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">us</span><span class="op">(</span><span class="va">trait</span>, init <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">:</span><span class="va">byear</span> <span class="op">+</span></span>
<span>    <span class="fu">us</span><span class="op">(</span><span class="va">trait</span>, init <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">:</span><span class="va">mother</span>,</span>
<span>  residual <span class="op">=</span> <span class="op">~</span> <span class="fu">id</span><span class="op">(</span><span class="va">units</span><span class="op">)</span><span class="op">:</span><span class="fu">us</span><span class="op">(</span><span class="va">trait</span>, init <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">gryphon</span>,</span>
<span>  na.action <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/na.method.html">na.method</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"include"</span>, y <span class="op">=</span> <span class="st">"include"</span><span class="op">)</span>,</span>
<span>  maxit <span class="op">=</span> <span class="fl">20</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ASReml Version 4.2 25/03/2024 16:50:05
          LogLik        Sigma2     DF     wall
 1     -4672.301           1.0   1533   16:50:05
 2     -4003.183           1.0   1533   16:50:05
 3     -3266.521           1.0   1533   16:50:05  (  1 restrained)
 4     -2757.188           1.0   1533   16:50:05  (  1 restrained)
 5     -2479.291           1.0   1533   16:50:05
 6     -2395.476           1.0   1533   16:50:05
 7     -2381.026           1.0   1533   16:50:05
 8     -2380.251           1.0   1533   16:50:05
 9     -2380.246           1.0   1533   16:50:05</code></pre>
</div>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">modele</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span><span class="op">(</span><span class="va">modele</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ASReml Version 4.2 25/03/2024 16:50:06
          LogLik        Sigma2     DF     wall
 1     -2380.246           1.0   1533   16:50:06
 2     -2380.246           1.0   1533   16:50:06</code></pre>
</div>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">modele</span><span class="op">)</span><span class="op">$</span><span class="va">varcomp</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                    component std.error
trait:byear!trait_bwt:bwt                           0.9746386 0.2825728
trait:byear!trait_tarsus:bwt                        0.1624071 0.4185082
trait:byear!trait_tarsus:tarsus                     3.7383734 1.2066018
trait:mother!trait_bwt:bwt                          1.1445186 0.2302183
trait:mother!trait_tarsus:bwt                      -1.5567316 0.4051850
trait:mother!trait_tarsus:tarsus                    4.8206154 1.3201324
trait:vm(animal, ainv)!trait!tarsus:!trait!bwt.cor  0.7353061 0.1094807
trait:vm(animal, ainv)!trait_bwt                    1.9893543 0.4410243
trait:vm(animal, ainv)!trait_tarsus                10.2294850 2.8077055
units:trait!R                                       1.0000000        NA
units:trait!trait_bwt:bwt                           1.8443112 0.3443178
units:trait!trait_tarsus:bwt                        4.0142825 0.7412540
units:trait!trait_tarsus:tarsus                    12.4845977 2.2893355
                                                     z.ratio bound %ch
trait:byear!trait_bwt:bwt                           3.449159     P   0
trait:byear!trait_tarsus:bwt                        0.388062     P   0
trait:byear!trait_tarsus:tarsus                     3.098266     P   0
trait:mother!trait_bwt:bwt                          4.971450     P   0
trait:mother!trait_tarsus:bwt                      -3.842027     P   0
trait:mother!trait_tarsus:tarsus                    3.651615     P   0
trait:vm(animal, ainv)!trait!tarsus:!trait!bwt.cor  6.716310     U   0
trait:vm(animal, ainv)!trait_bwt                    4.510758     P   0
trait:vm(animal, ainv)!trait_tarsus                 3.643361     P   0
units:trait!R                                             NA     F   0
units:trait!trait_bwt:bwt                           5.356422     P   0
units:trait!trait_tarsus:bwt                        5.415529     P   0
units:trait!trait_tarsus:tarsus                     5.453372     P   0</code></pre>
</div>
</div>
<p>It is important to note that using <code>corgh</code> change the order of the estimate (co)variance/correlation. Thus, the initial values need to be reorder and all different calculation need to be adjust in consequence. It is also important to check the difference between the model with <code>us</code> and <code>corgh</code> to make sure any mistake are made.</p>
<div class="cell">
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">modelb</span><span class="op">)</span><span class="op">$</span><span class="va">loglik</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -2380.246</code></pre>
</div>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">modele</span><span class="op">)</span><span class="op">$</span><span class="va">loglik</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -2380.246</code></pre>
</div>
</div>
<p>There two main advantages to use <code>corgh</code>: first, a direct estimation of correlation within the G matrix can avoid mistake in the <code>vpredict</code> calculation; second, it is possible to test if the correlation is significantly different than 0 (similar result as LRT with the covariance) but also to -1 and 1 which correspond of the correlation boundaries. The following code showed how to create a reduced model with the correlation close to 1 and compared to the initial model. Since we compared the correlation to its boundary, the degree of freedom is only half as a one tail LTR.</p>
<div class="cell">
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">MODEL_MODIF</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/update.asreml.html">update.asreml</a></span><span class="op">(</span><span class="va">modele</span>, start.values <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="va">G_MOD</span> <span class="op">&lt;-</span> <span class="va">MODEL_MODIF</span><span class="op">$</span><span class="va">vparameters.table</span><span class="op">[</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="va">G_MOD</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.99999</span></span>
<span><span class="va">G_MOD</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"F"</span></span>
<span><span class="va">modele.red</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/asreml.html">asreml</a></span><span class="op">(</span></span>
<span>  fixed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">bwt</span>, <span class="va">tarsus</span><span class="op">)</span> <span class="op">~</span> <span class="va">trait</span> <span class="op">+</span> <span class="fu">at</span><span class="op">(</span><span class="va">trait</span><span class="op">)</span><span class="op">:</span><span class="va">sex</span>,</span>
<span>  random <span class="op">=</span> <span class="op">~</span> <span class="fu">corgh</span><span class="op">(</span><span class="va">trait</span>, init <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">:</span><span class="fu">vm</span><span class="op">(</span><span class="va">animal</span>, <span class="va">ainv</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">us</span><span class="op">(</span><span class="va">trait</span>, init <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">:</span><span class="va">byear</span> <span class="op">+</span></span>
<span>    <span class="fu">us</span><span class="op">(</span><span class="va">trait</span>, init <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">:</span><span class="va">mother</span>,</span>
<span>  residual <span class="op">=</span> <span class="op">~</span> <span class="fu">id</span><span class="op">(</span><span class="va">units</span><span class="op">)</span><span class="op">:</span><span class="fu">us</span><span class="op">(</span><span class="va">trait</span>, init <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">gryphon</span>,</span>
<span>  na.action <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/na.method.html">na.method</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"include"</span>, y <span class="op">=</span> <span class="st">"include"</span><span class="op">)</span>,</span>
<span>  maxit <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  G.param <span class="op">=</span> <span class="va">G_MOD</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ASReml Version 4.2 25/03/2024 16:50:06
          LogLik        Sigma2     DF     wall
 1     -2545.233           1.0   1533   16:50:06
 2     -2483.883           1.0   1533   16:50:06
 3     -2423.504           1.0   1533   16:50:06
 4     -2392.509           1.0   1533   16:50:06
 5     -2383.661           1.0   1533   16:50:06
 6     -2383.084           1.0   1533   16:50:06
 7     -2383.033           1.0   1533   16:50:06
 8     -2383.022           1.0   1533   16:50:06
 9     -2383.019           1.0   1533   16:50:06
10     -2383.019           1.0   1533   16:50:06</code></pre>
</div>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="va">modele</span><span class="op">$</span><span class="va">loglik</span> <span class="op">-</span> <span class="va">modele.red</span><span class="op">$</span><span class="va">loglik</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.544679</code></pre>
</div>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html">pchisq</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="va">modele</span><span class="op">$</span><span class="va">loglik</span> <span class="op">-</span> <span class="va">modele.red</span><span class="op">$</span><span class="va">loglik</span><span class="op">)</span>, df <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.006598676</code></pre>
</div>
</div>
<p>Here, the correlation is significantly different than 1 (~0.99999).</p>
</section><section id="visualisation-of-the-correlation-aka-blup-extraction" class="level3" data-number="7.0.5"><h3 data-number="7.0.5" class="anchored" data-anchor-id="visualisation-of-the-correlation-aka-blup-extraction">
<span class="header-section-number">7.0.5</span> Visualisation of the correlation (aka BLUP extraction)</h3>
<p>When estimating correlation between traits, having a visualization of it can help the interpretation. In addition, visualizing the correlation can spot outliers in the dataset. Thanks to mixed model, each breeding values is stored within the model and can be extract as BLUP (Best Linear Unbiased Predictor).BLUP should be normaly distributed, if not you need to check the assumption of your animal model.</p>
<p>To simplify the following code, we rename the variable T1 and T2.</p>
<div class="cell">
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">gryphon</span><span class="op">$</span><span class="va">T1</span> <span class="op">&lt;-</span> <span class="va">gryphon</span><span class="op">$</span><span class="va">bwt</span></span>
<span><span class="va">gryphon</span><span class="op">$</span><span class="va">T2</span> <span class="op">&lt;-</span> <span class="va">gryphon</span><span class="op">$</span><span class="va">tarsus</span></span>
<span><span class="co">############</span></span>
<span><span class="va">modele</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/asreml.html">asreml</a></span><span class="op">(</span></span>
<span>  fixed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">T1</span>, <span class="va">T2</span><span class="op">)</span> <span class="op">~</span> <span class="va">trait</span> <span class="op">+</span> <span class="fu">at</span><span class="op">(</span><span class="va">trait</span><span class="op">)</span><span class="op">:</span><span class="va">sex</span>,</span>
<span>  random <span class="op">=</span> <span class="op">~</span> <span class="fu">corgh</span><span class="op">(</span><span class="va">trait</span>, init <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">:</span><span class="fu">vm</span><span class="op">(</span><span class="va">animal</span>, <span class="va">ainv</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">us</span><span class="op">(</span><span class="va">trait</span>, init <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">:</span><span class="va">byear</span> <span class="op">+</span></span>
<span>    <span class="fu">us</span><span class="op">(</span><span class="va">trait</span>, init <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">:</span><span class="va">mother</span>,</span>
<span>  residual <span class="op">=</span> <span class="op">~</span> <span class="fu">id</span><span class="op">(</span><span class="va">units</span><span class="op">)</span><span class="op">:</span><span class="fu">us</span><span class="op">(</span><span class="va">trait</span>, init <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">gryphon</span>,</span>
<span>  na.action <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/na.method.html">na.method</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"include"</span>, y <span class="op">=</span> <span class="st">"include"</span><span class="op">)</span>,</span>
<span>  maxit <span class="op">=</span> <span class="fl">20</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ASReml Version 4.2 25/03/2024 16:50:06
          LogLik        Sigma2     DF     wall
 1     -4672.301           1.0   1533   16:50:06
 2     -4003.183           1.0   1533   16:50:06
 3     -3266.521           1.0   1533   16:50:07  (  1 restrained)
 4     -2757.188           1.0   1533   16:50:07  (  1 restrained)
 5     -2479.291           1.0   1533   16:50:07
 6     -2395.476           1.0   1533   16:50:07
 7     -2381.026           1.0   1533   16:50:07
 8     -2380.251           1.0   1533   16:50:07
 9     -2380.246           1.0   1533   16:50:07</code></pre>
</div>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">modele</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span><span class="op">(</span><span class="va">modele</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ASReml Version 4.2 25/03/2024 16:50:07
          LogLik        Sigma2     DF     wall
 1     -2380.246           1.0   1533   16:50:07
 2     -2380.246           1.0   1533   16:50:07</code></pre>
</div>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">modele</span><span class="op">)</span><span class="op">$</span><span class="va">varcomp</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                               component std.error   z.ratio
trait:byear!trait_T1:T1                        0.9746386 0.2825728  3.449159
trait:byear!trait_T2:T1                        0.1624071 0.4185082  0.388062
trait:byear!trait_T2:T2                        3.7383734 1.2066018  3.098266
trait:mother!trait_T1:T1                       1.1445186 0.2302183  4.971450
trait:mother!trait_T2:T1                      -1.5567316 0.4051850 -3.842027
trait:mother!trait_T2:T2                       4.8206154 1.3201324  3.651615
trait:vm(animal, ainv)!trait!T2:!trait!T1.cor  0.7353061 0.1094807  6.716310
trait:vm(animal, ainv)!trait_T1                1.9893543 0.4410243  4.510758
trait:vm(animal, ainv)!trait_T2               10.2294850 2.8077055  3.643361
units:trait!R                                  1.0000000        NA        NA
units:trait!trait_T1:T1                        1.8443112 0.3443178  5.356422
units:trait!trait_T2:T1                        4.0142825 0.7412540  5.415529
units:trait!trait_T2:T2                       12.4845977 2.2893355  5.453372
                                              bound %ch
trait:byear!trait_T1:T1                           P   0
trait:byear!trait_T2:T1                           P   0
trait:byear!trait_T2:T2                           P   0
trait:mother!trait_T1:T1                          P   0
trait:mother!trait_T2:T1                          P   0
trait:mother!trait_T2:T2                          P   0
trait:vm(animal, ainv)!trait!T2:!trait!T1.cor     U   0
trait:vm(animal, ainv)!trait_T1                   P   0
trait:vm(animal, ainv)!trait_T2                   P   0
units:trait!R                                     F   0
units:trait!trait_T1:T1                           P   0
units:trait!trait_T2:T1                           P   0
units:trait!trait_T2:T2                           P   0</code></pre>
</div>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">############</span></span>
<span><span class="va">DvsS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  Trait <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">modele</span><span class="op">$</span><span class="va">coefficients</span><span class="op">$</span><span class="va">random</span><span class="op">)</span>,</span>
<span>  BLUP <span class="op">=</span> <span class="va">modele</span><span class="op">$</span><span class="va">coefficients</span><span class="op">$</span><span class="va">random</span>,</span>
<span>  SE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">modele</span><span class="op">$</span><span class="va">vcoeff</span><span class="op">$</span><span class="va">random</span> <span class="op">*</span> <span class="va">modele</span><span class="op">$</span><span class="va">sigma2</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">DvsS</span><span class="op">$</span><span class="va">ID</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="va">DvsS</span><span class="op">$</span><span class="va">Trait</span>, <span class="fl">27</span>, <span class="fl">30</span><span class="op">)</span></span>
<span><span class="va">DvsS</span><span class="op">$</span><span class="va">TRAIT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="va">DvsS</span><span class="op">$</span><span class="va">Trait</span>, <span class="fl">7</span>, <span class="fl">8</span><span class="op">)</span></span>
<span><span class="va">DvsS</span> <span class="op">&lt;-</span> <span class="va">DvsS</span><span class="op">[</span><span class="fl">927</span><span class="op">:</span><span class="fl">3544</span>, <span class="op">]</span> <span class="co"># keep only row associated to animal</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">DvsS</span><span class="op">$</span><span class="va">TRAIT</span><span class="op">)</span><span class="op">)</span> <span class="co"># 1309 each</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  T1   T2 
 846 1772 </code></pre>
</div>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#</span></span>
<span><span class="va">DvsS</span><span class="op">$</span><span class="va">Trait</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">DvsS</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"BLUP"</span></span>
<span><span class="va">BLUPS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/reshape.html">reshape</a></span><span class="op">(</span><span class="va">DvsS</span>, v.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"BLUP"</span>, <span class="st">"SE"</span><span class="op">)</span>, idvar <span class="op">=</span> <span class="st">"ID"</span>, timevar <span class="op">=</span> <span class="st">"TRAIT"</span>, direction <span class="op">=</span> <span class="st">"wide"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in reshapeWide(data, idvar = idvar, timevar = timevar, varying =
varying, : multiple rows match for TRAIT=T1: first taken</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in reshapeWide(data, idvar = idvar, timevar = timevar, varying =
varying, : multiple rows match for TRAIT=T2: first taken</code></pre>
</div>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">BLUPS</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1310</code></pre>
</div>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">BLUPS</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">BLUPS</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ID"</span>, <span class="st">"BLUP.btw"</span>, <span class="st">"SE.btw"</span>, <span class="st">"BLUP.tarsus"</span>, <span class="st">"SE.tarsus"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">BLUPS</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      ID               BLUP.btw           SE.btw        BLUP.tarsus      
 Length:1310        Min.   :-2.3778   Min.   :0.7494   Min.   :-6.34104  
 Class :character   1st Qu.:-0.5797   1st Qu.:0.9993   1st Qu.:-1.14403  
 Mode  :character   Median : 0.0350   Median :1.0223   Median :-0.02524  
                    Mean   :-0.0082   Mean   :1.0640   Mean   : 0.02189  
                    3rd Qu.: 0.5911   3rd Qu.:1.0552   3rd Qu.: 1.17735  
                    Max.   : 3.0123   Max.   :1.4377   Max.   : 6.71502  
                    NA's   :926       NA's   :926                        
   SE.tarsus    
 Min.   :1.616  
 1st Qu.:2.371  
 Median :2.451  
 Mean   :2.576  
 3rd Qu.:2.810  
 Max.   :3.287  
                </code></pre>
</div>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># write.csv(BLUPS,file="BLUPS_6x6.csv",row.names=F)</span></span>
<span><span class="co">############</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">BLUPS</span><span class="op">$</span><span class="va">BLUP.btw</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="va">BLUPS</span><span class="op">$</span><span class="va">BLUP.btw</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqline</a></span><span class="op">(</span><span class="va">BLUPS</span><span class="op">$</span><span class="va">BLUP.btw</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">BLUPS</span><span class="op">$</span><span class="va">BLUP.tarsus</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="va">BLUPS</span><span class="op">$</span><span class="va">BLUP.tarsus</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqline</a></span><span class="op">(</span><span class="va">BLUPS</span><span class="op">$</span><span class="va">BLUP.tarsus</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="03_01-biv_asreml_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb94"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here, some simple code to plot the genetic correlation.</p>
<div class="cell">
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">BLUP.tarsus</span> <span class="op">~</span> <span class="va">BLUP.btw</span>, <span class="va">BLUPS</span>, xlab <span class="op">=</span> <span class="st">""</span>, ylab <span class="op">=</span> <span class="st">""</span>, las <span class="op">=</span> <span class="fl">1.2</span>, bty <span class="op">=</span> <span class="st">"o"</span>, col <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/arrows.html">arrows</a></span><span class="op">(</span>x0 <span class="op">=</span> <span class="va">BLUPS</span><span class="op">$</span><span class="va">BLUP.btw</span>, y0 <span class="op">=</span> <span class="va">BLUPS</span><span class="op">$</span><span class="va">BLUP.tarsus</span> <span class="op">-</span> <span class="va">BLUPS</span><span class="op">$</span><span class="va">SE.tarsus</span>, x1 <span class="op">=</span> <span class="va">BLUPS</span><span class="op">$</span><span class="va">BLUP.btw</span>, y1 <span class="op">=</span> <span class="va">BLUPS</span><span class="op">$</span><span class="va">BLUP.tarsus</span> <span class="op">+</span> <span class="va">BLUPS</span><span class="op">$</span><span class="va">SE.tarsus</span>, col <span class="op">=</span> <span class="st">"black"</span>, code <span class="op">=</span> <span class="fl">3</span>, angle <span class="op">=</span> <span class="fl">90</span>, length <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/arrows.html">arrows</a></span><span class="op">(</span>x0 <span class="op">=</span> <span class="va">BLUPS</span><span class="op">$</span><span class="va">BLUP.btw</span> <span class="op">-</span> <span class="va">BLUPS</span><span class="op">$</span><span class="va">SE.btw</span>, y0 <span class="op">=</span> <span class="va">BLUPS</span><span class="op">$</span><span class="va">BLUP.tarsus</span>, x1 <span class="op">=</span> <span class="va">BLUPS</span><span class="op">$</span><span class="va">BLUP.btw</span> <span class="op">+</span> <span class="va">BLUPS</span><span class="op">$</span><span class="va">SE.btw</span>, y1 <span class="op">=</span> <span class="va">BLUPS</span><span class="op">$</span><span class="va">BLUP.tarsus</span>, col <span class="op">=</span> <span class="st">"black"</span>, code <span class="op">=</span> <span class="fl">3</span>, angle <span class="op">=</span> <span class="fl">90</span>, length <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">BLUP.tarsus</span> <span class="op">~</span> <span class="va">BLUP.btw</span>, <span class="va">BLUPS</span>, pch <span class="op">=</span> <span class="fl">16</span>, col <span class="op">=</span> <span class="st">"red"</span>, cex <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">BLUP.tarsus</span> <span class="op">~</span> <span class="va">BLUP.btw</span>, <span class="va">BLUPS</span>, pch <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0.3</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span><span class="op">(</span><span class="st">"btw (BVSE)"</span>, side <span class="op">=</span> <span class="fl">1</span>, line <span class="op">=</span> <span class="fl">2.4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span><span class="op">(</span><span class="st">"tarsus (BVSE)"</span>, side <span class="op">=</span> <span class="fl">2</span>, line <span class="op">=</span> <span class="fl">2</span>, las <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="fu">italic</span><span class="op">(</span><span class="va">r</span><span class="op">)</span><span class="op">[</span><span class="va">A</span><span class="op">]</span>, <span class="st">" = 0.7353065   0.1094838"</span><span class="op">)</span><span class="op">)</span>, side <span class="op">=</span> <span class="fl">1</span>, line <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, adj <span class="op">=</span> <span class="fl">0.95</span>, cex <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="03_01-biv_asreml_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="partitionning-covariance-between-groups" class="level3" data-number="7.0.6"><h3 data-number="7.0.6" class="anchored" data-anchor-id="partitionning-covariance-between-groups">
<span class="header-section-number">7.0.6</span> Partitionning (co)variance between groups</h3>
<p>Similar to the univariate model, it is possible to partition the variance and also the covariance between different groups within the dataset. Here, we can estimate sex-specific genetic correlation. Note, to partition a correlation, it is require to have important sample size within each group. For this example, we simplify the model !</p>
<div class="cell">
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">gryphon</span> <span class="op">&lt;-</span> <span class="va">gryphon</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">gryphon</span><span class="op">$</span><span class="va">sex</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="va">model_sex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/asreml.html">asreml</a></span><span class="op">(</span></span>
<span>  fixed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">bwt</span>, <span class="va">tarsus</span><span class="op">)</span> <span class="op">~</span> <span class="va">trait</span> <span class="op">+</span> <span class="fu">at</span><span class="op">(</span><span class="va">trait</span><span class="op">)</span><span class="op">:</span><span class="va">sex</span>,</span>
<span>  random <span class="op">=</span> <span class="op">~</span> <span class="fu">at</span><span class="op">(</span><span class="va">sex</span><span class="op">)</span><span class="op">:</span><span class="fu">us</span><span class="op">(</span><span class="va">trait</span>, init <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">:</span><span class="fu">vm</span><span class="op">(</span><span class="va">animal</span>, <span class="va">ainv</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">us</span><span class="op">(</span><span class="va">trait</span>, init <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">:</span><span class="va">byear</span> <span class="op">+</span></span>
<span>    <span class="fu">us</span><span class="op">(</span><span class="va">trait</span>, init <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">:</span><span class="va">mother</span>,</span>
<span>  residual <span class="op">=</span> <span class="op">~</span> <span class="fu">dsum</span><span class="op">(</span><span class="op">~</span> <span class="fu">id</span><span class="op">(</span><span class="va">units</span><span class="op">)</span><span class="op">:</span><span class="fu">us</span><span class="op">(</span><span class="va">trait</span><span class="op">)</span> <span class="op">|</span> <span class="va">sex</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">gryphon</span>,</span>
<span>  na.action <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/na.method.html">na.method</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"include"</span>, y <span class="op">=</span> <span class="st">"include"</span><span class="op">)</span>,</span>
<span>  maxit <span class="op">=</span> <span class="fl">20</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ASReml Version 4.2 25/03/2024 16:50:08
          LogLik        Sigma2     DF     wall
 1     -2522.729           1.0   1807   16:50:09  (  1 restrained)
 2     -2459.512           1.0   1807   16:50:09  (  3 restrained)
 3     -2408.940           1.0   1807   16:50:10
 4     -2392.691           1.0   1807   16:50:10
 5     -2388.962           1.0   1807   16:50:10
 6     -2388.743           1.0   1807   16:50:11
 7     -2388.736           1.0   1807   16:50:11
 8     -2388.736           1.0   1807   16:50:11</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in asreml(fixed = cbind(bwt, tarsus) ~ trait + at(trait):sex, random =
~at(sex):us(trait, : Warning : US updates modified 1 times in iteration 2 to
remain positive definite.</code></pre>
</div>
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">model_sex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span><span class="op">(</span><span class="va">model_sex</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ASReml Version 4.2 25/03/2024 16:50:11
          LogLik        Sigma2     DF     wall
 1     -2388.736           1.0   1807   16:50:11
 2     -2388.736           1.0   1807   16:50:12</code></pre>
</div>
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model_sex</span><span class="op">)</span><span class="op">$</span><span class="va">varcomp</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                         component std.error
trait:byear!trait_bwt:bwt                                0.9858478 0.2863878
trait:byear!trait_tarsus:bwt                             0.1525063 0.4334263
trait:byear!trait_tarsus:tarsus                          3.9981983 1.2798747
trait:mother!trait_bwt:bwt                               1.3312734 0.2484444
trait:mother!trait_tarsus:bwt                           -1.6174228 0.4283851
trait:mother!trait_tarsus:tarsus                         4.7542338 1.3546517
at(sex, '1'):trait:vm(animal, ainv)!trait_bwt:bwt        1.3402853 0.5670773
at(sex, '1'):trait:vm(animal, ainv)!trait_tarsus:bwt     2.3608392 1.1348473
at(sex, '1'):trait:vm(animal, ainv)!trait_tarsus:tarsus  6.0625993 3.1304394
at(sex, '2'):trait:vm(animal, ainv)!trait_bwt:bwt        1.8645998 0.8888206
at(sex, '2'):trait:vm(animal, ainv)!trait_tarsus:bwt     5.0954811 2.0684729
at(sex, '2'):trait:vm(animal, ainv)!trait_tarsus:tarsus 14.9771870 6.4479787
sex_1!R                                                  1.0000000        NA
sex_1!trait_bwt:bwt                                      2.3079850 0.5015651
sex_1!trait_tarsus:bwt                                   4.4287898 1.0376370
sex_1!trait_tarsus:tarsus                               13.4857819 2.9284922
sex_2!R                                                  1.0000000        NA
sex_2!trait_bwt:bwt                                      1.7956612 0.7549779
sex_2!trait_tarsus:bwt                                   2.6340448 1.7685804
sex_2!trait_tarsus:tarsus                                9.6094528 5.4917853
                                                           z.ratio bound %ch
trait:byear!trait_bwt:bwt                                3.4423530     P   0
trait:byear!trait_tarsus:bwt                             0.3518622     P   0
trait:byear!trait_tarsus:tarsus                          3.1238982     P   0
trait:mother!trait_bwt:bwt                               5.3584371     P   0
trait:mother!trait_tarsus:bwt                           -3.7756279     P   0
trait:mother!trait_tarsus:tarsus                         3.5095618     P   0
at(sex, '1'):trait:vm(animal, ainv)!trait_bwt:bwt        2.3634965     P   0
at(sex, '1'):trait:vm(animal, ainv)!trait_tarsus:bwt     2.0803144     P   0
at(sex, '1'):trait:vm(animal, ainv)!trait_tarsus:tarsus  1.9366608     P   0
at(sex, '2'):trait:vm(animal, ainv)!trait_bwt:bwt        2.0978361     P   0
at(sex, '2'):trait:vm(animal, ainv)!trait_tarsus:bwt     2.4634024     P   0
at(sex, '2'):trait:vm(animal, ainv)!trait_tarsus:tarsus  2.3227724     P   0
sex_1!R                                                         NA     F   0
sex_1!trait_bwt:bwt                                      4.6015657     P   0
sex_1!trait_tarsus:bwt                                   4.2681493     P   0
sex_1!trait_tarsus:tarsus                                4.6050257     P   0
sex_2!R                                                         NA     F   0
sex_2!trait_bwt:bwt                                      2.3784288     P   0
sex_2!trait_tarsus:bwt                                   1.4893554     P   0
sex_2!trait_tarsus:tarsus                                1.7497867     P   0</code></pre>
</div>
</div>
<p>we can estimate the different correlations using <code>vpredict</code>:</p>
<div class="cell">
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/asreml/man/vpredict.html">vpredict</a></span><span class="op">(</span><span class="va">model_sex</span>, <span class="va">r_byear</span> <span class="op">~</span> <span class="va">V2</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">V1</span> <span class="op">*</span> <span class="va">V3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Estimate       SE
r_byear 0.07681584 0.213141</code></pre>
</div>
<div class="sourceCode" id="cb105"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/asreml/man/vpredict.html">vpredict</a></span><span class="op">(</span><span class="va">model_sex</span>, <span class="va">r_M</span> <span class="op">~</span> <span class="va">V5</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">V4</span> <span class="op">*</span> <span class="va">V6</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Estimate       SE
r_M -0.6429092 0.248944</code></pre>
</div>
<div class="sourceCode" id="cb107"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/asreml/man/vpredict.html">vpredict</a></span><span class="op">(</span><span class="va">model_sex</span>, <span class="va">r_A.1</span> <span class="op">~</span> <span class="va">V8</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">V7</span> <span class="op">*</span> <span class="va">V9</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Estimate        SE
r_A.1 0.8282059 0.1723596</code></pre>
</div>
<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/asreml/man/vpredict.html">vpredict</a></span><span class="op">(</span><span class="va">model_sex</span>, <span class="va">r_A.2</span> <span class="op">~</span> <span class="va">V11</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">V10</span> <span class="op">*</span> <span class="va">V12</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Estimate        SE
r_A.2 0.9642225 0.1241668</code></pre>
</div>
<div class="sourceCode" id="cb111"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/asreml/man/vpredict.html">vpredict</a></span><span class="op">(</span><span class="va">model_sex</span>, <span class="va">r_res.1</span> <span class="op">~</span> <span class="va">V15</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">V14</span> <span class="op">*</span> <span class="va">V16</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Estimate         SE
r_res.1 0.7938355 0.07892634</code></pre>
</div>
<div class="sourceCode" id="cb113"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/asreml/man/vpredict.html">vpredict</a></span><span class="op">(</span><span class="va">model_sex</span>, <span class="va">r_res.2</span> <span class="op">~</span> <span class="va">V19</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">V18</span> <span class="op">*</span> <span class="va">V20</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Estimate        SE
r_res.2 0.6341057 0.1894837</code></pre>
</div>
</div>
<p>and the heritability too:</p>
<div class="cell">
<div class="sourceCode" id="cb115"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/asreml/man/vpredict.html">vpredict</a></span><span class="op">(</span><span class="va">model_sex</span>, <span class="va">h2.bwt.1</span> <span class="op">~</span> <span class="va">V7</span> <span class="op">/</span> <span class="op">(</span><span class="va">V1</span> <span class="op">+</span> <span class="va">V4</span> <span class="op">+</span> <span class="va">V7</span> <span class="op">+</span> <span class="va">V14</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Estimate         SE
h2.bwt.1 0.2246768 0.09176827</code></pre>
</div>
<div class="sourceCode" id="cb117"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/asreml/man/vpredict.html">vpredict</a></span><span class="op">(</span><span class="va">model_sex</span>, <span class="va">h2.bwt.2</span> <span class="op">~</span> <span class="va">V10</span> <span class="op">/</span> <span class="op">(</span><span class="va">V1</span> <span class="op">+</span> <span class="va">V4</span> <span class="op">+</span> <span class="va">V10</span> <span class="op">+</span> <span class="va">V18</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Estimate        SE
h2.bwt.2 0.3119425 0.1442547</code></pre>
</div>
<div class="sourceCode" id="cb119"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/asreml/man/vpredict.html">vpredict</a></span><span class="op">(</span><span class="va">model_sex</span>, <span class="va">h2.tarsus.1</span> <span class="op">~</span> <span class="va">V9</span> <span class="op">/</span> <span class="op">(</span><span class="va">V3</span> <span class="op">+</span> <span class="va">V6</span> <span class="op">+</span> <span class="va">V9</span> <span class="op">+</span> <span class="va">V16</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Estimate        SE
h2.tarsus.1  0.21422 0.1070464</code></pre>
</div>
<div class="sourceCode" id="cb121"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/asreml/man/vpredict.html">vpredict</a></span><span class="op">(</span><span class="va">model_sex</span>, <span class="va">h2.tarsus.2</span> <span class="op">~</span> <span class="va">V12</span> <span class="op">/</span> <span class="op">(</span><span class="va">V3</span> <span class="op">+</span> <span class="va">V6</span> <span class="op">+</span> <span class="va">V12</span> <span class="op">+</span> <span class="va">V20</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Estimate        SE
h2.tarsus.2 0.4492383 0.1833858</code></pre>
</div>
</div>
<p>Now we can look at the fixed effects parameters and assess their significance with a conditional Wald F-test:</p>
<div class="cell">
<div class="sourceCode" id="cb123"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model_sex</span>, coef <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="va">coef.fi</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                            solution std error    z.ratio
trait_bwt                  6.3779149 0.2311766 27.5889321
trait_tarsus              20.5838787 0.4942649 41.6454395
at(trait, 'bwt'):sex_1     0.0000000        NA         NA
at(trait, 'bwt'):sex_2     1.9393688 0.1903239 10.1898321
at(trait, 'tarsus'):sex_1  0.0000000        NA         NA
at(trait, 'tarsus'):sex_2 -0.0554799 0.4758708 -0.1165861</code></pre>
</div>
<div class="sourceCode" id="cb125"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/asreml/man/wald.asreml.html">wald.asreml</a></span><span class="op">(</span><span class="va">model_sex</span>, denDF <span class="op">=</span> <span class="st">"default"</span>, ssType <span class="op">=</span> <span class="st">"conditional"</span><span class="op">)</span><span class="op">$</span><span class="va">Wald</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ASReml Version 4.2 25/03/2024 16:50:12
          LogLik        Sigma2     DF     wall
 1     -2388.736           1.0   1807   16:50:12
 2     -2388.736           1.0   1807   16:50:12</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[0;34m
Wald tests for fixed effects.[0m
[0;34mResponse: cbind(bwt, tarsus)[0m

                        Df denDF   F.inc   F.con Margin      Pr
trait                    2  44.8 1522.00 1522.00        0.00000
at(trait, 'bwt'):sex     1 137.5  220.90  103.80      B 0.00000
at(trait, 'tarsus'):sex  1 138.6    0.01    0.01      B 0.90737</code></pre>
</div>
</div>
<p>To assess the significant of the covariance, a LTR test can be done with a reduced model where a specific covariance can be fixed to 0 (for example the female covariance, following code).</p>
<div class="cell">
<div class="sourceCode" id="cb128"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">model_modif</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/update.asreml.html">update.asreml</a></span><span class="op">(</span><span class="va">model_sex</span>, start.values <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="va">G</span> <span class="op">&lt;-</span> <span class="va">model_modif</span><span class="op">$</span><span class="va">vparameters</span><span class="op">[</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="va">G</span><span class="op">$</span><span class="va">Constraint</span><span class="op">[</span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"F"</span></span>
<span><span class="va">G</span><span class="op">$</span><span class="va">Value</span><span class="op">[</span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="co">#</span></span>
<span><span class="va">reduc.model_sex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/asreml.html">asreml</a></span><span class="op">(</span></span>
<span>  fixed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">bwt</span>, <span class="va">tarsus</span><span class="op">)</span> <span class="op">~</span> <span class="va">trait</span> <span class="op">+</span> <span class="fu">at</span><span class="op">(</span><span class="va">trait</span><span class="op">)</span><span class="op">:</span><span class="va">sex</span>,</span>
<span>  random <span class="op">=</span> <span class="op">~</span> <span class="fu">at</span><span class="op">(</span><span class="va">sex</span><span class="op">)</span><span class="op">:</span><span class="fu">us</span><span class="op">(</span><span class="va">trait</span>, init <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">:</span><span class="fu">vm</span><span class="op">(</span><span class="va">animal</span>, <span class="va">ainv</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">us</span><span class="op">(</span><span class="va">trait</span>, init <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">:</span><span class="va">byear</span> <span class="op">+</span></span>
<span>    <span class="fu">us</span><span class="op">(</span><span class="va">trait</span>, init <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">:</span><span class="va">mother</span>,</span>
<span>  residual <span class="op">=</span> <span class="op">~</span> <span class="fu">dsum</span><span class="op">(</span><span class="op">~</span> <span class="fu">id</span><span class="op">(</span><span class="va">units</span><span class="op">)</span><span class="op">:</span><span class="fu">us</span><span class="op">(</span><span class="va">trait</span><span class="op">)</span> <span class="op">|</span> <span class="va">sex</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">gryphon</span>,</span>
<span>  na.action <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/na.method.html">na.method</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"include"</span>, y <span class="op">=</span> <span class="st">"include"</span><span class="op">)</span>,</span>
<span>  maxit <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  G.param <span class="op">=</span> <span class="va">G</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ASReml Version 4.2 25/03/2024 16:50:16
          LogLik        Sigma2     DF     wall
 1     -2474.972           1.0   1807   16:50:16  (  3 restrained)
 2     -2406.283           1.0   1807   16:50:16
 3     -2394.010           1.0   1807   16:50:17
 4     -2391.718           1.0   1807   16:50:17
 5     -2391.480           1.0   1807   16:50:17
 6     -2391.477           1.0   1807   16:50:18</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in asreml(fixed = cbind(bwt, tarsus) ~ trait + at(trait):sex, random =
~at(sex):us(trait, : Warning : US updates modified 1 times in iteration 1 to
remain positive definite.</code></pre>
</div>
<div class="sourceCode" id="cb131"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">reduc.model_sex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span><span class="op">(</span><span class="va">reduc.model_sex</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ASReml Version 4.2 25/03/2024 16:50:18
          LogLik        Sigma2     DF     wall
 1     -2391.476           1.0   1807   16:50:19
 2     -2391.476           1.0   1807   16:50:19</code></pre>
</div>
<div class="sourceCode" id="cb133"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">reduc.model_sex</span><span class="op">)</span><span class="op">$</span><span class="va">varcomp</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                         component std.error
trait:byear!trait_bwt:bwt                                0.9794331 0.2848997
trait:byear!trait_tarsus:bwt                             0.1428995 0.4322719
trait:byear!trait_tarsus:tarsus                          4.0021595 1.2818624
trait:mother!trait_bwt:bwt                               1.4956509 0.2568074
trait:mother!trait_tarsus:bwt                           -1.2460057 0.4438357
trait:mother!trait_tarsus:tarsus                         5.3945609 1.4035705
at(sex, '1'):trait:vm(animal, ainv)!trait_bwt:bwt        0.5265716 0.3579555
at(sex, '1'):trait:vm(animal, ainv)!trait_tarsus:bwt     0.0000000        NA
at(sex, '1'):trait:vm(animal, ainv)!trait_tarsus:tarsus  1.4223969 1.9103795
at(sex, '2'):trait:vm(animal, ainv)!trait_bwt:bwt        1.5835813 0.8671365
at(sex, '2'):trait:vm(animal, ainv)!trait_tarsus:bwt     4.4288714 2.0173971
at(sex, '2'):trait:vm(animal, ainv)!trait_tarsus:tarsus 12.9349047 6.2946996
sex_1!R                                                  1.0000000        NA
sex_1!trait_bwt:bwt                                      2.9539767 0.4196755
sex_1!trait_tarsus:bwt                                   6.3138301 0.6802598
sex_1!trait_tarsus:tarsus                               17.3577089 2.4730547
sex_2!R                                                  1.0000000        NA
sex_2!trait_bwt:bwt                                      1.9341439 0.7416691
sex_2!trait_tarsus:bwt                                   2.9467290 1.7370018
sex_2!trait_tarsus:tarsus                               10.7245912 5.4025888
                                                           z.ratio bound %ch
trait:byear!trait_bwt:bwt                                3.4378175     P   0
trait:byear!trait_tarsus:bwt                             0.3305778     P   0
trait:byear!trait_tarsus:tarsus                          3.1221444     P   0
trait:mother!trait_bwt:bwt                               5.8240170     P   0
trait:mother!trait_tarsus:bwt                           -2.8073580     P   0
trait:mother!trait_tarsus:tarsus                         3.8434556     P   0
at(sex, '1'):trait:vm(animal, ainv)!trait_bwt:bwt        1.4710530     P   0
at(sex, '1'):trait:vm(animal, ainv)!trait_tarsus:bwt            NA     F  NA
at(sex, '1'):trait:vm(animal, ainv)!trait_tarsus:tarsus  0.7445625     P   0
at(sex, '2'):trait:vm(animal, ainv)!trait_bwt:bwt        1.8262193     P   0
at(sex, '2'):trait:vm(animal, ainv)!trait_tarsus:bwt     2.1953395     P   0
at(sex, '2'):trait:vm(animal, ainv)!trait_tarsus:tarsus  2.0548883     P   0
sex_1!R                                                         NA     F   0
sex_1!trait_bwt:bwt                                      7.0387165     P   0
sex_1!trait_tarsus:bwt                                   9.2814981     P   0
sex_1!trait_tarsus:tarsus                                7.0187323     P   0
sex_2!R                                                         NA     F   0
sex_2!trait_bwt:bwt                                      2.6078261     P   0
sex_2!trait_tarsus:bwt                                   1.6964455     P   0
sex_2!trait_tarsus:tarsus                                1.9850837     P   0</code></pre>
</div>
<div class="sourceCode" id="cb135"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="va">model_sex</span><span class="op">$</span><span class="va">loglik</span> <span class="op">-</span> <span class="va">reduc.model_sex</span><span class="op">$</span><span class="va">loglik</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.481033</code></pre>
</div>
<div class="sourceCode" id="cb137"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html">pchisq</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="va">model_sex</span><span class="op">$</span><span class="va">loglik</span> <span class="op">-</span> <span class="va">reduc.model_sex</span><span class="op">$</span><span class="va">loglik</span><span class="op">)</span>, df <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0192239</code></pre>
</div>
</div>
<p>In addition, it is also possible to test the sexesif sexes has significant differences with another reduced model where both covariance are fixed to their average values.</p>
<!-- Issue with this model!!!  my code should be ok !-->
<div class="cell">
<div class="sourceCode" id="cb139"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># code provided as an example for the moment since the model cannot run on this data</span></span>
<span><span class="va">model_modif</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/update.asreml.html">update.asreml</a></span><span class="op">(</span><span class="va">model_sex</span>, start.values <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="va">G</span> <span class="op">&lt;-</span> <span class="va">model_modif</span><span class="op">$</span><span class="va">vparameters</span><span class="op">[</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="va">G</span><span class="op">$</span><span class="va">fac</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">2</span>, <span class="fl">6</span>, <span class="co"># Additive genetic matrix  2 =5</span></span>
<span>    <span class="fl">7</span>, <span class="fl">8</span>, <span class="fl">9</span>, <span class="co"># byear  matrix</span></span>
<span>    <span class="fl">10</span>, <span class="fl">11</span>, <span class="fl">12</span> <span class="co"># mother matrix</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">Modif</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/vcm.lm.html">vcm.lm</a></span><span class="op">(</span><span class="op">~</span><span class="va">fac</span>, data <span class="op">=</span> <span class="va">G</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">Modif</span>, <span class="st">"assign"</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">Modif</span>, <span class="st">"contrasts"</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="co">#</span></span>
<span><span class="va">reduc.model_sex_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/asreml.html">asreml</a></span><span class="op">(</span></span>
<span>  fixed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">bwt</span>, <span class="va">tarsus</span><span class="op">)</span> <span class="op">~</span> <span class="va">trait</span> <span class="op">+</span> <span class="fu">at</span><span class="op">(</span><span class="va">trait</span><span class="op">)</span><span class="op">:</span><span class="va">sex</span>,</span>
<span>  random <span class="op">=</span> <span class="op">~</span> <span class="fu">at</span><span class="op">(</span><span class="va">sex</span><span class="op">)</span><span class="op">:</span><span class="fu">us</span><span class="op">(</span><span class="va">trait</span>, init <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">:</span><span class="fu">vm</span><span class="op">(</span><span class="va">animal</span>, <span class="va">ainv</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">us</span><span class="op">(</span><span class="va">trait</span>, init <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">:</span><span class="va">byear</span> <span class="op">+</span></span>
<span>    <span class="fu">us</span><span class="op">(</span><span class="va">trait</span>, init <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">:</span><span class="va">mother</span>,</span>
<span>  residual <span class="op">=</span> <span class="op">~</span> <span class="fu">dsum</span><span class="op">(</span><span class="op">~</span> <span class="fu">id</span><span class="op">(</span><span class="va">units</span><span class="op">)</span><span class="op">:</span><span class="fu">us</span><span class="op">(</span><span class="va">trait</span><span class="op">)</span> <span class="op">|</span> <span class="va">sex</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">gryphon</span>,</span>
<span>  na.action <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/na.method.html">na.method</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"include"</span>, y <span class="op">=</span> <span class="st">"include"</span><span class="op">)</span>,</span>
<span>  maxit <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  G.param <span class="op">=</span> <span class="va">G</span>, vcm <span class="op">=</span> <span class="va">Modif</span></span>
<span><span class="op">)</span></span>
<span><span class="va">reduc.model_sex_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span><span class="op">(</span><span class="va">reduc.model_sex_2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">reduc.model_sex_2</span><span class="op">)</span><span class="op">$</span><span class="va">varcomp</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="va">model_sex</span><span class="op">$</span><span class="va">loglik</span> <span class="op">-</span> <span class="va">reduc.model_sex_2</span><span class="op">$</span><span class="va">loglik</span><span class="op">)</span></span>
<span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html">pchisq</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="va">model_sex</span><span class="op">$</span><span class="va">loglik</span> <span class="op">-</span> <span class="va">reduc.model_sex_2</span><span class="op">$</span><span class="va">loglik</span><span class="op">)</span>, df <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here a plot to visualize the overlaps of covariances.</p>
<div class="cell">
<div class="sourceCode" id="cb140"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">genetic.correlation.F</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/vpredict.html">vpredict</a></span><span class="op">(</span><span class="va">model_sex</span>, <span class="va">r_A.1</span> <span class="op">~</span> <span class="va">V8</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">V7</span> <span class="op">*</span> <span class="va">V9</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">genetic.correlation.M</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/vpredict.html">vpredict</a></span><span class="op">(</span><span class="va">model_sex</span>, <span class="va">r_A.2</span> <span class="op">~</span> <span class="va">V11</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">V10</span> <span class="op">*</span> <span class="va">V12</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">residual.correlation.F</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/vpredict.html">vpredict</a></span><span class="op">(</span><span class="va">model_sex</span>, <span class="va">r_res.1</span> <span class="op">~</span> <span class="va">V15</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">V14</span> <span class="op">*</span> <span class="va">V16</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">residual.correlation.M</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/vpredict.html">vpredict</a></span><span class="op">(</span><span class="va">model_sex</span>, <span class="va">r_res.2</span> <span class="op">~</span> <span class="va">V19</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">V18</span> <span class="op">*</span> <span class="va">V20</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cor.est</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">genetic.correlation.F</span>, <span class="va">genetic.correlation.M</span>, <span class="va">residual.correlation.F</span>, <span class="va">residual.correlation.M</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.95</span>, <span class="fl">1.05</span>, <span class="fl">1.95</span>, <span class="fl">2.05</span><span class="op">)</span> <span class="op">~</span> <span class="va">cor.est</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1.5</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">2.5</span><span class="op">)</span>, xlab <span class="op">=</span> <span class="st">""</span>, ylab <span class="op">=</span> <span class="st">""</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"blue"</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">16</span>, <span class="fl">17</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">2</span>, yaxt <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/arrows.html">arrows</a></span><span class="op">(</span>y0 <span class="op">=</span> <span class="fl">0.95</span>, x0 <span class="op">=</span> <span class="va">cor.est</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">cor.est</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">]</span>, y1 <span class="op">=</span> <span class="fl">0.95</span>, x1 <span class="op">=</span> <span class="va">cor.est</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">cor.est</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">]</span>, code <span class="op">=</span> <span class="fl">3</span>, angle <span class="op">=</span> <span class="fl">90</span>, length <span class="op">=</span> <span class="fl">0</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"red"</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/arrows.html">arrows</a></span><span class="op">(</span>y0 <span class="op">=</span> <span class="fl">1.05</span>, x0 <span class="op">=</span> <span class="va">cor.est</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">cor.est</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span>, y1 <span class="op">=</span> <span class="fl">1.05</span>, x1 <span class="op">=</span> <span class="va">cor.est</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">cor.est</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span>, code <span class="op">=</span> <span class="fl">3</span>, angle <span class="op">=</span> <span class="fl">90</span>, length <span class="op">=</span> <span class="fl">0</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"blue"</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/arrows.html">arrows</a></span><span class="op">(</span>y0 <span class="op">=</span> <span class="fl">1.95</span>, x0 <span class="op">=</span> <span class="va">cor.est</span><span class="op">[</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">cor.est</span><span class="op">[</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">]</span>, y1 <span class="op">=</span> <span class="fl">1.95</span>, x1 <span class="op">=</span> <span class="va">cor.est</span><span class="op">[</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">cor.est</span><span class="op">[</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">]</span>, code <span class="op">=</span> <span class="fl">3</span>, angle <span class="op">=</span> <span class="fl">90</span>, length <span class="op">=</span> <span class="fl">0</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"red"</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/arrows.html">arrows</a></span><span class="op">(</span>y0 <span class="op">=</span> <span class="fl">2.05</span>, x0 <span class="op">=</span> <span class="va">cor.est</span><span class="op">[</span><span class="fl">4</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">cor.est</span><span class="op">[</span><span class="fl">4</span>, <span class="fl">2</span><span class="op">]</span>, y1 <span class="op">=</span> <span class="fl">2.05</span>, x1 <span class="op">=</span> <span class="va">cor.est</span><span class="op">[</span><span class="fl">4</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">cor.est</span><span class="op">[</span><span class="fl">4</span>, <span class="fl">2</span><span class="op">]</span>, code <span class="op">=</span> <span class="fl">3</span>, angle <span class="op">=</span> <span class="fl">90</span>, length <span class="op">=</span> <span class="fl">0</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"blue"</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span><span class="op">(</span><span class="st">"Correlation (CI)"</span>, side <span class="op">=</span> <span class="fl">1</span>, las <span class="op">=</span> <span class="fl">1</span>, adj <span class="op">=</span> <span class="fl">0.4</span>, line <span class="op">=</span> <span class="fl">3</span>, cex <span class="op">=</span> <span class="fl">1.6</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span><span class="op">(</span><span class="fl">2</span>, at <span class="op">=</span> <span class="fl">1</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"genetic"</span><span class="op">)</span>, las <span class="op">=</span> <span class="fl">3</span>, cex.axis <span class="op">=</span> <span class="fl">1.6</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span><span class="op">(</span><span class="fl">2</span>, at <span class="op">=</span> <span class="fl">2</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"residual"</span><span class="op">)</span>, las <span class="op">=</span> <span class="fl">3</span>, cex.axis <span class="op">=</span> <span class="fl">1.6</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="03_01-biv_asreml_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>By using <code>corgh</code>, we can extract the BLUPs and plot the sex-specific correlation.</p>
<div class="cell">
<div class="sourceCode" id="cb141"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">gryphon</span><span class="op">$</span><span class="va">T1</span> <span class="op">&lt;-</span> <span class="va">gryphon</span><span class="op">$</span><span class="va">bwt</span></span>
<span><span class="va">gryphon</span><span class="op">$</span><span class="va">T2</span> <span class="op">&lt;-</span> <span class="va">gryphon</span><span class="op">$</span><span class="va">tarsus</span></span>
<span><span class="co">###</span></span>
<span><span class="va">model_sex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/asreml.html">asreml</a></span><span class="op">(</span></span>
<span>  fixed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">T1</span>, <span class="va">T2</span><span class="op">)</span> <span class="op">~</span> <span class="va">trait</span> <span class="op">+</span> <span class="fu">at</span><span class="op">(</span><span class="va">trait</span><span class="op">)</span><span class="op">:</span><span class="va">sex</span>,</span>
<span>  random <span class="op">=</span> <span class="op">~</span> <span class="fu">at</span><span class="op">(</span><span class="va">sex</span><span class="op">)</span><span class="op">:</span><span class="fu">corgh</span><span class="op">(</span><span class="va">trait</span>, init <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">:</span><span class="fu">vm</span><span class="op">(</span><span class="va">animal</span>, <span class="va">ainv</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">us</span><span class="op">(</span><span class="va">trait</span>, init <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">:</span><span class="va">byear</span> <span class="op">+</span></span>
<span>    <span class="fu">us</span><span class="op">(</span><span class="va">trait</span>, init <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">:</span><span class="va">mother</span>,</span>
<span>  residual <span class="op">=</span> <span class="op">~</span> <span class="fu">dsum</span><span class="op">(</span><span class="op">~</span> <span class="fu">id</span><span class="op">(</span><span class="va">units</span><span class="op">)</span><span class="op">:</span><span class="fu">us</span><span class="op">(</span><span class="va">trait</span><span class="op">)</span> <span class="op">|</span> <span class="va">sex</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">gryphon</span>,</span>
<span>  na.action <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/na.method.html">na.method</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"include"</span>, y <span class="op">=</span> <span class="st">"include"</span><span class="op">)</span>,</span>
<span>  maxit <span class="op">=</span> <span class="fl">20</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ASReml Version 4.2 25/03/2024 17:29:45
          LogLik        Sigma2     DF     wall
 1     -2522.729           1.0   1807   17:29:46  (  2 restrained)
 2     -2457.755           1.0   1807   17:29:46  (  2 restrained)
 3     -2407.462           1.0   1807   17:29:46  (  2 restrained)
 4     -2394.143           1.0   1807   17:29:46  (  1 restrained)
 5     -2389.368           1.0   1807   17:29:46
 6     -2388.741           1.0   1807   17:29:46
 7     -2388.736           1.0   1807   17:29:46</code></pre>
</div>
<div class="sourceCode" id="cb143"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">model_sex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span><span class="op">(</span><span class="va">model_sex</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ASReml Version 4.2 25/03/2024 17:29:46
          LogLik        Sigma2     DF     wall
 1     -2388.736           1.0   1807   17:29:46
 2     -2388.736           1.0   1807   17:29:46</code></pre>
</div>
<div class="sourceCode" id="cb145"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">DvsS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  Trait <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">model_sex</span><span class="op">$</span><span class="va">coefficients</span><span class="op">$</span><span class="va">random</span><span class="op">)</span>,</span>
<span>  BLUP <span class="op">=</span> <span class="va">model_sex</span><span class="op">$</span><span class="va">coefficients</span><span class="op">$</span><span class="va">random</span>,</span>
<span>  SE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">model_sex</span><span class="op">$</span><span class="va">vcoeff</span><span class="op">$</span><span class="va">random</span> <span class="op">*</span> <span class="va">model_sex</span><span class="op">$</span><span class="va">sigma2</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"at\\(sex"</span>, <span class="va">Trait</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    ID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="va">Trait</span>, <span class="fl">40</span>, <span class="fl">44</span><span class="op">)</span>,</span>
<span>    TRAIT <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="va">Trait</span>, <span class="fl">20</span>, <span class="fl">21</span><span class="op">)</span>,</span>
<span>    SEX <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="va">Trait</span>, <span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">rename</span><span class="op">(</span></span>
<span>    BLUP <span class="op">=</span> <span class="st">"effect"</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">BLUP</span><span class="op">:</span><span class="va">SEX</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">DvsS</span><span class="op">$</span><span class="va">TRAIT</span><span class="op">)</span><span class="op">)</span> <span class="co"># 1309 each</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  T1   T2 
2618 2618 </code></pre>
</div>
<div class="sourceCode" id="cb147"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#</span></span>
<span></span>
<span><span class="va">BLUPS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/reshape.html">reshape</a></span><span class="op">(</span><span class="va">DvsS</span>, v.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"BLUP"</span>, <span class="st">"SE"</span><span class="op">)</span>, idvar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ID"</span>, <span class="st">"SEX"</span><span class="op">)</span>, timevar <span class="op">=</span> <span class="st">"TRAIT"</span>, direction <span class="op">=</span> <span class="st">"wide"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">BLUPS</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2618</code></pre>
</div>
<div class="sourceCode" id="cb149"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">BLUPS</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">BLUPS</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ID"</span>, <span class="st">"SEX"</span>, <span class="st">"BLUP.btw"</span>, <span class="st">"SE.btw"</span>, <span class="st">"BLUP.tarsus"</span>, <span class="st">"SE.tarsus"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">BLUPS</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      ID                SEX               BLUP.btw             SE.btw      
 Length:2618        Length:2618        Min.   :-2.669649   Min.   :0.8383  
 Class :character   Class :character   1st Qu.:-0.281979   1st Qu.:0.9366  
 Mode  :character   Mode  :character   Median : 0.000000   Median :1.1001  
                                       Mean   : 0.009574   Mean   :1.0913  
                                       3rd Qu.: 0.295795   3rd Qu.:1.1780  
                                       Max.   : 2.895393   Max.   :1.4276  
  BLUP.tarsus         SE.tarsus    
 Min.   :-7.81574   Min.   :1.829  
 1st Qu.:-0.64388   1st Qu.:2.342  
 Median : 0.00000   Median :2.462  
 Mean   : 0.03319   Mean   :2.728  
 3rd Qu.: 0.74473   3rd Qu.:3.329  
 Max.   : 8.77778   Max.   :4.038  </code></pre>
</div>
<div class="sourceCode" id="cb151"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># write.csv(BLUPS,file="BLUPS_6x6_SEX.csv",row.names=F)</span></span>
<span><span class="co">############</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">BLUPS</span><span class="op">$</span><span class="va">BLUP.btw</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="va">BLUPS</span><span class="op">$</span><span class="va">BLUP.btw</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqline</a></span><span class="op">(</span><span class="va">BLUPS</span><span class="op">$</span><span class="va">BLUP.btw</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">BLUPS</span><span class="op">$</span><span class="va">BLUP.tarsus</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="va">BLUPS</span><span class="op">$</span><span class="va">BLUP.tarsus</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqline</a></span><span class="op">(</span><span class="va">BLUPS</span><span class="op">$</span><span class="va">BLUP.tarsus</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="03_01-biv_asreml_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Here, some simple codes to plot the genetic correlation.</p>
<div class="cell">
<div class="sourceCode" id="cb152"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">FEM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">BLUPS</span>, <span class="va">SEX</span> <span class="op">==</span> <span class="st">"1"</span><span class="op">)</span></span>
<span><span class="va">MAL</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">BLUPS</span>, <span class="va">SEX</span> <span class="op">==</span> <span class="st">"2"</span><span class="op">)</span></span>
<span><span class="co">#</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">BLUP.tarsus</span> <span class="op">~</span> <span class="va">BLUP.btw</span>, <span class="va">FEM</span>, xlab <span class="op">=</span> <span class="st">""</span>, ylab <span class="op">=</span> <span class="st">""</span>, las <span class="op">=</span> <span class="fl">1.2</span>, bty <span class="op">=</span> <span class="st">"o"</span>, col <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/arrows.html">arrows</a></span><span class="op">(</span>x0 <span class="op">=</span> <span class="va">FEM</span><span class="op">$</span><span class="va">BLUP.btw</span>, y0 <span class="op">=</span> <span class="va">FEM</span><span class="op">$</span><span class="va">BLUP.tarsus</span> <span class="op">-</span> <span class="va">FEM</span><span class="op">$</span><span class="va">SE.tarsus</span>, x1 <span class="op">=</span> <span class="va">FEM</span><span class="op">$</span><span class="va">BLUP.btw</span>, y1 <span class="op">=</span> <span class="va">FEM</span><span class="op">$</span><span class="va">BLUP.tarsus</span> <span class="op">+</span> <span class="va">FEM</span><span class="op">$</span><span class="va">SE.tarsus</span>, col <span class="op">=</span> <span class="st">"black"</span>, code <span class="op">=</span> <span class="fl">3</span>, angle <span class="op">=</span> <span class="fl">90</span>, length <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/arrows.html">arrows</a></span><span class="op">(</span>x0 <span class="op">=</span> <span class="va">FEM</span><span class="op">$</span><span class="va">BLUP.btw</span> <span class="op">-</span> <span class="va">FEM</span><span class="op">$</span><span class="va">SE.btw</span>, y0 <span class="op">=</span> <span class="va">FEM</span><span class="op">$</span><span class="va">BLUP.tarsus</span>, x1 <span class="op">=</span> <span class="va">FEM</span><span class="op">$</span><span class="va">BLUP.btw</span> <span class="op">+</span> <span class="va">FEM</span><span class="op">$</span><span class="va">SE.btw</span>, y1 <span class="op">=</span> <span class="va">FEM</span><span class="op">$</span><span class="va">BLUP.tarsus</span>, col <span class="op">=</span> <span class="st">"black"</span>, code <span class="op">=</span> <span class="fl">3</span>, angle <span class="op">=</span> <span class="fl">90</span>, length <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">BLUP.tarsus</span> <span class="op">~</span> <span class="va">BLUP.btw</span>, <span class="va">FEM</span>, pch <span class="op">=</span> <span class="fl">16</span>, col <span class="op">=</span> <span class="st">"red"</span>, cex <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">BLUP.tarsus</span> <span class="op">~</span> <span class="va">BLUP.btw</span>, <span class="va">FEM</span>, pch <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0.3</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span><span class="op">(</span><span class="st">"btw (BVSE)"</span>, side <span class="op">=</span> <span class="fl">1</span>, line <span class="op">=</span> <span class="fl">2.4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span><span class="op">(</span><span class="st">"tarsus (BVSE)"</span>, side <span class="op">=</span> <span class="fl">2</span>, line <span class="op">=</span> <span class="fl">2</span>, las <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">BLUP.tarsus</span> <span class="op">~</span> <span class="va">BLUP.btw</span>, <span class="va">MAL</span>, xlab <span class="op">=</span> <span class="st">""</span>, ylab <span class="op">=</span> <span class="st">""</span>, las <span class="op">=</span> <span class="fl">1.2</span>, bty <span class="op">=</span> <span class="st">"o"</span>, col <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/arrows.html">arrows</a></span><span class="op">(</span>x0 <span class="op">=</span> <span class="va">MAL</span><span class="op">$</span><span class="va">BLUP.btw</span>, y0 <span class="op">=</span> <span class="va">MAL</span><span class="op">$</span><span class="va">BLUP.tarsus</span> <span class="op">-</span> <span class="va">MAL</span><span class="op">$</span><span class="va">SE.tarsus</span>, x1 <span class="op">=</span> <span class="va">MAL</span><span class="op">$</span><span class="va">BLUP.btw</span>, y1 <span class="op">=</span> <span class="va">MAL</span><span class="op">$</span><span class="va">BLUP.tarsus</span> <span class="op">+</span> <span class="va">MAL</span><span class="op">$</span><span class="va">SE.tarsus</span>, col <span class="op">=</span> <span class="st">"black"</span>, code <span class="op">=</span> <span class="fl">3</span>, angle <span class="op">=</span> <span class="fl">90</span>, length <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/arrows.html">arrows</a></span><span class="op">(</span>x0 <span class="op">=</span> <span class="va">MAL</span><span class="op">$</span><span class="va">BLUP.btw</span> <span class="op">-</span> <span class="va">MAL</span><span class="op">$</span><span class="va">SE.btw</span>, y0 <span class="op">=</span> <span class="va">MAL</span><span class="op">$</span><span class="va">BLUP.tarsus</span>, x1 <span class="op">=</span> <span class="va">MAL</span><span class="op">$</span><span class="va">BLUP.btw</span> <span class="op">+</span> <span class="va">MAL</span><span class="op">$</span><span class="va">SE.btw</span>, y1 <span class="op">=</span> <span class="va">MAL</span><span class="op">$</span><span class="va">BLUP.tarsus</span>, col <span class="op">=</span> <span class="st">"black"</span>, code <span class="op">=</span> <span class="fl">3</span>, angle <span class="op">=</span> <span class="fl">90</span>, length <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">BLUP.tarsus</span> <span class="op">~</span> <span class="va">BLUP.btw</span>, <span class="va">MAL</span>, pch <span class="op">=</span> <span class="fl">16</span>, col <span class="op">=</span> <span class="st">"blue"</span>, cex <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">BLUP.tarsus</span> <span class="op">~</span> <span class="va">BLUP.btw</span>, <span class="va">MAL</span>, pch <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0.3</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span><span class="op">(</span><span class="st">"btw (BVSE)"</span>, side <span class="op">=</span> <span class="fl">1</span>, line <span class="op">=</span> <span class="fl">2.4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span><span class="op">(</span><span class="st">"tarsus (BVSE)"</span>, side <span class="op">=</span> <span class="fl">2</span>, line <span class="op">=</span> <span class="fl">2</span>, las <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="03_01-biv_asreml_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="between-groups-covariances-and-the-b-matrix" class="level3" data-number="7.0.7"><h3 data-number="7.0.7" class="anchored" data-anchor-id="between-groups-covariances-and-the-b-matrix">
<span class="header-section-number">7.0.7</span> Between groups (co)variances and the B-matrix</h3>
<p>Animal models are amazing model. With different group within a population, it is also possible to estimate how much the different groups shared the same genetic via the cross-group genetic covariance. This covariance is essential to understand ontogenic or sexual conflict, which can constraint or enhanced response to evolution. As an example, we estimate the cross-sex genetic correlation <code>r_{fm}</code></p>
<p>First, we need to dissociate the trait values for females and males into distinct variables. Then, we use a bivariate model (for one trait: <code>tarsus</code>) and a multivariate model (for various traits: <code>tarsus</code> and <code>bwt</code>). With a multivariate model, the cross-sex-cross trait covariance matrixis also named <code>B matrix</code>.</p>
<p>The coding is a bit complex but pretty straightforward. It is important to modify the covariance matrix at the residual level to avoid the calculation of a cross-sex residual covariance (no individual switched sex during the experiment).</p>
<div class="cell">
<div class="sourceCode" id="cb153"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">gryphon</span><span class="op">$</span><span class="va">bwt.1</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">gryphon</span><span class="op">$</span><span class="va">tarsus.1</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">animal</span> <span class="op">&lt;-</span> <span class="va">gryphon</span><span class="op">[</span><span class="va">gryphon</span><span class="op">$</span><span class="va">sex</span> <span class="op">==</span> <span class="st">"1"</span>, <span class="op">]</span><span class="op">$</span><span class="va">animal</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">animal</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">gryphon</span><span class="op">$</span><span class="va">bwt.1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">gryphon</span><span class="op">$</span><span class="va">animal</span> <span class="op">==</span> <span class="va">i</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">gryphon</span><span class="op">$</span><span class="va">bwt</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">gryphon</span><span class="op">$</span><span class="va">animal</span> <span class="op">==</span> <span class="va">i</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="va">gryphon</span><span class="op">$</span><span class="va">tarsus.1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">gryphon</span><span class="op">$</span><span class="va">animal</span> <span class="op">==</span> <span class="va">i</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">gryphon</span><span class="op">$</span><span class="va">tarsus</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">gryphon</span><span class="op">$</span><span class="va">animal</span> <span class="op">==</span> <span class="va">i</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#</span></span>
<span><span class="va">gryphon</span><span class="op">$</span><span class="va">bwt.2</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">gryphon</span><span class="op">$</span><span class="va">tarsus.2</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">animal</span> <span class="op">&lt;-</span> <span class="va">gryphon</span><span class="op">[</span><span class="va">gryphon</span><span class="op">$</span><span class="va">sex</span> <span class="op">==</span> <span class="st">"2"</span>, <span class="op">]</span><span class="op">$</span><span class="va">animal</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">animal</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">gryphon</span><span class="op">$</span><span class="va">bwt.2</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">gryphon</span><span class="op">$</span><span class="va">animal</span> <span class="op">==</span> <span class="va">i</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">gryphon</span><span class="op">$</span><span class="va">bwt</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">gryphon</span><span class="op">$</span><span class="va">animal</span> <span class="op">==</span> <span class="va">i</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="va">gryphon</span><span class="op">$</span><span class="va">tarsus.2</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">gryphon</span><span class="op">$</span><span class="va">animal</span> <span class="op">==</span> <span class="va">i</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">gryphon</span><span class="op">$</span><span class="va">tarsus</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">gryphon</span><span class="op">$</span><span class="va">animal</span> <span class="op">==</span> <span class="va">i</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">###########</span></span>
<span><span class="va">temp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/asreml.html">asreml</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">tarsus.1</span>, <span class="va">tarsus.2</span><span class="op">)</span> <span class="op">~</span> <span class="va">trait</span>,</span>
<span>  random <span class="op">=</span> <span class="op">~</span> <span class="fu">us</span><span class="op">(</span><span class="va">trait</span><span class="op">)</span><span class="op">:</span><span class="fu">vm</span><span class="op">(</span><span class="va">animal</span>, <span class="va">ainv</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">trait</span><span class="op">)</span><span class="op">:</span><span class="va">byear</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">trait</span><span class="op">)</span><span class="op">:</span><span class="va">mother</span>,</span>
<span>  residual <span class="op">=</span> <span class="op">~</span> <span class="va">units</span><span class="op">:</span><span class="fu">us</span><span class="op">(</span><span class="va">trait</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">gryphon</span>, na.action <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/na.method.html">na.method</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"include"</span>, x <span class="op">=</span> <span class="st">"include"</span><span class="op">)</span>, maxiter <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  start.values <span class="op">=</span> <span class="cn">T</span></span>
<span><span class="op">)</span></span>
<span><span class="va">G</span> <span class="op">&lt;-</span> <span class="va">temp</span><span class="op">$</span><span class="va">vparameters</span><span class="op">[</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="va">R</span> <span class="op">&lt;-</span> <span class="va">temp</span><span class="op">$</span><span class="va">vparameters</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="co">#</span></span>
<span><span class="va">G</span><span class="op">$</span><span class="va">Constraint</span> <span class="op">&lt;-</span> <span class="st">"U"</span></span>
<span><span class="va">R</span><span class="op">$</span><span class="va">Value</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">R</span><span class="op">$</span><span class="va">Constraint</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"F"</span></span>
<span><span class="co">#</span></span>
<span><span class="va">model.BiV_Sex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/asreml.html">asreml</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">tarsus.1</span>, <span class="va">tarsus.2</span><span class="op">)</span> <span class="op">~</span> <span class="va">trait</span>,</span>
<span>  random <span class="op">=</span> <span class="op">~</span> <span class="fu">us</span><span class="op">(</span><span class="va">trait</span><span class="op">)</span><span class="op">:</span><span class="fu">vm</span><span class="op">(</span><span class="va">animal</span>, <span class="va">ainv</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">trait</span><span class="op">)</span><span class="op">:</span><span class="va">byear</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">trait</span><span class="op">)</span><span class="op">:</span><span class="va">mother</span>,</span>
<span>  residual <span class="op">=</span> <span class="op">~</span> <span class="va">units</span><span class="op">:</span><span class="fu">us</span><span class="op">(</span><span class="va">trait</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">gryphon</span>, na.action <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/na.method.html">na.method</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"include"</span>, x <span class="op">=</span> <span class="st">"include"</span><span class="op">)</span>, maxiter <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  G.param <span class="op">=</span> <span class="va">G</span>, R.param <span class="op">=</span> <span class="va">R</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ASReml Version 4.2 25/03/2024 17:29:48
          LogLik        Sigma2     DF     wall
 1     -1494.807           1.0    681   17:29:48  (  1 restrained)
 2     -1484.793           1.0    681   17:29:48  (  1 restrained)
 3     -1475.726           1.0    681   17:29:48  (  1 restrained)
 4     -1471.905           1.0    681   17:29:48  (  1 restrained)
 5     -1470.716           1.0    681   17:29:48
 6     -1468.154           1.0    681   17:29:48
 7     -1467.969           1.0    681   17:29:48
 8     -1467.967           1.0    681   17:29:48</code></pre>
</div>
<div class="sourceCode" id="cb155"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">model.BiV_Sex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/update.asreml.html">update.asreml</a></span><span class="op">(</span><span class="va">model.BiV_Sex</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ASReml Version 4.2 25/03/2024 17:29:48
          LogLik        Sigma2     DF     wall
 1     -1467.967           1.0    681   17:29:48
 2     -1467.967           1.0    681   17:29:48</code></pre>
</div>
<div class="sourceCode" id="cb157"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model.BiV_Sex</span><span class="op">)</span><span class="op">$</span><span class="va">varcomp</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                               component std.error   z.ratio
trait:byear!trait_tarsus.1                      3.280319  1.532909 2.1399299
trait:byear!trait_tarsus.2                      4.743134  1.891252 2.5079332
trait:mother!trait_tarsus.1                     1.875132  2.424092 0.7735398
trait:mother!trait_tarsus.2                     4.314158  2.785254 1.5489283
trait:vm(animal, ainv)!trait_tarsus.1:tarsus.1  6.582654  3.636467 1.8101781
trait:vm(animal, ainv)!trait_tarsus.2:tarsus.1  8.396245  3.278591 2.5609306
trait:vm(animal, ainv)!trait_tarsus.2:tarsus.2 12.898424  8.038362 1.6046084
units:trait!R                                   1.000000        NA        NA
units:trait!trait_tarsus.1:tarsus.1            14.872757  3.637545 4.0886803
units:trait!trait_tarsus.2:tarsus.1             0.000000        NA        NA
units:trait!trait_tarsus.2:tarsus.2            10.760849  6.294585 1.7095406
                                               bound %ch
trait:byear!trait_tarsus.1                         U   0
trait:byear!trait_tarsus.2                         U   0
trait:mother!trait_tarsus.1                        U   0
trait:mother!trait_tarsus.2                        U   0
trait:vm(animal, ainv)!trait_tarsus.1:tarsus.1     U   0
trait:vm(animal, ainv)!trait_tarsus.2:tarsus.1     U   0
trait:vm(animal, ainv)!trait_tarsus.2:tarsus.2     U   0
units:trait!R                                      F   0
units:trait!trait_tarsus.1:tarsus.1                P   0
units:trait!trait_tarsus.2:tarsus.1                F  NA
units:trait!trait_tarsus.2:tarsus.2                P   0</code></pre>
</div>
</div>
<p>The cross-sex genetic correlation can estimate form the output of the model. For tarsus length at fledging, sexes shared a lot of genetic variance which is commun for a trait with low sexual dimorphism. If the selection is antagonistic between males and females, sexes can not evolve freely form the other sexes and a sexual conflict appears.</p>
<div class="cell">
<div class="sourceCode" id="cb159"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/asreml/man/vpredict.html">vpredict</a></span><span class="op">(</span><span class="va">model.BiV_Sex</span>, <span class="va">r_fm</span> <span class="op">~</span> <span class="va">V6</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">V5</span> <span class="op">*</span> <span class="va">V7</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Estimate        SE
r_fm 0.9112054 0.4229764</code></pre>
</div>
</div>
<p>We can estimate directly the correlation and plot the cross-sex genetic correlation</p>
<div class="cell">
<div class="sourceCode" id="cb161"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">temp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/asreml.html">asreml</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">tarsus.1</span>, <span class="va">tarsus.2</span><span class="op">)</span> <span class="op">~</span> <span class="va">trait</span>,</span>
<span>  random <span class="op">=</span> <span class="op">~</span> <span class="fu">corgh</span><span class="op">(</span><span class="va">trait</span><span class="op">)</span><span class="op">:</span><span class="fu">vm</span><span class="op">(</span><span class="va">animal</span>, <span class="va">ainv</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">trait</span><span class="op">)</span><span class="op">:</span><span class="va">byear</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">trait</span><span class="op">)</span><span class="op">:</span><span class="va">mother</span>,</span>
<span>  residual <span class="op">=</span> <span class="op">~</span> <span class="va">units</span><span class="op">:</span><span class="fu">corgh</span><span class="op">(</span><span class="va">trait</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">gryphon</span>, na.action <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/na.method.html">na.method</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"include"</span>, x <span class="op">=</span> <span class="st">"include"</span><span class="op">)</span>, maxiter <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  start.values <span class="op">=</span> <span class="cn">T</span></span>
<span><span class="op">)</span></span>
<span><span class="va">G</span> <span class="op">&lt;-</span> <span class="va">temp</span><span class="op">$</span><span class="va">vparameters</span><span class="op">[</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="va">R</span> <span class="op">&lt;-</span> <span class="va">temp</span><span class="op">$</span><span class="va">vparameters</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="co">#</span></span>
<span><span class="va">G</span><span class="op">$</span><span class="va">Constraint</span> <span class="op">&lt;-</span> <span class="st">"U"</span></span>
<span><span class="va">R</span><span class="op">$</span><span class="va">Value</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">R</span><span class="op">$</span><span class="va">Constraint</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"F"</span></span>
<span><span class="co">#</span></span>
<span><span class="va">model.BiV_Sex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/asreml.html">asreml</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">tarsus.1</span>, <span class="va">tarsus.2</span><span class="op">)</span> <span class="op">~</span> <span class="va">trait</span>,</span>
<span>  random <span class="op">=</span> <span class="op">~</span> <span class="fu">corgh</span><span class="op">(</span><span class="va">trait</span><span class="op">)</span><span class="op">:</span><span class="fu">vm</span><span class="op">(</span><span class="va">animal</span>, <span class="va">ainv</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">trait</span><span class="op">)</span><span class="op">:</span><span class="va">byear</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">trait</span><span class="op">)</span><span class="op">:</span><span class="va">mother</span>,</span>
<span>  residual <span class="op">=</span> <span class="op">~</span> <span class="va">units</span><span class="op">:</span><span class="fu">corgh</span><span class="op">(</span><span class="va">trait</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">gryphon</span>, na.action <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/na.method.html">na.method</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"include"</span>, x <span class="op">=</span> <span class="st">"include"</span><span class="op">)</span>, maxiter <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  G.param <span class="op">=</span> <span class="va">G</span>, R.param <span class="op">=</span> <span class="va">R</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ASReml Version 4.2 25/03/2024 17:29:48
          LogLik        Sigma2     DF     wall
 1     -1494.323           1.0    681   17:29:49  (  1 restrained)
 2     -1482.996           1.0    681   17:29:49  (  1 restrained)
 3     -1472.827           1.0    681   17:29:49  (  1 restrained)
 4     -1468.707           1.0    681   17:29:49
 5     -1467.984           1.0    681   17:29:49
 6     -1467.968           1.0    681   17:29:49
 7     -1467.967           1.0    681   17:29:49</code></pre>
</div>
<div class="sourceCode" id="cb163"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">model.BiV_Sex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/update.asreml.html">update.asreml</a></span><span class="op">(</span><span class="va">model.BiV_Sex</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ASReml Version 4.2 25/03/2024 17:29:49
          LogLik        Sigma2     DF     wall
 1     -1467.967           1.0    681   17:29:49
 2     -1467.967           1.0    681   17:29:49</code></pre>
</div>
<div class="sourceCode" id="cb165"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model.BiV_Sex</span><span class="op">)</span><span class="op">$</span><span class="va">varcomp</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                           component std.error
trait:byear!trait_tarsus.1                                 3.2803263 1.5329224
trait:byear!trait_tarsus.2                                 4.7431679 1.8913244
trait:mother!trait_tarsus.1                                1.8751274 2.4240942
trait:mother!trait_tarsus.2                                4.3141262 2.7852550
trait:vm(animal, ainv)!trait!tarsus.2:!trait!tarsus.1.cor  0.9111864 0.4230261
trait:vm(animal, ainv)!trait_tarsus.1                      6.5826478 3.6364929
trait:vm(animal, ainv)!trait_tarsus.2                     12.8988848 8.0388517
units:trait!R                                              1.0000000        NA
units:trait!trait!tarsus.2:!trait!tarsus.1.cor             0.0000000        NA
units:trait!trait_tarsus.1                                14.8727602 3.6375549
units:trait!trait_tarsus.2                                10.7604420 6.2948051
                                                            z.ratio bound %ch
trait:byear!trait_tarsus.1                                2.1399167     U   0
trait:byear!trait_tarsus.2                                2.5078553     U   0
trait:mother!trait_tarsus.1                               0.7735373     U   0
trait:mother!trait_tarsus.2                               1.5489160     U   0
trait:vm(animal, ainv)!trait!tarsus.2:!trait!tarsus.1.cor 2.1539720     U   0
trait:vm(animal, ainv)!trait_tarsus.1                     1.8101638     U   0
trait:vm(animal, ainv)!trait_tarsus.2                     1.6045681     U   0
units:trait!R                                                    NA     F   0
units:trait!trait!tarsus.2:!trait!tarsus.1.cor                   NA     F  NA
units:trait!trait_tarsus.1                                4.0886696     P   0
units:trait!trait_tarsus.2                                1.7094162     P   0</code></pre>
</div>
<div class="sourceCode" id="cb167"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">###########</span></span>
<span><span class="va">DvsS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  Trait <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">model.BiV_Sex</span><span class="op">$</span><span class="va">coefficients</span><span class="op">$</span><span class="va">random</span><span class="op">)</span>,</span>
<span>  BLUP <span class="op">=</span> <span class="va">model.BiV_Sex</span><span class="op">$</span><span class="va">coefficients</span><span class="op">$</span><span class="va">random</span>,</span>
<span>  SE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">model.BiV_Sex</span><span class="op">$</span><span class="va">vcoeff</span><span class="op">$</span><span class="va">random</span> <span class="op">*</span> <span class="va">model.BiV_Sex</span><span class="op">$</span><span class="va">sigma2</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"vm\\(animal"</span>, <span class="va">Trait</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    ID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="va">Trait</span>, <span class="fl">33</span>, <span class="fl">36</span><span class="op">)</span>,</span>
<span>    TRAIT <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="va">Trait</span>, <span class="fl">7</span>, <span class="fl">14</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">rename</span><span class="op">(</span></span>
<span>    BLUP <span class="op">=</span> <span class="st">"effect"</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">BLUP</span><span class="op">:</span><span class="va">TRAIT</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">DvsS</span><span class="op">$</span><span class="va">TRAIT</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tarsus.1 tarsus.2 
    1309     1309 </code></pre>
</div>
<div class="sourceCode" id="cb169"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#</span></span>
<span></span>
<span><span class="va">BLUPS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/reshape.html">reshape</a></span><span class="op">(</span><span class="va">DvsS</span>, v.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"BLUP"</span>, <span class="st">"SE"</span><span class="op">)</span>, idvar <span class="op">=</span> <span class="st">"ID"</span>, timevar <span class="op">=</span> <span class="st">"TRAIT"</span>, direction <span class="op">=</span> <span class="st">"wide"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">BLUPS</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1309</code></pre>
</div>
<div class="sourceCode" id="cb171"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">BLUPS</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">BLUPS</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ID"</span>, <span class="st">"BLUP.1"</span>, <span class="st">"SE.1"</span>, <span class="st">"BLUP.2"</span>, <span class="st">"SE.2"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">BLUPS</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      ID                BLUP.1             SE.1           BLUP.2        
 Length:1309        Min.   :-4.2702   Min.   :1.724   Min.   :-6.10276  
 Class :character   1st Qu.:-0.7149   1st Qu.:2.010   1st Qu.:-0.99945  
 Mode  :character   Median : 0.0000   Median :2.127   Median : 0.00000  
                    Mean   : 0.0718   Mean   :2.198   Mean   : 0.09409  
                    3rd Qu.: 0.8386   3rd Qu.:2.421   3rd Qu.: 1.15952  
                    Max.   : 4.9297   Max.   :2.677   Max.   : 7.57246  
      SE.2      
 Min.   :2.375  
 1st Qu.:2.679  
 Median :3.051  
 Mean   :3.041  
 3rd Qu.:3.375  
 Max.   :3.732  </code></pre>
</div>
<div class="sourceCode" id="cb173"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">###########</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">BLUPS</span><span class="op">$</span><span class="va">BLUP.1</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="va">BLUPS</span><span class="op">$</span><span class="va">BLUP.2</span></span>
<span><span class="va">se.Y</span> <span class="op">&lt;-</span> <span class="va">BLUPS</span><span class="op">$</span><span class="va">SE.1</span></span>
<span><span class="va">se.X</span> <span class="op">&lt;-</span> <span class="va">BLUPS</span><span class="op">$</span><span class="va">SE.2</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">Y</span>, xlab <span class="op">=</span> <span class="st">""</span>, ylab <span class="op">=</span> <span class="st">""</span>, las <span class="op">=</span> <span class="fl">1.2</span>, bty <span class="op">=</span> <span class="st">"o"</span>, col <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/arrows.html">arrows</a></span><span class="op">(</span>x0 <span class="op">=</span> <span class="va">X</span>, y0 <span class="op">=</span> <span class="va">Y</span> <span class="op">-</span> <span class="va">se.Y</span>, x1 <span class="op">=</span> <span class="va">X</span>, y1 <span class="op">=</span> <span class="va">Y</span> <span class="op">+</span> <span class="va">se.Y</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0.2</span><span class="op">)</span>, code <span class="op">=</span> <span class="fl">3</span>, angle <span class="op">=</span> <span class="fl">90</span>, length <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/arrows.html">arrows</a></span><span class="op">(</span>x0 <span class="op">=</span> <span class="va">X</span> <span class="op">-</span> <span class="va">se.X</span>, y0 <span class="op">=</span> <span class="va">Y</span>, x1 <span class="op">=</span> <span class="va">X</span> <span class="op">+</span> <span class="va">se.X</span>, y1 <span class="op">=</span> <span class="va">Y</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0.2</span><span class="op">)</span>, code <span class="op">=</span> <span class="fl">3</span>, angle <span class="op">=</span> <span class="fl">90</span>, length <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">Y</span>, pch <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0.2</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">Y</span>, pch <span class="op">=</span> <span class="fl">16</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0.2</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span>
<span><span class="co"># abline(v=0,lty=3);abline(h=0,lty=3)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span><span class="op">(</span><span class="st">"Male tarsus (BVSE)"</span>, side <span class="op">=</span> <span class="fl">2</span>, line <span class="op">=</span> <span class="fl">2</span>, las <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span><span class="op">(</span><span class="st">"Female tarsus (BVSE)"</span>, side <span class="op">=</span> <span class="fl">1</span>, line <span class="op">=</span> <span class="fl">2.2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="03_01-biv_asreml_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The B matrix used the same code but in a multivariate animal model framework. Here some example code, however due to the nature of the dataset, the cross-sex genetic covariance for birth weight is hard to estimate making difficulty to fit this multivariate animal model.</p>
<div class="cell">
<div class="sourceCode" id="cb174"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">temp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/asreml.html">asreml</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">tarsus.1</span>, <span class="va">bwt.1</span>, <span class="va">tarsus.2</span>, <span class="va">bwt.2</span><span class="op">)</span> <span class="op">~</span> <span class="va">trait</span>,</span>
<span>  random <span class="op">=</span> <span class="op">~</span> <span class="fu">us</span><span class="op">(</span><span class="va">trait</span><span class="op">)</span><span class="op">:</span><span class="fu">vm</span><span class="op">(</span><span class="va">animal</span>, <span class="va">ainv</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">trait</span><span class="op">)</span><span class="op">:</span><span class="va">byear</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">trait</span><span class="op">)</span><span class="op">:</span><span class="va">mother</span>,</span>
<span>  residual <span class="op">=</span> <span class="op">~</span> <span class="va">units</span><span class="op">:</span><span class="fu">us</span><span class="op">(</span><span class="va">trait</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">gryphon</span>, na.action <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/na.method.html">na.method</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"include"</span>, x <span class="op">=</span> <span class="st">"include"</span><span class="op">)</span>, maxiter <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  start.values <span class="op">=</span> <span class="cn">T</span></span>
<span><span class="op">)</span></span>
<span><span class="va">G</span> <span class="op">&lt;-</span> <span class="va">temp</span><span class="op">$</span><span class="va">vparameters</span><span class="op">[</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">18</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="va">R</span> <span class="op">&lt;-</span> <span class="va">temp</span><span class="op">$</span><span class="va">vparameters</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">18</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="co">#</span></span>
<span><span class="va">G</span><span class="op">$</span><span class="va">Constraint</span> <span class="op">&lt;-</span> <span class="st">"U"</span></span>
<span><span class="va">R</span><span class="op">$</span><span class="va">Value</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">R</span><span class="op">$</span><span class="va">Constraint</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"F"</span></span>
<span><span class="va">R</span><span class="op">$</span><span class="va">Value</span><span class="op">[</span><span class="fl">8</span><span class="op">:</span><span class="fl">9</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">R</span><span class="op">$</span><span class="va">Constraint</span><span class="op">[</span><span class="fl">8</span><span class="op">:</span><span class="fl">9</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"F"</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># model.MultV_Sex&lt;-asreml(cbind(tarsus.1,bwt.1,tarsus.2,bwt.2)~trait,</span></span>
<span><span class="co">#          random=~us(trait):vm(animal,ainv)+</span></span>
<span><span class="co">#         diag(trait):byear +   diag(trait):mother,</span></span>
<span><span class="co">#         residual = ~units:us(trait),</span></span>
<span><span class="co">#         data=gryphon,na.action=na.method(y="include",x="include"),maxiter=20,</span></span>
<span><span class="co">#     G.param=G,R.param=R)</span></span>
<span><span class="co"># model.MultV_Sex&lt;-update.asreml(model.MultV_Sex)</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># summary(model.MultV_Sex)$varcomp</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list" style="display: none">
<div id="ref-wilson2010" class="csl-entry" role="listitem">
Wilson, A. J., D. Rale, M. N. Clements, M. M. Morrissey, E. Postma, C. A. Walling, L. E. B. Kruuk, and D. H. Nussey. 2010. <a href="https://doi.org/10.1111/j.1365-2656.2009.01639.x">An ecologists guide to the animal model</a>. Journal of Animal Ecology 79:1326.
</div>
</div>
</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./03_00-biv.html" class="pagination-link" aria-label="Multivariate animal model">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Multivariate animal model</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./03_02-biv_gremlin.html" class="pagination-link" aria-label="gremlin">
        <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">gremlin</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>By J Martin &amp; M Videlier</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/juliengamartin/wam_tuto/edit/main/03_01-biv_asreml.Rmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/juliengamartin/wam_tuto/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>This book was built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>


</body></html>